[{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2023 GeoToxPackage authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/articles/dev-conc-resp.html","id":"format-data","dir":"Articles","previous_headings":"","what":"Format data","title":"dev-conc-resp","text":"Split dose response data list chemical casn.","code":"ice_conc_resp <- split(as.data.frame(geo_tox_data$ice), ~casn)"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/articles/dev-conc-resp.html","id":"parameter-hill-fit","dir":"Articles","previous_headings":"","what":"2-parameter Hill fit","title":"dev-conc-resp","text":"Apply fit_hill function chemicals.","code":"fits <- lapply(ice_conc_resp, function(df) {fit_hill(df$logc, df$resp)}) #> Warning in sqrt(diag(solve(-fit$hessian))): NaNs produced  #> Warning in sqrt(diag(solve(-fit$hessian))): NaNs produced  #> Warning in sqrt(diag(solve(-fit$hessian))): NaNs produced  #> Warning in sqrt(diag(solve(-fit$hessian))): NaNs produced  #> Warning in sqrt(diag(solve(-fit$hessian))): NaNs produced"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/articles/dev-conc-resp.html","id":"extract-fit-parameters","dir":"Articles","previous_headings":"","what":"Extract fit parameters","title":"dev-conc-resp","text":"Note estimates tp.sd logAC50.sd NA replaced corresponding tp logAC50 values. imputation indicated setting tp.sd.imputed logAC50.sd.imputed TRUE.","code":"fit_params <- extract_hill_params(fits)"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/articles/dev-conc-resp.html","id":"plot-fit-parameters","dir":"Articles","previous_headings":"Extract fit parameters","what":"Plot fit parameters","title":"dev-conc-resp","text":"","code":"xylim <- range(with(fit_params, c(tp, tp.sd)), na.rm = T) ggplot(fit_params, aes(tp, tp.sd)) +   geom_abline(linetype = 3) +   geom_point(aes(color = tp.sd.imputed), show.legend = FALSE) +   coord_cartesian(xlim = xylim, ylim = xylim) xylim <- range(with(fit_params, c(logAC50, logAC50.sd)), na.rm = T) ggplot(fit_params, aes(logAC50, logAC50.sd)) +   geom_abline(linetype = 3) +   geom_point(aes(color = logAC50.sd.imputed), show.legend = FALSE) +   coord_cartesian(xlim = xylim, ylim = xylim)"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/articles/dev-conc-resp.html","id":"plot-fits","dir":"Articles","previous_headings":"","what":"Plot fits","title":"dev-conc-resp","text":"","code":"log10_x <- seq(-3, 3, length.out = 100)  y <- apply(fit_params, 1, function(par) {   tp      <- as.numeric(par[\"tp\"])   logAC50 <- as.numeric(par[\"logAC50\"])   tp / (1 + 10^(logAC50 - log10_x)) }) colnames(y) <- names(ice_conc_resp)  df <- as_tibble(y) %>% mutate(x = 10^log10_x, .before = 1)  ggplot(df %>% pivot_longer(!x), aes(x, value, color = name)) +   geom_line(show.legend = FALSE) +   scale_x_log10(labels = scales::label_math(10^.x, format = log10))"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/articles/dev-sensitivity.html","id":"param-settings","dir":"Articles","previous_headings":"","what":"Param settings","title":"Steps 01-05 of GeoToxMIE Sensitivity scripts","text":"","code":"MC_iter <- geo_tox_data$MC_iter  vary <- \"age\" # c(\"age\", \"obesity\", \"httk\", \"dose-resp\", \"ext-conc\")"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/articles/dev-sensitivity.html","id":"format-data","dir":"Articles","previous_headings":"","what":"Format data","title":"Steps 01-05 of GeoToxMIE Sensitivity scripts","text":"Split CYP1A1 data list FIPS code. Pick desired Css parameter.","code":"cyp1a1 <- split(geo_tox_data$cyp1a1, ~FIPS)  Css <- geo_tox_data$Css[[vary]]"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/articles/dev-sensitivity.html","id":"simulate-age","dir":"Articles","previous_headings":"","what":"Simulate age","title":"Steps 01-05 of GeoToxMIE Sensitivity scripts","text":"Fist, split age data FIPS code, apply simulate_age function.","code":"simulated_age <- lapply(   split(geo_tox_data$age, ~FIPS),   simulate_age,   n = MC_iter )  # Replace sampled age values with median when age is fixed if (vary != \"age\") {   simulated_age <- lapply(     simulated_age,     function(x) rep(median(x), length.out = MC_iter)   ) }"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/articles/dev-sensitivity.html","id":"simulate-inhalation-rate","dir":"Articles","previous_headings":"","what":"Simulate inhalation rate","title":"Steps 01-05 of GeoToxMIE Sensitivity scripts","text":"","code":"simulated_IR <- lapply(simulated_age, simulate_inhalation_rate)"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/articles/dev-sensitivity.html","id":"simulate-external-exposure","dir":"Articles","previous_headings":"","what":"Simulate external exposure","title":"Steps 01-05 of GeoToxMIE Sensitivity scripts","text":"","code":"if (vary != \"ext-conc\") {   simulated_exposure <- lapply(     lapply(cyp1a1, \"[[\", \"concentration_mean\"),     simulate_exposure,     n = MC_iter   ) } else {   simulated_exposure <- mapply(     simulate_exposure,     mean = lapply(cyp1a1, \"[[\", \"concentration_mean\"),     sd = lapply(cyp1a1, \"[[\", \"concentration_sd\"),     n = MC_iter,     SIMPLIFY = FALSE   ) }"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/articles/dev-sensitivity.html","id":"compute-internal-dose","dir":"Articles","previous_headings":"","what":"Compute internal dose","title":"Steps 01-05 of GeoToxMIE Sensitivity scripts","text":"","code":"internal_dose <- mapply(   calc_internal_dose,   C_ext = lapply(simulated_exposure, function(x) x / 1000),   IR = simulated_IR,   SIMPLIFY = FALSE )"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/articles/dev-sensitivity.html","id":"compute-in-vitro-concentration","dir":"Articles","previous_headings":"","what":"Compute in vitro concentration","title":"Steps 01-05 of GeoToxMIE Sensitivity scripts","text":"","code":"invitro_concentration <- mapply(   calc_invitro_concentration,   D_int = internal_dose,   C_ss = Css,   SIMPLIFY = FALSE )"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/articles/dev-sensitivity.html","id":"compute-concentration-response","dir":"Articles","previous_headings":"","what":"Compute concentration response","title":"Steps 01-05 of GeoToxMIE Sensitivity scripts","text":"","code":"concentration_response <- mapply(   calc_concentration_response,   resp = cyp1a1,   concentration = invitro_concentration,   tp_b_mult = ifelse(vary == \"dose-resp\", 1.2, 1.5),   fixed = vary != \"dose-resp\",   SIMPLIFY = FALSE )"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Skylar Marvel. Author, contributor. David Reif. Author, contributor. Kyle Messier. Maintainer, author, contributor.","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Marvel S, Reif D, Messier K (2024). GeoToxPackage: Package (One Line, Title Case). R package version 0.0.0.9000, https://spatiotemporal-exposures--toxicology.github.io/GeoToxPackage/.","code":"@Manual{,   title = {GeoToxPackage: What the Package Does (One Line, Title Case)},   author = {Skylar Marvel and David Reif and Kyle Messier},   year = {2024},   note = {R package version 0.0.0.9000},   url = {https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/}, }"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/index.html","id":"geotoxpackage","dir":"","previous_headings":"","what":"What the Package Does (One Line, Title Case)","title":"What the Package Does (One Line, Title Case)","text":"GeoToxPackage can , introduced Eccles KM, Karmaus AL, Kleinstreuer NC, Parham F, Rider CV, Wambaugh JF, Messier KP. geospatial modeling approach quantifying risk exposure environmental chemical mixtures via common molecular target. Sci Total Environ. 2023 Jan 10;855:158905. doi: 10.1016/j.scitotenv.2022.158905. Epub 2022 Sep 21. PMID: 36152849; PMCID: PMC9979101.","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"What the Package Does (One Line, Title Case)","text":"can install development version GeoToxPackage GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"Spatiotemporal-Exposures-and-Toxicology/GeoToxPackage\")"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"What the Package Does (One Line, Title Case)","text":"","code":"library(GeoToxPackage) library(dplyr, warn.conflicts = FALSE)"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/index.html","id":"estimate-chemical-concentration-response-curves","dir":"","previous_headings":"Example","what":"Estimate chemical concentration-response curves","title":"What the Package Does (One Line, Title Case)","text":"","code":"conc <- 10^rep(-2:2, each = 3) tp   <- 100 # top asymptote ga   <- 1.6 # AC50 gw   <- 1.2 # slope resp <- tp / (1 + (ga / conc)^gw) + rnorm(length(conc), sd = 5)  fit_2param <- fit_hill(log10(conc), resp) # slope fixed at 1 fit_3param <- fit_hill(log10(conc), resp, fixed_slope = FALSE)  rbind(   \"inputs\"  = c(tp, log10(ga), gw, NA),   \"3-param\" = c(fit_3param$par),   \"2-param\" = c(fit_2param$par[1:2], 1, fit_2param$par[3]) ) #>                tp   logAC50    slope  t-error #> inputs  100.00000 0.2041200 1.200000       NA #> 3-param  97.63578 0.1516374 1.485236 1.177891 #> 2-param 101.53494 0.2360917 1.000000 1.417567"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/index.html","id":"estimate-population-dose-response","dir":"","previous_headings":"Example","what":"Estimate population dose-response","title":"What the Package Does (One Line, Title Case)","text":"Input data Simulate data Computations","code":"# Number of samples to simulate MC_iter <- 10  # Number of chemicals to simulate n_chem <- 4  # Create age groups and group sizes age <- data.frame(   AGEGRP = 0:18,   TOT_POP = c(0, round(runif(18, max = 1000))) ) age$TOT_POP[1] <- sum(age$TOT_POP[-1])  # Create chemical exposure mean and sd exposure <- data.frame(   mean = (1 + runif(n_chem))*1e-6,   sd   = (1 + runif(n_chem))*1e-7 )  # Create chemical concentration-response data conc_resp <- lapply(1:n_chem, function(idx) {   conc <- 10^rep(-2:2, each = 3)   tp   <- 100 + rnorm(1, sd = 15)   ga   <- 10^(2 * runif(1) - 1)   gw   <- 1 + rnorm(1)/5   resp <- tp / (1 + (ga / conc)^gw) + rnorm(length(conc))   resp[resp < 0] <- 0   data.frame(     logc = log10(conc),     resp = resp   ) }) fits <- lapply(conc_resp, function(df) {   fit_hill(df$logc, df$resp) }) chem_params <- do.call(   rbind,   lapply(fits, function(fit) {     as_tibble(t(unlist(fit))) %>%       rename(         tp         = par.tp,         tp.sd      = sds.tp,         logAC50    = par.logAC50,         logAC50.sd = sds.logAC50       ) %>%       select(         tp, tp.sd, logAC50, logAC50.sd,         logc_min, logc_max, resp_min, resp_max, AIC       ) %>%       mutate(across(tp:AIC, ~ as.numeric(.x)))   }) )  # Steady-state concentration (will be generated from httk) C_ss <- matrix(runif(n_chem * MC_iter), nrow = MC_iter) # Simulate age based on relative population group sizes simulated_age <- simulate_age(   age,   n = MC_iter )  # Simulate inhalation rate using default params simulated_IR <- simulate_inhalation_rate(   simulated_age )  # Simulate external exposure simulated_exposure <- simulate_exposure(   exposure$mean,   exposure$sd,   n = MC_iter ) internal_dose <- calc_internal_dose(   C_ext = simulated_exposure,   IR = simulated_IR )  invitro_concentration <- calc_invitro_concentration(   D_int = internal_dose,   C_ss = C_ss )  concentration_response <- calc_concentration_response(   resp = chem_params,   concentration = invitro_concentration )  concentration_response #>         GCA.Eff       IA.eff    GCA.HQ.10     IA.HQ.10 #> 1  1.316500e-04 1.316519e-04 1.197871e-05 1.197851e-05 #> 2  1.928066e-04 1.928077e-04 1.756148e-05 1.756120e-05 #> 3  1.509427e-04 1.509448e-04 1.339909e-05 1.339880e-05 #> 4  1.931396e-04 1.931407e-04 1.742350e-05 1.742319e-05 #> 5  2.000661e-04 2.000678e-04 1.748640e-05 1.748673e-05 #> 6  9.090331e-05 9.090415e-05 8.634445e-06 8.634337e-06 #> 7  6.336773e-05 6.336758e-05 5.870044e-06 5.869961e-06 #> 8  1.501012e-04 1.501024e-04 1.365014e-05 1.364991e-05 #> 9  7.009742e-05 7.009701e-05 6.962928e-06 6.962838e-06 #> 10 7.310190e-05 7.310279e-05 6.848001e-06 6.847910e-06"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/calc_concentration_response.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the mixture response from one of three different approaches:\nIA, GCA ,or Hazard Quotient — calc_concentration_response","title":"Calculate the mixture response from one of three different approaches:\nIA, GCA ,or Hazard Quotient — calc_concentration_response","text":"Calculate combined response multiple chemicals. calculates generalized concentration addition response, independent action response, hazard quotient","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/calc_concentration_response.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the mixture response from one of three different approaches:\nIA, GCA ,or Hazard Quotient — calc_concentration_response","text":"","code":"calc_concentration_response(   resp,   concentration,   tp_b_mult = 1.5,   fixed = FALSE )"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/calc_concentration_response.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the mixture response from one of three different approaches:\nIA, GCA ,or Hazard Quotient — calc_concentration_response","text":"resp data frame columns \"tp\", \"tp.sd\", \"logAC50\", \"logAC50.sd\", \"resp_max\", \"logc_min\", \"logc_max\". concentration concentration tp_b_mult upper bound multiplier tp rtruncnorm fixed TRUE, sd = 0","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/calc_concentration_response.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the mixture response from one of three different approaches:\nIA, GCA ,or Hazard Quotient — calc_concentration_response","text":"data frame","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/calc_independent_action.html","id":null,"dir":"Reference","previous_headings":"","what":"Independent action prediction from the tcpl Hill function — calc_independent_action","title":"Independent action prediction from the tcpl Hill function — calc_independent_action","text":"Independent action prediction tcpl Hill function","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/calc_independent_action.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Independent action prediction from the tcpl Hill function — calc_independent_action","text":"","code":"calc_independent_action(Ci, tp, AC50, Emax, slope = 1)"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/calc_independent_action.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Independent action prediction from the tcpl Hill function — calc_independent_action","text":"Ci individual chemical concentrations regular space tp top asymptotes AC50 AC50 Emax maximum mixture response slope hill coefficient","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/calc_independent_action.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Independent action prediction from the tcpl Hill function — calc_independent_action","text":"response value","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/calc_internal_dose.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate internal chemical dose — calc_internal_dose","title":"Calculate internal chemical dose — calc_internal_dose","text":"Estimate internal dose inhalation chemical given inhalation rate, time, body weight","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/calc_internal_dose.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate internal chemical dose — calc_internal_dose","text":"","code":"calc_internal_dose(C_ext, IR, time = 1, BW = 1)"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/calc_internal_dose.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate internal chemical dose — calc_internal_dose","text":"C_ext ambient chemical concentration \\(\\frac{mg}{m^3}\\) IR inhalation rate \\(\\frac{m^3}{day}\\) time total time \\(days\\) BW body weight \\(kg\\)","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/calc_internal_dose.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate internal chemical dose — calc_internal_dose","text":"internal chemical dose \\(\\frac{mg}{kg}\\)","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/calc_internal_dose.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate internal chemical dose — calc_internal_dose","text":"TODO Additional details... $$D_{int} = \\frac{C_{ext} \\,\\times\\, IR \\,\\times\\, time}{BW}$$","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/calc_invitro_concentration.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate in vitro concentration — calc_invitro_concentration","title":"Calculate in vitro concentration — calc_invitro_concentration","text":"TODO short description...","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/calc_invitro_concentration.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate in vitro concentration — calc_invitro_concentration","text":"","code":"calc_invitro_concentration(D_int, C_ss = NULL)"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/calc_invitro_concentration.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate in vitro concentration — calc_invitro_concentration","text":"D_int internal chemical dose \\(\\frac{mg}{kg}\\) C_ss steady-state plasma concentration \\(\\frac{\\mu M}{mg / kg}\\)","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/calc_invitro_concentration.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate in vitro concentration — calc_invitro_concentration","text":"vitro equivalent plasma concentration \\(\\mu M\\)","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/calc_invitro_concentration.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate in vitro concentration — calc_invitro_concentration","text":"TODO Additional details... $$C_{plasma} = C_{ss} \\,\\times\\, D_{int}$$ TODO C_ss provided, uses httk create...","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/extract_hill_params.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract results from 2-parameter fit_hill outputs — extract_hill_params","title":"Extract results from 2-parameter fit_hill outputs — extract_hill_params","text":"Extract results 2-parameter fit_hill outputs","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/extract_hill_params.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract results from 2-parameter fit_hill outputs — extract_hill_params","text":"","code":"extract_hill_params(fits)"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/extract_hill_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract results from 2-parameter fit_hill outputs — extract_hill_params","text":"fits list outputs fit_hill(..., fixed_slope = TRUE)","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/extract_hill_params.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract results from 2-parameter fit_hill outputs — extract_hill_params","text":"data frame","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/extract_hill_params.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract results from 2-parameter fit_hill outputs — extract_hill_params","text":"","code":"df <- data.frame(   logc = -3:3,   resp = 5 / (1 + 10^(1.2 * (0.4 - rep(-3:3, each = 3)))) + rnorm(21)  ) fit <- fit_hill(df$logc, df$resp) extract_hill_params(list(fit)) #>         tp     tp.sd   logAC50 logAC50.sd logc_min logc_max  resp_min resp_max #> 1 2.414112 0.7335322 -1.823025   1.701617       -3        3 -2.059775 5.347455 #>        AIC tp.sd.imputed logAC50.sd.imputed #> 1 100.0632         FALSE              FALSE  df_list <- list(df, df) fits <- lapply(df_list, function(df) {fit_hill(df$logc, df$resp)}) extract_hill_params(fits) #>         tp     tp.sd   logAC50 logAC50.sd logc_min logc_max  resp_min resp_max #> 1 2.414112 0.7335322 -1.823025   1.701617       -3        3 -2.059775 5.347455 #> 2 2.414112 0.7335322 -1.823025   1.701617       -3        3 -2.059775 5.347455 #>        AIC tp.sd.imputed logAC50.sd.imputed #> 1 100.0632         FALSE              FALSE #> 2 100.0632         FALSE              FALSE"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/fit_hill.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit 2- or 3-parameter Hill model — fit_hill","title":"Fit 2- or 3-parameter Hill model — fit_hill","text":"Fit 2- 3-parameter Hill model","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/fit_hill.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit 2- or 3-parameter Hill model — fit_hill","text":"","code":"fit_hill(log10_conc, resp, fixed_slope = TRUE)"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/fit_hill.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit 2- or 3-parameter Hill model — fit_hill","text":"log10_conc base-10 log scale concentration resp response fixed_slope TRUE, slope fixed 1","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/fit_hill.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit 2- or 3-parameter Hill model — fit_hill","text":"fit stats","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/geo_tox_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Geo Tox data — geo_tox_data","title":"Geo Tox data — geo_tox_data","text":"subset data GeoToxMIE source scripts","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/geo_tox_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Geo Tox data — geo_tox_data","text":"","code":"geo_tox_data"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/geo_tox_data.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Geo Tox data — geo_tox_data","text":"list 4 items: ice Description MC_iter Description cyp1a1 Description age Description Css Description Css list 5 items: Css$age Description Css$obesity Description Css$httk Description Css$'dose-resp' Description Css$'ext-conc' Description","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/obj_ECx.html","id":null,"dir":"Reference","previous_headings":"","what":"A Generalized concentration addition style solution — obj_ECx","title":"A Generalized concentration addition style solution — obj_ECx","text":"Find effective concentration mixture via objective function given concentrations inverse, based regular space AC50 concentrations.","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/obj_ECx.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A Generalized concentration addition style solution — obj_ECx","text":"","code":"obj_ECx(ECmix, E, Ci, tp, AC50)"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/obj_ECx.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A Generalized concentration addition style solution — obj_ECx","text":"ECmix effective concentration mixture E individual chemical responses Ci individual chemical concentrations regular space tp top asymptotes AC50 AC50s","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/obj_ECx.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A Generalized concentration addition style solution — obj_ECx","text":"objective value","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/obj_GCA.html","id":null,"dir":"Reference","previous_headings":"","what":"Generalized concentration addition objective function — obj_GCA","title":"Generalized concentration addition objective function — obj_GCA","text":"Use find optimal efficacy value, E, based regular space AC50 concentrations.","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/obj_GCA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generalized concentration addition objective function — obj_GCA","text":"","code":"obj_GCA(effic, Ci, tp, AC50)"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/obj_GCA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generalized concentration addition objective function — obj_GCA","text":"effic natural log individual chemical responses Ci individual chemical concentrations regular space tp top asymptote AC50 AC50","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/obj_GCA.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generalized concentration addition objective function — obj_GCA","text":"objective value","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/obj_hill.html","id":null,"dir":"Reference","previous_headings":"","what":"Objective function for 2- or 3-parameter Hill model — obj_hill","title":"Objective function for 2- or 3-parameter Hill model — obj_hill","text":"Objective function 2- 3-parameter Hill model","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/obj_hill.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Objective function for 2- or 3-parameter Hill model — obj_hill","text":"","code":"obj_hill(par, log10_conc, resp)"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/obj_hill.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Objective function for 2- or 3-parameter Hill model — obj_hill","text":"par parameters log10_conc base-10 log scale concentration resp response","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/obj_hill.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Objective function for 2- or 3-parameter Hill model — obj_hill","text":"value","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/simulate_age.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate age data — simulate_age","title":"Simulate age data — simulate_age","text":"Simulate age data","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/simulate_age.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate age data — simulate_age","text":"","code":"simulate_age(x, n = 1000)"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/simulate_age.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate age data — simulate_age","text":"x data frame containing population data age groups. n simulated sample size.","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/simulate_age.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate age data — simulate_age","text":"array simulated ages.","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/simulate_age.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate age data — simulate_age","text":"","code":"x <- data.frame(AGEGRP = 0:18, TOT_POP = c(sum(1:18), 1:18)) simulate_age(x, 10) #>  [1] 84 35 37 72 89 87 79 53 80 32"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/simulate_exposure.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate external exposure — simulate_exposure","title":"Simulate external exposure — simulate_exposure","text":"Simulate external exposure","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/simulate_exposure.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate external exposure — simulate_exposure","text":"","code":"simulate_exposure(mean, sd = 0, n = 1000)"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/simulate_exposure.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate external exposure — simulate_exposure","text":"mean array concentration mean values. sd array concentration standard deviations, leave 0 fixed external concentrations. n simulated sample size.","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/simulate_exposure.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate external exposure — simulate_exposure","text":"matrix \\(_{n \\,\\times\\, length(mean)}\\) inhalation rates.","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/simulate_exposure.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate external exposure — simulate_exposure","text":"","code":"simulate_exposure(mean = 1:3, n = 10) #>       [,1] [,2] [,3] #>  [1,]    1    2    3 #>  [2,]    1    2    3 #>  [3,]    1    2    3 #>  [4,]    1    2    3 #>  [5,]    1    2    3 #>  [6,]    1    2    3 #>  [7,]    1    2    3 #>  [8,]    1    2    3 #>  [9,]    1    2    3 #> [10,]    1    2    3 simulate_exposure(mean = c(1, 10, 100), sd = c(0, 1, 5), n = 10) #>       [,1]      [,2]      [,3] #>  [1,]    1  8.779994 107.20690 #>  [2,]    1 10.745431  98.12466 #>  [3,]    1  8.864712 102.01543 #>  [4,]    1 10.666909  96.92955 #>  [5,]    1 10.771608 101.20361 #>  [6,]    1  9.398087 103.85914 #>  [7,]    1 10.112980 101.06444 #>  [8,]    1 10.419941 108.79563 #>  [9,]    1 10.723707  98.41740 #> [10,]    1 12.456826  97.39562"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/simulate_inhalation_rate.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate inhalation rates — simulate_inhalation_rate","title":"Simulate inhalation rates — simulate_inhalation_rate","text":"Simulate inhalation rates","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/simulate_inhalation_rate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate inhalation rates — simulate_inhalation_rate","text":"","code":"simulate_inhalation_rate(ages, params = NULL)"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/simulate_inhalation_rate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate inhalation rates — simulate_inhalation_rate","text":"ages array ages. params data frame columns \"age\", \"mean\" \"sd\". age column ascending order represent lower value age groups corresponding mean sd values.","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/simulate_inhalation_rate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate inhalation rates — simulate_inhalation_rate","text":"array inhalation rates.","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/simulate_inhalation_rate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate inhalation rates — simulate_inhalation_rate","text":"","code":"simulate_inhalation_rate(c(1, 6, 20)) #> [1] 0.4135214 0.3328114 0.2971063"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/tcplHillConc.html","id":null,"dir":"Reference","previous_headings":"","what":"TCPL Hill model — tcplHillConc","title":"TCPL Hill model — tcplHillConc","text":"Calculate concentration regular space given value","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/tcplHillConc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"TCPL Hill model — tcplHillConc","text":"","code":"tcplHillConc(resp, tp, ga, gw)"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/tcplHillConc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"TCPL Hill model — tcplHillConc","text":"resp response value tp top asymptote ga AC50 gw hill coefficient","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/tcplHillConc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"TCPL Hill model — tcplHillConc","text":"concentration regular space","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/tcplHillVal.html","id":null,"dir":"Reference","previous_headings":"","what":"TCPL Hill model — tcplHillVal","title":"TCPL Hill model — tcplHillVal","text":"Calculate efficacy given concentration regular space","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/tcplHillVal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"TCPL Hill model — tcplHillVal","text":"","code":"tcplHillVal(conc, tp, ga, gw, bt = 0)"},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/tcplHillVal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"TCPL Hill model — tcplHillVal","text":"conc concentration regular space tp top asymptote ga AC50 gw hill coefficient bt bottom asymptote","code":""},{"path":"https://spatiotemporal-exposures-and-toxicology.github.io/GeoToxPackage/reference/tcplHillVal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"TCPL Hill model — tcplHillVal","text":"response value","code":""}]
