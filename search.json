[{"path":[]},{"path":"https://github.com/NIEHS/GeoTox/CODE_OF_CONDUCT.html","id":"our-pledge","dir":"","previous_headings":"","what":"Our Pledge","title":"Contributor Covenant Code of Conduct","text":"members, contributors, leaders pledge make participation community harassment-free experience everyone, regardless age, body size, visible invisible disability, ethnicity, sex characteristics, gender identity expression, level experience, education, socio-economic status, nationality, personal appearance, race, caste, color, religion, sexual identity orientation. pledge act interact ways contribute open, welcoming, diverse, inclusive, healthy community.","code":""},{"path":"https://github.com/NIEHS/GeoTox/CODE_OF_CONDUCT.html","id":"our-standards","dir":"","previous_headings":"","what":"Our Standards","title":"Contributor Covenant Code of Conduct","text":"Examples behavior contributes positive environment community include: Demonstrating empathy kindness toward people respectful differing opinions, viewpoints, experiences Giving gracefully accepting constructive feedback Accepting responsibility apologizing affected mistakes, learning experience Focusing best just us individuals, overall community Examples unacceptable behavior include: use sexualized language imagery, sexual attention advances kind Trolling, insulting derogatory comments, personal political attacks Public private harassment Publishing others’ private information, physical email address, without explicit permission conduct reasonably considered inappropriate professional setting","code":""},{"path":"https://github.com/NIEHS/GeoTox/CODE_OF_CONDUCT.html","id":"enforcement-responsibilities","dir":"","previous_headings":"","what":"Enforcement Responsibilities","title":"Contributor Covenant Code of Conduct","text":"Community leaders responsible clarifying enforcing standards acceptable behavior take appropriate fair corrective action response behavior deem inappropriate, threatening, offensive, harmful. Community leaders right responsibility remove, edit, reject comments, commits, code, wiki edits, issues, contributions aligned Code Conduct, communicate reasons moderation decisions appropriate.","code":""},{"path":"https://github.com/NIEHS/GeoTox/CODE_OF_CONDUCT.html","id":"scope","dir":"","previous_headings":"","what":"Scope","title":"Contributor Covenant Code of Conduct","text":"Code Conduct applies within community spaces, also applies individual officially representing community public spaces. Examples representing community include using official e-mail address, posting via official social media account, acting appointed representative online offline event.","code":""},{"path":"https://github.com/NIEHS/GeoTox/CODE_OF_CONDUCT.html","id":"enforcement","dir":"","previous_headings":"","what":"Enforcement","title":"Contributor Covenant Code of Conduct","text":"Instances abusive, harassing, otherwise unacceptable behavior may reported community leaders responsible enforcement kyle.messier@nih.gov. complaints reviewed investigated promptly fairly. community leaders obligated respect privacy security reporter incident.","code":""},{"path":"https://github.com/NIEHS/GeoTox/CODE_OF_CONDUCT.html","id":"enforcement-guidelines","dir":"","previous_headings":"","what":"Enforcement Guidelines","title":"Contributor Covenant Code of Conduct","text":"Community leaders follow Community Impact Guidelines determining consequences action deem violation Code Conduct:","code":""},{"path":"https://github.com/NIEHS/GeoTox/CODE_OF_CONDUCT.html","id":"id_1-correction","dir":"","previous_headings":"Enforcement Guidelines","what":"1. Correction","title":"Contributor Covenant Code of Conduct","text":"Community Impact: Use inappropriate language behavior deemed unprofessional unwelcome community. Consequence: private, written warning community leaders, providing clarity around nature violation explanation behavior inappropriate. public apology may requested.","code":""},{"path":"https://github.com/NIEHS/GeoTox/CODE_OF_CONDUCT.html","id":"id_2-warning","dir":"","previous_headings":"Enforcement Guidelines","what":"2. Warning","title":"Contributor Covenant Code of Conduct","text":"Community Impact: violation single incident series actions. Consequence: warning consequences continued behavior. interaction people involved, including unsolicited interaction enforcing Code Conduct, specified period time. includes avoiding interactions community spaces well external channels like social media. Violating terms may lead temporary permanent ban.","code":""},{"path":"https://github.com/NIEHS/GeoTox/CODE_OF_CONDUCT.html","id":"id_3-temporary-ban","dir":"","previous_headings":"Enforcement Guidelines","what":"3. Temporary Ban","title":"Contributor Covenant Code of Conduct","text":"Community Impact: serious violation community standards, including sustained inappropriate behavior. Consequence: temporary ban sort interaction public communication community specified period time. public private interaction people involved, including unsolicited interaction enforcing Code Conduct, allowed period. Violating terms may lead permanent ban.","code":""},{"path":"https://github.com/NIEHS/GeoTox/CODE_OF_CONDUCT.html","id":"id_4-permanent-ban","dir":"","previous_headings":"Enforcement Guidelines","what":"4. Permanent Ban","title":"Contributor Covenant Code of Conduct","text":"Community Impact: Demonstrating pattern violation community standards, including sustained inappropriate behavior, harassment individual, aggression toward disparagement classes individuals. Consequence: permanent ban sort public interaction within community.","code":""},{"path":"https://github.com/NIEHS/GeoTox/CODE_OF_CONDUCT.html","id":"attribution","dir":"","previous_headings":"","what":"Attribution","title":"Contributor Covenant Code of Conduct","text":"Code Conduct adapted Contributor Covenant, version 2.1, available https://www.contributor-covenant.org/version/2/1/code_of_conduct.html. Community Impact Guidelines inspired [Mozilla’s code conduct enforcement ladder][https://github.com/mozilla/inclusion]. answers common questions code conduct, see FAQ https://www.contributor-covenant.org/faq. Translations available https://www.contributor-covenant.org/translations.","code":""},{"path":"https://github.com/NIEHS/GeoTox/CONTRIBUTING.html","id":null,"dir":"","previous_headings":"","what":"Contributing to GeoTox","title":"Contributing to GeoTox","text":"outlines (1) propose change GeoTox (2) serves log potential enhancements GeoTox.","code":""},{"path":"https://github.com/NIEHS/GeoTox/CONTRIBUTING.html","id":"best-practices","dir":"","previous_headings":"","what":"Best Practices","title":"Contributing to GeoTox","text":"’ve found bug, please file issue illustrates bug minimal reprex (also help write unit test, needed). See tidyverse team’s guide create great issue advice. adding new function package, always add working examples new function roxygen2 documentation #' @examples.","code":""},{"path":"https://github.com/NIEHS/GeoTox/CONTRIBUTING.html","id":"pull-request-process","dir":"","previous_headings":"Best Practices","what":"Pull request process","title":"Contributing to GeoTox","text":"Fork package clone onto computer. haven’t done , recommend using usethis::create_from_github(\"NIEHS/GeoTox\", fork = TRUE). Install development dependencies devtools::install_dev_deps(), make sure package passes R CMD check running devtools::check(). R CMD check doesn’t pass cleanly, ’s good idea ask help continuing. Create Git branch pull request (PR). recommend using usethis::pr_init(\"brief-description--change\"). Make changes, commit git, create PR running usethis::pr_push(), following prompts browser. title PR briefly describe change. body PR contain Fixes #issue-number. user-facing changes, add bullet top NEWS.md (.e. just first header).","code":""},{"path":"https://github.com/NIEHS/GeoTox/CONTRIBUTING.html","id":"code-style","dir":"","previous_headings":"Best Practices","what":"Code style","title":"Contributing to GeoTox","text":"Please abide 80-character line rules (default settings lintr) use roxygen2, Markdown syntax, documentation. use testthat unit tests. Contributions test cases included easier accept.","code":""},{"path":"https://github.com/NIEHS/GeoTox/CONTRIBUTING.html","id":"fixing-typos","dir":"","previous_headings":"","what":"Fixing typos","title":"Contributing to GeoTox","text":"can fix typos, spelling mistakes, grammatical errors documentation directly using GitHub web interface, long changes made source file. generally means ’ll need edit roxygen2 comments .R, .Rd file. can find .R file generates .Rd reading comment first line.","code":""},{"path":"https://github.com/NIEHS/GeoTox/CONTRIBUTING.html","id":"geotox-open-issues-and-enhancements","dir":"","previous_headings":"","what":"GeoTox Open Issues and Enhancements","title":"Contributing to GeoTox","text":"section serves log potential enhancements GeoTox. Community members welcomed encouraged use contributing guide address open issues enhancements package. Additionally, new enhancements can proposed using enhancements template request. want address open enchancement suggest new one, ’s good idea first file issue make sure someone team agrees ’s needed.","code":""},{"path":"https://github.com/NIEHS/GeoTox/CONTRIBUTING.html","id":"scientific","dir":"","previous_headings":"GeoTox Open Issues and Enhancements","what":"Scientific","title":"Contributing to GeoTox","text":"Non-steady state toxicokinetics. likely require additional usage httk package. Complete integration multiple end-point analysis GeoTox objects Integration Reflected Generalized Concentration Addition (RGCA), allow 3+ parameter hill models used additive mixture predictions. Benchmark Dose modeling (BMD) metric risk assessment. Suggested ingetrations include BMDexpress2.0 transcryptR - note transcryptR also currently ","code":""},{"path":"https://github.com/NIEHS/GeoTox/CONTRIBUTING.html","id":"computational","dir":"","previous_headings":"GeoTox Open Issues and Enhancements","what":"Computational","title":"Contributing to GeoTox","text":"targets pipeline template. provide make-like targets pipeline, new users reproducible template run analysis ease.","code":""},{"path":"https://github.com/NIEHS/GeoTox/CONTRIBUTING.html","id":"code-of-conduct","dir":"","previous_headings":"","what":"Code of Conduct","title":"Contributing to GeoTox","text":"Please note chopin project released Contributor Code Conduct. contributing project agree abide terms.","code":""},{"path":"https://github.com/NIEHS/GeoTox/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 GeoTox authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://github.com/NIEHS/GeoTox/articles/GeoTox.html","id":"analysis-of-single-assay","dir":"Articles","previous_headings":"","what":"Analysis of single assay","title":"GeoTox Introduction","text":"Create GeoTox object, run simulations computations Plot outputs","code":"set.seed(2357) geoTox <- GeoTox() |>    # Set region and group boundaries (for plotting)   set_boundaries(region = geo_tox_data$boundaries$county,                  group  = geo_tox_data$boundaries$state) |>    # Simulate populations for each region   simulate_population(age           = split(geo_tox_data$age, ~FIPS),                       obesity       = geo_tox_data$obesity,                       exposure      = split(geo_tox_data$exposure, ~FIPS),                       simulated_css = geo_tox_data$simulated_css,                       n             = n) |>    # Estimated Hill parameters   set_hill_params(geo_tox_data$dose_response |>                     filter(endp == \"TOX21_H2AX_HTRF_CHO_Agonist_ratio\") |>                     fit_hill(chem = \"casn\") |>                      filter(!tp.sd.imputed, !logAC50.sd.imputed)) |>   # Calculate response   calculate_response() |>   # Perform sensitivity analysis   sensitivity_analysis()  geoTox #> GeoTox object #> Assays: 1 #> Chemicals: 5 #> Regions: m = 100 #> Population: n = 250 #> Data Fields: #>      Name          Size #>       age       m * (n) #>        IR       m * (n) #>   obesity       m * (n) #>     C_ext  m * (n x 21) #>      C_ss  m * (n x 21) #> Computed Fields: #>          Name                   Size #>         D_int           m * (n x 21) #>     C_invitro           m * (n x 21) #>          resp        m * (1 * n x 5) #>   sensitivity  5 * (m * (1 * n x 5)) #> Other Fields: par, boundaries, exposure, css_sensitivity, hill_params plot(geoTox) plot(geoTox, type = \"hill\") plot(geoTox, type = \"sensitivity\") #> Picking joint bandwidth of 0.131"},{"path":"https://github.com/NIEHS/GeoTox/articles/GeoTox.html","id":"analysis-of-multiple-assay","dir":"Articles","previous_headings":"","what":"Analysis of multiple assay","title":"GeoTox Introduction","text":"Create GeoTox object, run simulations computations Plot outputs","code":"set.seed(2357) geoTox <- GeoTox() |>    # Set region and group boundaries (for plotting)   set_boundaries(region = geo_tox_data$boundaries$county,                  group  = geo_tox_data$boundaries$state) |>    # Simulate populations for each region   simulate_population(age           = split(geo_tox_data$age, ~FIPS),                       obesity       = geo_tox_data$obesity,                       exposure      = split(geo_tox_data$exposure, ~FIPS),                       simulated_css = geo_tox_data$simulated_css,                       n             = n) |>    # Estimated Hill parameters   set_hill_params(geo_tox_data$dose_response |>                     fit_hill(assay = \"endp\", chem = \"casn\") |>                      filter(!tp.sd.imputed, !logAC50.sd.imputed)) |>   # Calculate response   calculate_response() |>   # Perform sensitivity analysis   sensitivity_analysis()  geoTox #> GeoTox object #> Assays: 13 #> Chemicals: 15 #> Regions: m = 100 #> Population: n = 250 #> Data Fields: #>      Name          Size #>       age       m * (n) #>        IR       m * (n) #>   obesity       m * (n) #>     C_ext  m * (n x 21) #>      C_ss  m * (n x 21) #> Computed Fields: #>          Name                    Size #>         D_int            m * (n x 21) #>     C_invitro            m * (n x 21) #>          resp        m * (13 * n x 6) #>   sensitivity  5 * (m * (13 * n x 6)) #> Other Fields: par, boundaries, exposure, css_sensitivity, hill_params plot(geoTox) #> Warning: Multiple assays found, using first assay 'APR_HepG2_p53Act_24hr' plot(geoTox, assays = \"TOX21_H2AX_HTRF_CHO_Agonist_ratio\") plot(geoTox, type = \"hill\") plot(geoTox, type = \"sensitivity\") #> Warning: Multiple assays found, using first assay 'APR_HepG2_p53Act_24hr' #> Warning: Removed 93000 NA values #> Picking joint bandwidth of 0.135 plot(geoTox, type = \"sensitivity\", assay = \"TOX21_H2AX_HTRF_CHO_Agonist_ratio\") #> Picking joint bandwidth of 0.131"},{"path":"https://github.com/NIEHS/GeoTox/articles/GeoTox.html","id":"exposure-map","dir":"Articles","previous_headings":"","what":"Exposure Map","title":"GeoTox Introduction","text":"exposure map single multiple assay analyses. map shows distribution chemical exposure across regions chemicals, just used particular analysis.  facet labels present can specified using chem_label argument.","code":"plot(geoTox, type = \"exposure\", ncol = 5) plot(geoTox, type = \"exposure\", chem_label = \"chnm\", ncol = 5)"},{"path":[]},{"path":"https://github.com/NIEHS/GeoTox/articles/package_data.html","id":"exposure-data","dir":"Articles","previous_headings":"Chemical data","what":"Exposure data","title":"GeoTox Package Data","text":"Download modeled exposure data AirToxScreen. Results AirToxScreen 2019 subset chemicals North Carolina counties included package data geo_tox_data$exposure. NOTE: 2019 data can found following “Previous air toxics assessments” link.","code":"filename <- \"2019_Toxics_Exposure_Concentrations.xlsx\" tmp <- tempfile(filename) download.file(   paste0(\"https://www.epa.gov/system/files/documents/2022-12/\", filename),   tmp ) exposure <- read_xlsx(tmp)  # Normalization function min_max_norm = function(x) {   min_x <- min(x, na.rm = TRUE)   max_x <- max(x, na.rm = TRUE)   if (min_x == max_x) {     rep(0, length(x))   } else {     (x - min_x) / (max_x - min_x)   } }  geo_tox_data$exposure <- exposure |>    # North Carolina counties   filter(State == \"NC\", !grepl(\"0$\", FIPS)) |>    # Aggregate chemicals by county   summarize(across(-c(State:Tract), c(mean, sd)), .by = FIPS) |>    pivot_longer(-FIPS, names_to = \"chemical\") |>    mutate(stat = if_else(grepl(\"_1$\", chemical), \"mean\", \"sd\"),          chemical = gsub('.{2}$', '', chemical)) |>    pivot_wider(names_from = stat) |>    # Normalize concentrations   mutate(norm = min_max_norm(mean), .by = chemical)"},{"path":"https://github.com/NIEHS/GeoTox/articles/package_data.html","id":"get-casrn-and-preferred_name-from-comptox-dashboard","dir":"Articles","previous_headings":"Chemical data > Exposure data","what":"Get CASRN and PREFERRED_NAME from CompTox Dashboard","title":"GeoTox Package Data","text":"","code":"# Copy/paste the chemical names into the batch search field # https://comptox.epa.gov/dashboard/batch-search cat(geo_tox_data$exposure |> distinct(chemical) |> pull(), sep = \"\\n\") # Export results with \"CAS-RN\" identifiers as a csv file, then process in R  exposure_casrn <- read_csv(\"CCD-Batch-Search.csv\",                            show_col_types = FALSE) |>    filter(DTXSID != \"N/A\",          !grepl(\"WARNING\", FOUND_BY))  # Update exposure data with CompTox Dashboard data geo_tox_data$exposure <- geo_tox_data$exposure |>    inner_join(exposure_casrn, by = join_by(chemical == INPUT)) |>    select(FIPS, casn = CASRN, chnm = PREFERRED_NAME, mean, sd, norm)"},{"path":"https://github.com/NIEHS/GeoTox/articles/package_data.html","id":"ice-chts-data","dir":"Articles","previous_headings":"Chemical data","what":"ICE cHTS data","title":"GeoTox Package Data","text":"Use ICE cHTS data identify active chemicals given set assays.","code":"get_cHTS_hits <- function(assays = NULL, chemids = NULL) {      if (is.null(assays) & is.null(chemids)) {     stop(\"Must provide at least one of 'assays' or 'chemids'\")   }      # Format query parameters   req_params <- list()      if (!is.null(assays)) {     if (!is.list(assays)) assays <- as.list(assays)     req_params$assays <- assays   }      if (!is.null(chemids)) {     if (!is.list(chemids)) chemids <- as.list(chemids)     req_params$chemids <- chemids   }      # Query ICE API   resp <- request(\"https://ice.ntp.niehs.nih.gov/api/v1/search\") |>      req_body_json(req_params) |>      req_perform()      if (resp$status_code != 200) {     stop(\"Failed to retrieve data from ICE API\")   }      # Return active chemicals   result <- resp |> resp_body_json() |> pluck(\"endPoints\")      fields <- c(\"assay\", \"casrn\", \"dtxsid\", \"substanceName\",               \"endpoint\", \"value\")      map(fields, \\(x) map_chr(result, x)) |>      set_names(fields) |>     bind_cols() |>      filter(endpoint == \"Call\", value == \"Active\") |>      select(-c(endpoint, value)) |>      distinct() }  assays <- c(\"APR_HepG2_p53Act_1hr\",             \"APR_HepG2_p53Act_24hr\",             \"APR_HepG2_p53Act_72hr\",             \"ATG_p53_CIS\",             \"TOX21_DT40_LUC\",             \"TOX21_DT40_100_LUC\",             \"TOX21_DT40_657_LUC\",             \"TOX21_ELG1_LUC_Agonist\",             \"TOX21_H2AX_HTRF_CHO_Agonist_ratio\",             \"TOX21_p53_BLA_p1_ratio\",             \"TOX21_p53_BLA_p2_ratio\",             \"TOX21_p53_BLA_p3_ratio\",             \"TOX21_p53_BLA_p4_ratio\",             \"TOX21_p53_BLA_p5_ratio\")  chemids <- unique(geo_tox_data$exposure$casn)    cHTS_hits_API <- get_cHTS_hits(assays = assays, chemids = chemids)"},{"path":"https://github.com/NIEHS/GeoTox/articles/package_data.html","id":"dose-response-data","dir":"Articles","previous_headings":"Chemical data","what":"Dose-response data","title":"GeoTox Package Data","text":"Use ICE API retrieve dose-response data selected assays chemicals.","code":"get_ICE_dose_resp <- function(assays = NULL, chemids = NULL) {      if (is.null(assays) & is.null(chemids)) {     stop(\"Must provide at least one of 'assays' or 'chemids'\")   }      # Format query parameters   req_params <- list()      if (!is.null(assays)) {     if (!is.list(assays)) assays <- as.list(assays)     req_params$assays <- assays   }      if (!is.null(chemids)) {     if (!is.list(chemids)) chemids <- as.list(chemids)     req_params$chemids <- chemids   }      # Query ICE API   resp <- request(\"https://ice.ntp.niehs.nih.gov/api/v1/curves\") |>      req_body_json(req_params) |>      req_perform()      if (resp$status_code != 200) {     stop(\"Failed to retrieve data from ICE API\")   }      # Return dose-response data   result <- resp |> resp_body_json() |> pluck(\"curves\")      map(result, function(x) {     tibble(       endp = x[[\"assay\"]],       casn = x[[\"casrn\"]],       call = x[[\"dsstoxsid\"]],       chnm = x[[\"substance\"]],       call = x[[\"call\"]],       logc = map_dbl(x[[\"concentrationResponses\"]], \"concentration\") |> log10(),       resp = map_dbl(x[[\"concentrationResponses\"]], \"response\")     )   }) |>      bind_rows() }  assays <- unique(cHTS_hits_API$assay)  chemids <- intersect(cHTS_hits_API$casrn, geo_tox_data$exposure$casn)  dose_response <- get_ICE_dose_resp(assays = assays, chemids = chemids)  # Only keep active calls for assay/chemical combinations geo_tox_data$dose_response <- dose_response |>    filter(call == \"Active\") |>    select(-call)  # Update dose-response data with CompTox Dashboard data geo_tox_data$dose_response <- geo_tox_data$dose_response |>   inner_join(exposure_casrn, by = join_by(casn == CASRN)) |>   select(endp, casn, chnm = PREFERRED_NAME, logc, resp)"},{"path":[]},{"path":"https://github.com/NIEHS/GeoTox/articles/package_data.html","id":"age","dir":"Articles","previous_headings":"Population data","what":"Age","title":"GeoTox Package Data","text":"Download age data U.S. Census Bureau searching “County Population Characteristics”. subset data North Carolina 2019 included package data geo_tox_data$age.","code":"# Data for North Carolina url <- paste0(\"https://www2.census.gov/programs-surveys/popest/datasets/\",               \"2010-2020/counties/asrh/CC-EST2020-ALLDATA-37.csv\") age <- read_csv(url, show_col_types = FALSE)  geo_tox_data$age <- age |>   # 7/1/2019 population estimate   filter(YEAR == 12) |>   # Create FIPS   mutate(FIPS = str_c(STATE, COUNTY)) |>   # Keep selected columns   select(FIPS, AGEGRP, TOT_POP)"},{"path":"https://github.com/NIEHS/GeoTox/articles/package_data.html","id":"obesity","dir":"Articles","previous_headings":"Population data","what":"Obesity","title":"GeoTox Package Data","text":"Follow “Data Portal” link CDC PLACES search “places county data”. Go desired dataset webpage, example 2020 county data, download data selecting Actions → API → Download file. subset data North Carolina included package data geo_tox_data$obesity.","code":"places <- read_csv(\"PLACES__County_Data_(GIS_Friendly_Format),_2020_release.csv\",                    show_col_types = FALSE)  # Convert confidence interval to standard deviation extract_SD <- function(x) {   range <- as.numeric(str_split_1(str_sub(x, 2, -2), \",\"))   diff(range) / 3.92 }  geo_tox_data$obesity <- places |>   # North Carolina Counties   filter(StateAbbr == \"NC\") |>   # Select obesity data   select(FIPS = CountyFIPS, OBESITY_CrudePrev, OBESITY_Crude95CI) |>   # Change confidence interval to standard deviation   rowwise() |>   mutate(OBESITY_SD = extract_SD(OBESITY_Crude95CI)) |>   ungroup() |>   select(-OBESITY_Crude95CI)"},{"path":"https://github.com/NIEHS/GeoTox/articles/package_data.html","id":"steady-state-plasma-concentration-c_ss","dir":"Articles","previous_headings":"Population data","what":"Steady-state plasma concentration (C_ss)","title":"GeoTox Package Data","text":"Use httk generate C_ss values combinations age group weight status chemical. generation values time-intensive step, one approach generate populations C_ss values initially sample later.","code":"set.seed(2345) n_samples <- 500  # Get CASN for which httk simulation is possible. Try using load_dawson2021, # load_sipes2017, or load_pradeep2020 to increase availability. load_sipes2017() casn <- intersect(unique(geo_tox_data$dose_response$casn),                   get_cheminfo(suppress.messages = TRUE))  # Define population demographics for httk simulation pop_demo <- cross_join(   tibble(age_group = list(c(0, 2), c(3, 5), c(6, 10), c(11, 15),                           c(16, 20), c(21, 30), c(31, 40), c(41, 50),                           c(51, 60), c(61, 70), c(71, 100))),   tibble(weight = c(\"Normal\", \"Obese\"))) |>   # Create column of lower age_group values   rowwise() |>   mutate(age_min = age_group[1]) |>   ungroup()  # Create wrapper function around httk steps simulate_css <- function(chem.cas, agelim_years, weight_category,                          samples, verbose = TRUE) {      if (verbose) {     cat(chem.cas,         paste0(\"(\", paste(agelim_years, collapse = \", \"), \")\"),         weight_category,         \"\\n\")   }      httkpop <- list(method = \"vi\",                   gendernum = NULL,                   agelim_years = agelim_years,                   agelim_months = NULL,                   weight_category = weight_category,                   reths = c(                     \"Mexican American\",                     \"Other Hispanic\",                     \"Non-Hispanic White\",                     \"Non-Hispanic Black\",                     \"Other\"                   ))      css <- try(     suppressWarnings({       mcs <- create_mc_samples(chem.cas = chem.cas,                                samples = samples,                                httkpop.generate.arg.list = httkpop,                                suppress.messages = TRUE)              calc_analytic_css(chem.cas = chem.cas,                         parameters = mcs,                         model = \"3compartmentss\",                         suppress.messages = TRUE)     }),     silent = TRUE   )      # Return   if (is(css, \"try-error\")) {     warning(paste0(\"simulate_css failed to generate data for CASN \", chem.cas))     list(NA)   } else {     list(css)   } }  # Simulate `C_ss` values simulated_css <- map(casn, function(chem.cas) {   pop_demo |>     rowwise() |>     mutate(       css = simulate_css(.env$chem.cas, age_group, weight, .env$n_samples)     ) |>     ungroup() }) simulated_css <- setNames(simulated_css, casn)  # Remove CASN that failed simulate_css casn_keep <- map_lgl(simulated_css, function(df) {   !(length(df$css[[1]]) == 1 && is.na(df$css[[1]])) }) simulated_css <- simulated_css[casn_keep]  # Get median `C_ss` values for each age_group simulated_css <- map(   simulated_css,   function(cas_df) {     cas_df |>       nest(.by = age_group) |>       mutate(         age_median_css = map_dbl(data, function(df) median(unlist(df$css),                                                            na.rm = TRUE))       ) |>       unnest(data)   } )  # Get median `C_ss` values for each weight simulated_css <- map(   simulated_css,   function(cas_df) {     cas_df |>       nest(.by = weight) |>       mutate(         weight_median_css = map_dbl(data, function(df) median(unlist(df$css),                                                               na.rm = TRUE))       ) |>       unnest(data) |>       arrange(age_min, weight)   } )  geo_tox_data$simulated_css <- simulated_css"},{"path":"https://github.com/NIEHS/GeoTox/articles/package_data.html","id":"prune-data","dir":"Articles","previous_headings":"","what":"Prune data","title":"GeoTox Package Data","text":"Retain chemicals found exposure, dose-response C_ss datasets.","code":"casn_keep <- names(geo_tox_data$simulated_css)  geo_tox_data$exposure <- geo_tox_data$exposure |>    filter(casn %in% casn_keep)  geo_tox_data$dose_response <- geo_tox_data$dose_response |>    filter(casn %in% casn_keep)"},{"path":"https://github.com/NIEHS/GeoTox/articles/package_data.html","id":"countystate-boundaries","dir":"Articles","previous_headings":"","what":"County/State boundaries","title":"GeoTox Package Data","text":"Download cartographic boundary files counties states U.S. Census Bureau. geometry data North Carolina counties state included package data geo_tox_data$boundaries.","code":"county <- st_read(\"cb_2019_us_county_5m/cb_2019_us_county_5m.shp\") state <- st_read(\"cb_2019_us_state_5m/cb_2019_us_state_5m.shp\")  geo_tox_data$boundaries <- list(   county = county |>     filter(STATEFP == 37) |>     select(FIPS = GEOID, geometry),   state = state |>     filter(STATEFP == 37) |>     select(geometry) )"},{"path":"https://github.com/NIEHS/GeoTox/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Skylar Marvel. Author. David Reif. Author. Kyle Messier. Maintainer, author. Spatiotemporal Exposures Toxicology Group. Copyright holder.","code":""},{"path":"https://github.com/NIEHS/GeoTox/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Messier K, Reif D, Marvel S (2025). “GeoTox Package: open-source software connecting spatiotemporal exposure individual population-level risk.” Human Genomics, 19(1), 5. doi:10.1186/s40246-024-00711-8, https://doi.org/10.1186/s40246-024-00711-8. Eccles, M K, Karmaus, L , Kleinstreuer, C N, Parham, Fred, Rider, V C, Wambaugh, F J, Messier, P K (2023). “geospatial modeling approach quantifying risk exposure environmental chemical mixtures via common molecular target.” Science Total Environment, 855, 158905.","code":"@Article{,   author = {Kyle P. Messier and David M. Reif and Skylar W. Marvel},   title = {The GeoTox Package: open-source software for connecting spatiotemporal exposure to individual and population-level risk},   journal = {Human Genomics},   year = {2025},   volume = {19},   number = {1},   pages = {5},   doi = {10.1186/s40246-024-00711-8},   url = {https://doi.org/10.1186/s40246-024-00711-8}, } @Article{,   author = {{Eccles} and Kristin M and {Karmaus} and Agnes L and {Kleinstreuer} and Nicole C and {Parham} and {Fred} and {Rider} and Cynthia V and {Wambaugh} and John F and {Messier} and Kyle P},   title = {A geospatial modeling approach to quantifying the risk of exposure to environmental chemical mixtures via a common molecular target},   journal = {Science of The Total Environment},   volume = {855},   pages = {158905},   year = {2023},   publisher = {Elsevier}, }"},{"path":"https://github.com/NIEHS/GeoTox/index.html","id":"geotox-","dir":"","previous_headings":"","what":"Spatiotemporal Mixture Risk Assessment","title":"Spatiotemporal Mixture Risk Assessment","text":"GeoTox open-source R software package characterizing risk perturbing molecular targets involved adverse human health outcomes based exposure spatially-referenced stressor mixtures via GeoTox framework - otherwise known source--outcome-continuum modeling. package, methods, case-studies described Messier, Reif, Marvel, 2025, Human Genomics. GeoTox framework first described Eccles et al. geospatial modeling approach quantifying risk exposure environmental chemical mixtures via common molecular target. Sci Total Environ. 2023 Jan 10;855:158905.","code":""},{"path":"https://github.com/NIEHS/GeoTox/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Spatiotemporal Mixture Risk Assessment","text":"","code":"install.packages(\"GeoTox\")"},{"path":"https://github.com/NIEHS/GeoTox/index.html","id":"development-version","dir":"","previous_headings":"","what":"Development Version","title":"Spatiotemporal Mixture Risk Assessment","text":"development version can installed GitHub.","code":"#install.packages(\"pak\") pak::pak(\"NIEHS/GeoTox\")"},{"path":"https://github.com/NIEHS/GeoTox/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Spatiotemporal Mixture Risk Assessment","text":"Figure 1 shows steps source--outcome-continuum GeoTox modeling framework capable GeoTox package. blue text nodes represent object green text, rounded nodes represent methodology function required go one next. GeoTox package uses R S3 object-oriented programming create GeoTox object. GeoTox object list contains information required run analysis including tracking exposure, assays, dose-response, geospatial referencing. Figure 1: Overview steps GeoTox framework","code":""},{"path":"https://github.com/NIEHS/GeoTox/index.html","id":"getting-started","dir":"","previous_headings":"","what":"Getting Started","title":"Spatiotemporal Mixture Risk Assessment","text":"Please refer package website detailed description use GeoTox.","code":""},{"path":"https://github.com/NIEHS/GeoTox/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Spatiotemporal Mixture Risk Assessment","text":"citation information, please refer CITATION file.","code":""},{"path":"https://github.com/NIEHS/GeoTox/index.html","id":"issues-and-contributions","dir":"","previous_headings":"","what":"Issues and Contributions","title":"Spatiotemporal Mixture Risk Assessment","text":"add edit functionality, open pull request main branch detailed description proposed changes. Pull requests must pass status checks, approved rejected GeoTox maintainers. Utilize GitHub issues notify authors bugs, questions, recommendations. Identify issue appropriate label help ensure timely response.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/GeoTox-package.html","id":null,"dir":"Reference","previous_headings":"","what":"GeoTox: Spatiotemporal Mixture Risk Assessment — GeoTox-package","title":"GeoTox: Spatiotemporal Mixture Risk Assessment — GeoTox-package","text":"Connecting spatiotemporal exposure individual population-level risk via source--outcome continuum modeling. package, methods, case-studies described Messier, Reif, Marvel (2025) doi:10.1186/s40246-024-00711-8  Eccles et al. (2023) doi:10.1016/j.scitotenv.2022.158905 .","code":""},{"path":[]},{"path":"https://github.com/NIEHS/GeoTox/reference/GeoTox-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"GeoTox: Spatiotemporal Mixture Risk Assessment — GeoTox-package","text":"Maintainer: Kyle Messier kyle.messier@nih.gov (ORCID) Authors: Skylar Marvel skylar.marvel@nih.gov (ORCID) David Reif david.reif@nih.gov (ORCID) contributors: Spatiotemporal Exposures Toxicology Group [copyright holder]","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/GeoTox.html","id":null,"dir":"Reference","previous_headings":"","what":"GeoTox S3 object — GeoTox","title":"GeoTox S3 object — GeoTox","text":"S3 object can used help organize data results GeoTox analysis.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/GeoTox.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"GeoTox S3 object — GeoTox","text":"","code":"GeoTox()  # S3 method for class 'GeoTox' plot(x, type = c(\"resp\", \"hill\", \"exposure\", \"sensitivity\"), ...)"},{"path":"https://github.com/NIEHS/GeoTox/reference/GeoTox.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"GeoTox S3 object — GeoTox","text":"x GeoTox object. type type plot. ... arguments passed subsequent methods.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/GeoTox.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"GeoTox S3 object — GeoTox","text":"GeoTox S3 object","code":""},{"path":[]},{"path":"https://github.com/NIEHS/GeoTox/reference/GeoTox.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"GeoTox S3 object — GeoTox","text":"","code":"# See the vignette for a full example: #   vignette(\"introduction\", package = \"geotox\")  if (FALSE) { # \\dontrun{ # Use a subset of the package data for demonstration purposes set.seed(2357) n <- 10 # Population size m <- 2 # Number of regions idx <- if (m < 100) sample(1:100, m) else 1:100  geoTox <- GeoTox() |>   # Set region and group boundaries (for plotting)   set_boundaries(region = geo_tox_data$boundaries$county,                  group  = geo_tox_data$boundaries$state) |>   # Simulate populations for each region   simulate_population(age           = split(geo_tox_data$age, ~FIPS)[idx],                       obesity       = geo_tox_data$obesity[idx, ],                       exposure      = split(geo_tox_data$exposure, ~FIPS)[idx],                       simulated_css = geo_tox_data$simulated_css,                       n             = n) |>   # Estimated Hill parameters   set_hill_params(geo_tox_data$dose_response |>                     fit_hill(assay = \"endp\", chem = \"casn\") |>                     dplyr::filter(!tp.sd.imputed, !logAC50.sd.imputed)) |>   # Calculate response   calculate_response() |>   # Perform sensitivity analysis   sensitivity_analysis()  # Print GeoTox object geoTox  # Plot hill fits plot(geoTox, type = \"hill\") # Plot exposure data plot(geoTox, type = \"exposure\", ncol = 5) # Plot response data plot(geoTox, assays = \"TOX21_H2AX_HTRF_CHO_Agonist_ratio\") # Plot sensitivity data plot(geoTox,      type = \"sensitivity\",      assay = \"TOX21_H2AX_HTRF_CHO_Agonist_ratio\") } # }"},{"path":"https://github.com/NIEHS/GeoTox/reference/calc_concentration_response.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the mixture response from one of three different approaches: IA, GCA, or Hazard Quotient — calc_concentration_response","title":"Calculate the mixture response from one of three different approaches: IA, GCA, or Hazard Quotient — calc_concentration_response","text":"Calculate combined response multiple chemicals. calculates generalized concentration addition response, independent action response, hazard quotient","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/calc_concentration_response.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the mixture response from one of three different approaches: IA, GCA, or Hazard Quotient — calc_concentration_response","text":"","code":"calc_concentration_response(   C_invitro,   hill_params,   max_mult = 1.5,   fixed = FALSE )"},{"path":"https://github.com/NIEHS/GeoTox/reference/calc_concentration_response.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the mixture response from one of three different approaches: IA, GCA, or Hazard Quotient — calc_concentration_response","text":"C_invitro vitro concentrations hill_params output fit_hill() max_mult upper bound multiplier max response fixed TRUE, sd = 0","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/calc_concentration_response.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the mixture response from one of three different approaches: IA, GCA, or Hazard Quotient — calc_concentration_response","text":"list data frames","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/calc_concentration_response.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate the mixture response from one of three different approaches: IA, GCA, or Hazard Quotient — calc_concentration_response","text":"","code":"C_invitro <- list(   matrix(1:8 / 1e3, ncol = 2, dimnames = list(NULL, c(\"c1\", \"c2\"))),   matrix(9:16 / 1e3, ncol = 2, dimnames = list(NULL, c(\"c1\", \"c2\"))) ) hill_params <- fit_hill(   data.frame(chem = rep(c(\"c1\", \"c2\"), each = 3),              logc = c(-1, 0, 1, 0, 1, 2),              resp = c(10, 5, 0, 4, 2, 0) / 10),   chem = \"chem\" )  calc_concentration_response(C_invitro, hill_params) #> [[1]] #>   sample     GCA.Eff      IA.Eff   GCA.HQ.10    IA.HQ.10 #> 1      1 0.183849941 0.183893327  5.28553221  5.28563746 #> 2      2 0.484278834 0.489458143 13.26584330 13.26572506 #> 3      3 0.023988052 0.024449693  1.16115966  1.16117227 #> 4      4 0.001461523 0.001462722  0.04062655  0.04062632 #>  #> [[2]] #>   sample     GCA.Eff      IA.Eff  GCA.HQ.10    IA.HQ.10 #> 1      1 0.001218893 0.001220453  0.0475080  0.04750807 #> 2      2 0.021832508 0.021930591  0.2312863  0.23128746 #> 3      3 0.110684704 0.115328461 11.0633429 11.06323273 #> 4      4 0.045493261 0.046659088  2.1877855  2.18778258 #>  calc_concentration_response(C_invitro, hill_params, fixed = TRUE) #> [[1]] #>   sample   GCA.Eff    IA.Eff GCA.HQ.10 IA.HQ.10 #> 1      1 0.2393398 0.2742427  13.49985     13.5 #> 2      2 0.3102525 0.3493325  23.39997     23.4 #> 3      3 0.3479706 0.3866123  33.29939     33.3 #> 4      4 0.3713827 0.4087487  43.19904     43.2 #>  #> [[2]] #>   sample   GCA.Eff    IA.Eff GCA.HQ.10 IA.HQ.10 #> 1      1 0.4200784 0.4517192  92.70122     92.7 #> 2      2 0.4246337 0.4554551 102.60133    102.6 #> 3      3 0.4284513 0.4585306 112.50143    112.5 #> 4      4 0.4316926 0.4611019 122.40154    122.4 #>"},{"path":"https://github.com/NIEHS/GeoTox/reference/calc_independent_action.html","id":null,"dir":"Reference","previous_headings":"","what":"Independent Action — calc_independent_action","title":"Independent Action — calc_independent_action","text":"Calculate independent action response set chemicals Hill concentration-response curves.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/calc_independent_action.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Independent Action — calc_independent_action","text":"","code":"calc_independent_action(conc, max, AC50, Emax, n = 1)"},{"path":"https://github.com/NIEHS/GeoTox/reference/calc_independent_action.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Independent Action — calc_independent_action","text":"conc concentrations regular space max maximal (asymptotic) responses AC50 concentrations half-maximal response Emax maximum mixture response n Hill coefficients (slopes)","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/calc_independent_action.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Independent Action — calc_independent_action","text":"response value","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/calc_independent_action.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Independent Action — calc_independent_action","text":"concentration computed : $$   IA = E_{max} \\times   \\left(     1 - \\prod\\limits_{} \\left(1 - \\frac{x_i}{E_{max}}\\right)   \\right), $$ \\(x_i = hill\\_val(conc_i, max_i, AC50_i, n_i)\\) Hill model response function chemical.","code":""},{"path":[]},{"path":"https://github.com/NIEHS/GeoTox/reference/calc_independent_action.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Independent Action — calc_independent_action","text":"","code":"n_chem <- 5 conc <- 10^sample(-1:4, n_chem, replace = TRUE) max <- 80 * runif(n_chem) AC50 <- 10^(5 * runif(n_chem) - 1) Emax <- 100  calc_independent_action(conc, max, AC50, Emax) #> [1] 87.93304"},{"path":"https://github.com/NIEHS/GeoTox/reference/calc_internal_dose.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate internal chemical dose — calc_internal_dose","title":"Calculate internal chemical dose — calc_internal_dose","text":"Estimate internal dose inhalation chemical given inhalation rate, time, body weight","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/calc_internal_dose.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate internal chemical dose — calc_internal_dose","text":"","code":"calc_internal_dose(C_ext, IR, time = 1, BW = 1, scaling = 1)"},{"path":"https://github.com/NIEHS/GeoTox/reference/calc_internal_dose.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate internal chemical dose — calc_internal_dose","text":"C_ext ambient chemical concentration \\(\\frac{mg}{m^3}\\) IR inhalation rate \\(\\frac{m^3}{day}\\) time total time \\(days\\) BW body weight \\(kg\\) scaling scaling factor encompassing required unit adjustments","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/calc_internal_dose.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate internal chemical dose — calc_internal_dose","text":"list matrices containing internal chemical doses \\(\\frac{mg}{kg}\\)","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/calc_internal_dose.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate internal chemical dose — calc_internal_dose","text":"Input C_ext must matrix list matrices. Input IR must atomic vector list atomic vectors. time, BW scaling arguments scalars. internal dose calculated : $$D_{int} = \\frac{C_{ext} \\times IR \\times time}{BW} \\times scaling$$","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/calc_internal_dose.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate internal chemical dose — calc_internal_dose","text":"","code":"# Single population C_ext <- matrix(1:15, ncol = 3) IR <- 1:5 calc_internal_dose(C_ext, IR) #> [[1]] #>      [,1] [,2] [,3] #> [1,]    1    6   11 #> [2,]    4   14   24 #> [3,]    9   24   39 #> [4,]   16   36   56 #> [5,]   25   50   75 #>   # Multiple populations C_ext <- list(   \"a\" = matrix(1:15 / 10, ncol = 3),   \"b\" = matrix(1:8, ncol = 2) ) IR <- list(1:5, 1:4 / 2) calc_internal_dose(C_ext, IR) #> $a #>      [,1] [,2] [,3] #> [1,]  0.1  0.6  1.1 #> [2,]  0.4  1.4  2.4 #> [3,]  0.9  2.4  3.9 #> [4,]  1.6  3.6  5.6 #> [5,]  2.5  5.0  7.5 #>  #> $b #>      [,1] [,2] #> [1,]  0.5  2.5 #> [2,]  2.0  6.0 #> [3,]  4.5 10.5 #> [4,]  8.0 16.0 #>"},{"path":"https://github.com/NIEHS/GeoTox/reference/calc_invitro_concentration.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate in vitro concentration — calc_invitro_concentration","title":"Calculate in vitro concentration — calc_invitro_concentration","text":"Estimate vitro equivalent plasma concentration given internal chemical dose steady-state plasma concentration.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/calc_invitro_concentration.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate in vitro concentration — calc_invitro_concentration","text":"","code":"calc_invitro_concentration(D_int, C_ss = NULL)"},{"path":"https://github.com/NIEHS/GeoTox/reference/calc_invitro_concentration.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate in vitro concentration — calc_invitro_concentration","text":"D_int internal chemical dose \\(\\frac{mg}{kg}\\) C_ss steady-state plasma concentration \\(\\frac{\\mu M}{mg / kg}\\)","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/calc_invitro_concentration.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate in vitro concentration — calc_invitro_concentration","text":"list matrices containing concentrations \\(\\mu M\\)","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/calc_invitro_concentration.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate in vitro concentration — calc_invitro_concentration","text":"Input D_int must matrix list matrices. Input C_ss must numeric atomic vector matrix, list types. vitro equivalent plasma concentration calculated : $$C_{plasma} = C_{ss} \\times D_{int}$$","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/calc_invitro_concentration.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate in vitro concentration — calc_invitro_concentration","text":"","code":"# Single population D_int <- matrix(1:15, ncol = 3) C_ss <- 1:5 calc_invitro_concentration(D_int, C_ss) #> [[1]] #>      [,1] [,2] [,3] #> [1,]    1    6   11 #> [2,]    4   14   24 #> [3,]    9   24   39 #> [4,]   16   36   56 #> [5,]   25   50   75 #>   # Multiple populations D_int <- list(   \"a\" = matrix(1:15 / 10, ncol = 3),   \"b\" = matrix(1:8, ncol = 2) ) C_ss <- list(1:5, 1:4 / 2) calc_invitro_concentration(D_int, C_ss) #> $a #>      [,1] [,2] [,3] #> [1,]  0.1  0.6  1.1 #> [2,]  0.4  1.4  2.4 #> [3,]  0.9  2.4  3.9 #> [4,]  1.6  3.6  5.6 #> [5,]  2.5  5.0  7.5 #>  #> $b #>      [,1] [,2] #> [1,]  0.5  2.5 #> [2,]  2.0  6.0 #> [3,]  4.5 10.5 #> [4,]  8.0 16.0 #>"},{"path":"https://github.com/NIEHS/GeoTox/reference/calculate_response.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate response — calculate_response","title":"Calculate response — calculate_response","text":"Calculate mixture response GeoTox population data","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/calculate_response.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate response — calculate_response","text":"","code":"calculate_response(x, ...)"},{"path":"https://github.com/NIEHS/GeoTox/reference/calculate_response.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate response — calculate_response","text":"x GeoTox object ... additional arguments passed functions. See details.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/calculate_response.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate response — calculate_response","text":"object additional fields added updated","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/calculate_response.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate response — calculate_response","text":"Additional parameters include time, BW, scaling calc_internal_dose, max_mult calc_concentration_response.","code":""},{"path":[]},{"path":"https://github.com/NIEHS/GeoTox/reference/calculate_response.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate response — calculate_response","text":"","code":"# Use a subset of the package data for demonstration purposes set.seed(2357) n <- 10 # Population size m <- 5 # Number of regions idx <- if (m < 100) sample(1:100, m) else 1:100  # Create GeoTox object and populate required fields geoTox <- GeoTox() |>   # Simulate populations for each region   simulate_population(age = split(geo_tox_data$age, ~FIPS)[idx],                       obesity = geo_tox_data$obesity[idx, ],                       exposure = split(geo_tox_data$exposure, ~FIPS)[idx],                       simulated_css = geo_tox_data$simulated_css,                       n = n) |>   # Estimated Hill parameters   set_hill_params(geo_tox_data$dose_response |>                     fit_hill(assay = \"endp\", chem = \"casn\") |>                     dplyr::filter(!tp.sd.imputed, !logAC50.sd.imputed))  # Response computations can now be done geoTox <- geoTox |> calculate_response()"},{"path":"https://github.com/NIEHS/GeoTox/reference/compute_sensitivity.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute response sensitivity to parameter variation. — compute_sensitivity","title":"Compute response sensitivity to parameter variation. — compute_sensitivity","text":"Compute response sensitivity parameter variation.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/compute_sensitivity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute response sensitivity to parameter variation. — compute_sensitivity","text":"","code":"compute_sensitivity(   x,   vary = c(\"age\", \"obesity\", \"css_params\", \"fit_params\", \"C_ext\"),   max_mult = NULL )"},{"path":"https://github.com/NIEHS/GeoTox/reference/compute_sensitivity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute response sensitivity to parameter variation. — compute_sensitivity","text":"x GeoTox object. vary parameter vary. max_mult input calc_concentration_response step.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/compute_sensitivity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute response sensitivity to parameter variation. — compute_sensitivity","text":"output calc_concentration_response","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/compute_sensitivity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute response sensitivity to parameter variation. — compute_sensitivity","text":"","code":"# Use a subset of the package data for demonstration purposes set.seed(2357) n <- 10 # Population size m <- 5 # Number of regions idx <- if (m < 100) sample(1:100, m) else 1:100  # Create GeoTox object and populate required fields geoTox <- GeoTox() |>   # Simulate populations for each region   simulate_population(age = split(geo_tox_data$age, ~FIPS)[idx],                       obesity = geo_tox_data$obesity[idx, ],                       exposure = split(geo_tox_data$exposure, ~FIPS)[idx],                       simulated_css = geo_tox_data$simulated_css,                       n = n) |>   # Estimated Hill parameters   set_hill_params(geo_tox_data$dose_response |>                     fit_hill(assay = \"endp\", chem = \"casn\") |>                     dplyr::filter(!tp.sd.imputed, !logAC50.sd.imputed))  # Sensitivity computations can now be done age_resp <- geoTox |> compute_sensitivity() obesity_resp <- geoTox |> compute_sensitivity(vary = \"obesity\")"},{"path":"https://github.com/NIEHS/GeoTox/reference/fit_hill.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit 2- or 3-parameter Hill model — fit_hill","title":"Fit 2- or 3-parameter Hill model — fit_hill","text":"Fit 2- 3-parameter Hill model","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/fit_hill.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit 2- or 3-parameter Hill model — fit_hill","text":"","code":"fit_hill(   x,   conc = \"logc\",   resp = \"resp\",   fixed_slope = TRUE,   chem = NULL,   assay = NULL )"},{"path":"https://github.com/NIEHS/GeoTox/reference/fit_hill.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit 2- or 3-parameter Hill model — fit_hill","text":"x data frame dose response data. conc column name base-10 log scaled concentration. resp column name response. fixed_slope TRUE, slope fixed 1. chem (optional) column name chemical identifiers. assay (optional) column name assay identifiers.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/fit_hill.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit 2- or 3-parameter Hill model — fit_hill","text":"data frame fit parameters.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/fit_hill.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fit 2- or 3-parameter Hill model — fit_hill","text":"Optional chem assay identifiers can used fit multiple chemicals /assays. Returned columns tp top asymptote logAC50 50% response concentration. computation standard deviations two parameters fails, standard deviation set equal parameter estimate indicated respective imputed flag TRUE.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/fit_hill.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit 2- or 3-parameter Hill model — fit_hill","text":"","code":"# Multiple assays, multiple chemicals df <- geo_tox_data$dose_response fit_hill(df, assay = \"endp\", chem = \"casn\") #> # A tibble: 85 × 15 #>    assay   chem     tp tp.sd logAC50 logAC50.sd slope slope.sd logc_min logc_max #>    <chr>   <chr> <dbl> <dbl>   <dbl>      <dbl> <dbl>    <dbl>    <dbl>    <dbl> #>  1 APR_He… 510-…  4.44 5.86     2.06      0.448     1        0   -0.398     2.30 #>  2 APR_He… 92-8…  2.14 0.945    2.05      0.271     1        0   -0.398     2.30 #>  3 APR_He… 95-9…  1.46 0.556    1.67      0.246     1        0   -0.699     2    #>  4 APR_He… 510-…  2.33 0.542    1.79      0.192     1        0   -0.398     2.30 #>  5 APR_He… 72-4…  1.93 1.93     1.95      1.95      1        0   -0.398     2.30 #>  6 APR_He… 92-8…  2.43 1.50     2.22      0.317     1        0   -0.398     2.30 #>  7 ATG_p5… 87-8…  2.15 0.877    1.57      0.321     1        0   -1.30      2    #>  8 TOX21_… 100-…  0    0        1.45      1.45      1        0   -3         1.95 #>  9 TOX21_… 101-…  0    0        1.45      1.45      1        0   -3         1.95 #> 10 TOX21_… 119-…  0    0        1.10      1.10      1        0   -3         1.95 #> # ℹ 75 more rows #> # ℹ 5 more variables: resp_min <dbl>, resp_max <dbl>, AIC <dbl>, #> #   tp.sd.imputed <lgl>, logAC50.sd.imputed <lgl>  # Single assay, multiple chemicals df <- geo_tox_data$dose_response |>   dplyr::filter(endp == \"TOX21_H2AX_HTRF_CHO_Agonist_ratio\") fit_hill(df, chem = \"casn\") #> # A tibble: 6 × 14 #>   chem     tp tp.sd logAC50 logAC50.sd slope slope.sd logc_min logc_max resp_min #>   <chr> <dbl> <dbl>   <dbl>      <dbl> <dbl>    <dbl>    <dbl>    <dbl>    <dbl> #> 1 119-…  65.6 65.6     2.09     2.09       1        0    -2.70     2.30    -3.01 #> 2 120-… 126.   8.29    1.54     0.0796     1        0    -2.70     2.30    -5.22 #> 3 123-… 186.  17.8     2.21     0.0808     1        0    -2.70     2.30    -3.45 #> 4 510-…  48.5  7.47    2.24     0.123      1        0    -2.70     2.30    -2.38 #> 5 88-0…  58.7 37.0     2.80     0.310      1        0    -2.70     2.30    -4.79 #> 6 92-8…  73.7  7.22    2.06     0.0863     1        0    -2.70     2.30    -4.44 #> # ℹ 4 more variables: resp_max <dbl>, AIC <dbl>, tp.sd.imputed <lgl>, #> #   logAC50.sd.imputed <lgl>  # Single assay, single chemical df <- geo_tox_data$dose_response |>   dplyr::filter(endp == \"TOX21_H2AX_HTRF_CHO_Agonist_ratio\",                 casn == \"510-15-6\") fit_hill(df) #> # A tibble: 1 × 13 #>      tp tp.sd logAC50 logAC50.sd slope slope.sd logc_min logc_max resp_min #>   <dbl> <dbl>   <dbl>      <dbl> <dbl>    <dbl>    <dbl>    <dbl>    <dbl> #> 1  48.5  7.47    2.24      0.123     1        0    -2.70     2.30    -2.38 #> # ℹ 4 more variables: resp_max <dbl>, AIC <dbl>, tp.sd.imputed <lgl>, #> #   logAC50.sd.imputed <lgl> # 3-parameter Hill model fit_hill(df, fixed_slope = FALSE) #> # A tibble: 1 × 13 #>      tp tp.sd logAC50 logAC50.sd slope slope.sd logc_min logc_max resp_min #>   <dbl> <dbl>   <dbl>      <dbl> <dbl>    <dbl>    <dbl>    <dbl>    <dbl> #> 1  31.2  1.29    1.83     0.0173  4.02    0.864    -2.70     2.30    -2.38 #> # ℹ 4 more variables: resp_max <dbl>, AIC <dbl>, tp.sd.imputed <lgl>, #> #   logAC50.sd.imputed <lgl>"},{"path":"https://github.com/NIEHS/GeoTox/reference/geo_tox_data.html","id":null,"dir":"Reference","previous_headings":"","what":"GeoTox Data — geo_tox_data","title":"GeoTox Data — geo_tox_data","text":"Sample data use vignettes function examples. See Package Data vignette, vignette(\"package_data\", package = \"GeoTox\"), details data gathered.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/geo_tox_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"GeoTox Data — geo_tox_data","text":"","code":"geo_tox_data"},{"path":"https://github.com/NIEHS/GeoTox/reference/geo_tox_data.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"GeoTox Data — geo_tox_data","text":"list items: exposure 2019 AirToxScreen exposure concentrations subset chemicals North Carolina counties. dose_response Subset chemicals curated ICE cHTS active within set assays. age County population estimates 7/1/2019 North Carolina. obesity CDC PLACES obesity data North Carolina counties 2020. simulated_css Simulated steady-state plasma concentrations various age groups obesity status combinations. boundaries County state boundaries North Carolina 2019.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/get_fixed_age.html","id":null,"dir":"Reference","previous_headings":"","what":"Get C_ss Data for Fixed Age — get_fixed_age","title":"Get C_ss Data for Fixed Age — get_fixed_age","text":"Get C_ss Data Fixed Age","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/get_fixed_age.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get C_ss Data for Fixed Age — get_fixed_age","text":"","code":"get_fixed_age(simulated_css, age)"},{"path":"https://github.com/NIEHS/GeoTox/reference/get_fixed_age.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get C_ss Data for Fixed Age — get_fixed_age","text":"simulated_css list pre-generated C_ss data, details see: vignette(\"package_data\", package = \"GeoTox\"). age list atomic vectors containing ages.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/get_fixed_age.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get C_ss Data for Fixed Age — get_fixed_age","text":"list matrices containing median C_ss values.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/get_fixed_age.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get C_ss Data for Fixed Age — get_fixed_age","text":"","code":"get_fixed_age(simulated_css = geo_tox_data$simulated_css,               age = list(c(25, 35, 55), c(15, 60))) #> [[1]] #>      100-02-7 101-14-4 101-77-9 119-90-4 120-80-9 123-31-9 133-06-2 51-28-5 #> [1,]  0.97155  0.22695   1.3000   7.0115   1.4020  0.29070   2.1865  115.20 #> [2,]  1.19200  0.26170   1.6020   7.3330   1.9675  0.37445   2.7410  134.05 #> [3,]  1.57650  0.32895   2.0525   9.0755   2.7680  0.53645   3.8135  158.40 #>      510-15-6 53-96-3 56-38-2 60-11-7 63-25-2 72-43-5 84-74-2 87-86-5 88-06-2 #> [1,]  0.12195  2.9560  4.1375  2.2505 0.13680  4.6045  1.2480  1.6330  3.7475 #> [2,]  0.14295  3.5485  5.2695  2.7000 0.18190  5.9545  1.6265  2.2385  4.5155 #> [3,]  0.19755  4.7305  7.1695  4.0020 0.22545  7.6990  2.3585  2.8580  5.9575 #>      91-94-1 92-87-5 95-80-7 95-95-4 #> [1,] 0.16620  0.9798  3.4250  6.8665 #> [2,] 0.21995  1.2320  3.7445  8.4465 #> [3,] 0.27775  1.5465  4.4495 10.2700 #>  #> [[2]] #>      100-02-7 101-14-4 101-77-9 119-90-4 120-80-9 123-31-9 133-06-2 51-28-5 #> [1,]   0.7077  0.15945  0.99965   5.2580   1.1285  0.21640   1.6310  94.345 #> [2,]   1.5765  0.32895  2.05250   9.0755   2.7680  0.53645   3.8135 158.400 #>      510-15-6 53-96-3 56-38-2 60-11-7 63-25-2 72-43-5 84-74-2 87-86-5 88-06-2 #> [1,] 0.092665  2.1605  3.4310  1.7935 0.10950  3.6775  0.9494  1.1665  2.9020 #> [2,] 0.197550  4.7305  7.1695  4.0020 0.22545  7.6990  2.3585  2.8580  5.9575 #>      91-94-1 92-87-5 95-80-7 95-95-4 #> [1,] 0.12925 0.76965  2.7530   4.841 #> [2,] 0.27775 1.54650  4.4495  10.270 #>"},{"path":"https://github.com/NIEHS/GeoTox/reference/get_fixed_css.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Fixed C_ss Data — get_fixed_css","title":"Get Fixed C_ss Data — get_fixed_css","text":"Get C_ss values use sensitivity_analysis compute_sensitivity.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/get_fixed_css.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Fixed C_ss Data — get_fixed_css","text":"","code":"get_fixed_css(simulated_css, age, obesity, C_ss)"},{"path":"https://github.com/NIEHS/GeoTox/reference/get_fixed_css.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Fixed C_ss Data — get_fixed_css","text":"simulated_css list pre-generated C_ss data, details see: vignette(\"package_data\", package = \"GeoTox\"). age list atomic vectors containing ages. obesity list atomic vectors containing obesity status. C_ss list matrices containing C_ss values.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/get_fixed_css.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Fixed C_ss Data — get_fixed_css","text":"list matrices atomic vectors containing C_ss values.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/get_fixed_css.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Fixed C_ss Data — get_fixed_css","text":"","code":"# Define inputs age <- list(c(25, 35, 55),             c(15, 60)) obesity <- list(c(\"Obese\", \"Normal\", \"Obese\"),                 c(\"Normal\", \"Normal\")) C_ss <- sample_Css(simulated_css = geo_tox_data$simulated_css,                    age = age,                    obesity = obesity)  # Get fixed C_ss data get_fixed_css(simulated_css = geo_tox_data$simulated_css,               age = age,               obesity = obesity,               C_ss = C_ss) #> $age #> $age[[1]] #>      100-02-7 101-14-4 101-77-9 119-90-4 120-80-9 123-31-9 133-06-2 51-28-5 #> [1,]  0.97155  0.22695   1.3000   7.0115   1.4020  0.29070   2.1865  115.20 #> [2,]  1.19200  0.26170   1.6020   7.3330   1.9675  0.37445   2.7410  134.05 #> [3,]  1.57650  0.32895   2.0525   9.0755   2.7680  0.53645   3.8135  158.40 #>      510-15-6 53-96-3 56-38-2 60-11-7 63-25-2 72-43-5 84-74-2 87-86-5 88-06-2 #> [1,]  0.12195  2.9560  4.1375  2.2505 0.13680  4.6045  1.2480  1.6330  3.7475 #> [2,]  0.14295  3.5485  5.2695  2.7000 0.18190  5.9545  1.6265  2.2385  4.5155 #> [3,]  0.19755  4.7305  7.1695  4.0020 0.22545  7.6990  2.3585  2.8580  5.9575 #>      91-94-1 92-87-5 95-80-7 95-95-4 #> [1,] 0.16620  0.9798  3.4250  6.8665 #> [2,] 0.21995  1.2320  3.7445  8.4465 #> [3,] 0.27775  1.5465  4.4495 10.2700 #>  #> $age[[2]] #>      100-02-7 101-14-4 101-77-9 119-90-4 120-80-9 123-31-9 133-06-2 51-28-5 #> [1,]   0.7077  0.15945  0.99965   5.2580   1.1285  0.21640   1.6310  94.345 #> [2,]   1.5765  0.32895  2.05250   9.0755   2.7680  0.53645   3.8135 158.400 #>      510-15-6 53-96-3 56-38-2 60-11-7 63-25-2 72-43-5 84-74-2 87-86-5 88-06-2 #> [1,] 0.092665  2.1605  3.4310  1.7935 0.10950  3.6775  0.9494  1.1665  2.9020 #> [2,] 0.197550  4.7305  7.1695  4.0020 0.22545  7.6990  2.3585  2.8580  5.9575 #>      91-94-1 92-87-5 95-80-7 95-95-4 #> [1,] 0.12925 0.76965  2.7530   4.841 #> [2,] 0.27775 1.54650  4.4495  10.270 #>  #>  #> $params #> $params[[1]] #>      100-02-7 101-14-4 101-77-9 119-90-4 120-80-9 123-31-9 133-06-2 51-28-5 #> [1,]   0.8238  0.06124   0.7793    6.609    1.010   0.3979    1.444   356.9 #> [2,]   1.1260  0.95920   2.3660    7.605    5.117   1.8530    3.150   178.1 #> [3,]   1.8370  0.10470   0.8396   10.430    2.435   0.1510    1.795  1399.0 #>      510-15-6 53-96-3 56-38-2 60-11-7 63-25-2 72-43-5 84-74-2 87-86-5 88-06-2 #> [1,]  0.11000   1.165   1.431  0.7901  0.5539   5.357  1.1010  0.4393  1.4390 #> [2,]  0.09643   2.633  31.360  1.4420  0.2334   6.828  0.4868  1.3520  0.8864 #> [3,]  0.42460  19.880   6.326  1.0920  0.0756   9.009  0.5308  1.3640  5.2510 #>      91-94-1 92-87-5 95-80-7 95-95-4 #> [1,]  0.2404  0.5090   2.229   2.146 #> [2,]  0.1858  2.8220   3.052   3.751 #> [3,]  0.2685  0.6775   2.209   7.199 #>  #> $params[[2]] #>      100-02-7 101-14-4 101-77-9 119-90-4 120-80-9 123-31-9 133-06-2 51-28-5 #> [1,]   1.0500   0.1408   0.6762    5.061   0.8233  0.15170    1.422  1173.0 #> [2,]   0.1945   0.1785   1.1770    9.531   0.8725  0.09678    2.590   111.7 #>      510-15-6 53-96-3 56-38-2 60-11-7 63-25-2 72-43-5 84-74-2 87-86-5 88-06-2 #> [1,]   0.1233   1.951   3.254   1.948 0.09279  13.480  0.7282   1.446   1.763 #> [2,]   0.3452   1.946   2.976   1.568 0.04178   3.347  1.4100   1.130   4.769 #>      91-94-1 92-87-5 95-80-7 95-95-4 #> [1,]  0.8614  3.5780   3.430   2.032 #> [2,]  0.1345  0.6172   4.645   7.406 #>  #>  #> $obesity #> $obesity[[1]] #>      100-02-7 101-14-4 101-77-9 119-90-4 120-80-9 123-31-9 133-06-2 51-28-5 #> [1,]   1.2430  0.28505    1.684    7.569   2.0180  0.40890   2.8845  132.45 #> [2,]   0.7438  0.16940    1.066    5.776   1.2325  0.23815   1.8485  102.65 #> [3,]   1.2430  0.28505    1.684    7.569   2.0180  0.40890   2.8845  132.45 #>      510-15-6 53-96-3 56-38-2 60-11-7 63-25-2 72-43-5 84-74-2 87-86-5 88-06-2 #> [1,] 0.152300  3.7560   5.587  3.0365  0.1912  6.3135   1.745   2.216  5.0340 #> [2,] 0.094245  2.2785   3.183  1.7825  0.1137  3.7345   1.027   1.345  2.9985 #> [3,] 0.152300  3.7560   5.587  3.0365  0.1912  6.3135   1.745   2.216  5.0340 #>      91-94-1 92-87-5 95-80-7 95-95-4 #> [1,] 0.22455 1.29000  3.8955   8.603 #> [2,] 0.13370 0.82155  2.9980   5.597 #> [3,] 0.22455 1.29000  3.8955   8.603 #>  #> $obesity[[2]] #>      100-02-7 101-14-4 101-77-9 119-90-4 120-80-9 123-31-9 133-06-2 51-28-5 #> [1,]   0.7438   0.1694    1.066    5.776   1.2325  0.23815   1.8485  102.65 #> [2,]   0.7438   0.1694    1.066    5.776   1.2325  0.23815   1.8485  102.65 #>      510-15-6 53-96-3 56-38-2 60-11-7 63-25-2 72-43-5 84-74-2 87-86-5 88-06-2 #> [1,] 0.094245  2.2785   3.183  1.7825  0.1137  3.7345   1.027   1.345  2.9985 #> [2,] 0.094245  2.2785   3.183  1.7825  0.1137  3.7345   1.027   1.345  2.9985 #>      91-94-1 92-87-5 95-80-7 95-95-4 #> [1,]  0.1337 0.82155   2.998   5.597 #> [2,]  0.1337 0.82155   2.998   5.597 #>  #>  #> $other #> $other[[1]] #> [1] 2.802 2.802 2.802 #>  #> $other[[2]] #> [1] 1.663 1.663 #>  #>"},{"path":"https://github.com/NIEHS/GeoTox/reference/get_fixed_obesity.html","id":null,"dir":"Reference","previous_headings":"","what":"Get C_ss Data for Fixed Obesity Status — get_fixed_obesity","title":"Get C_ss Data for Fixed Obesity Status — get_fixed_obesity","text":"Get C_ss Data Fixed Obesity Status","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/get_fixed_obesity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get C_ss Data for Fixed Obesity Status — get_fixed_obesity","text":"","code":"get_fixed_obesity(simulated_css, obesity)"},{"path":"https://github.com/NIEHS/GeoTox/reference/get_fixed_obesity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get C_ss Data for Fixed Obesity Status — get_fixed_obesity","text":"simulated_css list pre-generated C_ss data, details see: vignette(\"package_data\", package = \"GeoTox\"). obesity list atomic vectors containing obesity status.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/get_fixed_obesity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get C_ss Data for Fixed Obesity Status — get_fixed_obesity","text":"list matrices containing median C_ss values.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/get_fixed_obesity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get C_ss Data for Fixed Obesity Status — get_fixed_obesity","text":"","code":"get_fixed_obesity(simulated_css = geo_tox_data$simulated_css,                   obesity = list(c(\"Obese\", \"Normal\", \"Obese\"),                                  c(\"Normal\", \"Normal\"))) #> [[1]] #>      100-02-7 101-14-4 101-77-9 119-90-4 120-80-9 123-31-9 133-06-2 51-28-5 #> [1,]   1.2430  0.28505    1.684    7.569   2.0180  0.40890   2.8845  132.45 #> [2,]   0.7438  0.16940    1.066    5.776   1.2325  0.23815   1.8485  102.65 #> [3,]   1.2430  0.28505    1.684    7.569   2.0180  0.40890   2.8845  132.45 #>      510-15-6 53-96-3 56-38-2 60-11-7 63-25-2 72-43-5 84-74-2 87-86-5 88-06-2 #> [1,] 0.152300  3.7560   5.587  3.0365  0.1912  6.3135   1.745   2.216  5.0340 #> [2,] 0.094245  2.2785   3.183  1.7825  0.1137  3.7345   1.027   1.345  2.9985 #> [3,] 0.152300  3.7560   5.587  3.0365  0.1912  6.3135   1.745   2.216  5.0340 #>      91-94-1 92-87-5 95-80-7 95-95-4 #> [1,] 0.22455 1.29000  3.8955   8.603 #> [2,] 0.13370 0.82155  2.9980   5.597 #> [3,] 0.22455 1.29000  3.8955   8.603 #>  #> [[2]] #>      100-02-7 101-14-4 101-77-9 119-90-4 120-80-9 123-31-9 133-06-2 51-28-5 #> [1,]   0.7438   0.1694    1.066    5.776   1.2325  0.23815   1.8485  102.65 #> [2,]   0.7438   0.1694    1.066    5.776   1.2325  0.23815   1.8485  102.65 #>      510-15-6 53-96-3 56-38-2 60-11-7 63-25-2 72-43-5 84-74-2 87-86-5 88-06-2 #> [1,] 0.094245  2.2785   3.183  1.7825  0.1137  3.7345   1.027   1.345  2.9985 #> [2,] 0.094245  2.2785   3.183  1.7825  0.1137  3.7345   1.027   1.345  2.9985 #>      91-94-1 92-87-5 95-80-7 95-95-4 #> [1,]  0.1337 0.82155   2.998   5.597 #> [2,]  0.1337 0.82155   2.998   5.597 #>"},{"path":"https://github.com/NIEHS/GeoTox/reference/get_fixed_other.html","id":null,"dir":"Reference","previous_headings":"","what":"Get median C_ss Values — get_fixed_other","title":"Get median C_ss Values — get_fixed_other","text":"Get median C_ss Values","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/get_fixed_other.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get median C_ss Values — get_fixed_other","text":"","code":"get_fixed_other(C_ss)"},{"path":"https://github.com/NIEHS/GeoTox/reference/get_fixed_other.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get median C_ss Values — get_fixed_other","text":"C_ss list matrices containing C_ss data","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/get_fixed_other.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get median C_ss Values — get_fixed_other","text":"list atomic vectors containing median C_ss values.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/get_fixed_other.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get median C_ss Values — get_fixed_other","text":"","code":"# Generate input C_ss data age <- list(c(25, 35, 55),             c(15, 60)) obesity <- list(c(\"Obese\", \"Normal\", \"Obese\"),                 c(\"Normal\", \"Normal\")) C_ss <- sample_Css(simulated_css = geo_tox_data$simulated_css,                    age = age,                    obesity = obesity)  # Get median C_ss values get_fixed_other(C_ss) #> [[1]] #> [1] 1.927 1.927 1.927 #>  #> [[2]] #> [1] 1.451 1.451 #>"},{"path":"https://github.com/NIEHS/GeoTox/reference/get_fixed_params.html","id":null,"dir":"Reference","previous_headings":"","what":"Get C_ss Data for Fixed C_ss Generation Parameters — get_fixed_params","title":"Get C_ss Data for Fixed C_ss Generation Parameters — get_fixed_params","text":"Get C_ss Data Fixed C_ss Generation Parameters","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/get_fixed_params.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get C_ss Data for Fixed C_ss Generation Parameters — get_fixed_params","text":"","code":"get_fixed_params(simulated_css, age)"},{"path":"https://github.com/NIEHS/GeoTox/reference/get_fixed_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get C_ss Data for Fixed C_ss Generation Parameters — get_fixed_params","text":"simulated_css list pre-generated C_ss data, details see: vignette(\"package_data\", package = \"GeoTox\"). age list atomic vectors containing ages.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/get_fixed_params.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get C_ss Data for Fixed C_ss Generation Parameters — get_fixed_params","text":"list matrices containing C_ss values.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/get_fixed_params.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get C_ss Data for Fixed C_ss Generation Parameters — get_fixed_params","text":"","code":"get_fixed_params(simulated_css = geo_tox_data$simulated_css,                  age = list(c(25, 35, 55), c(15, 60))) #> [[1]] #>      100-02-7 101-14-4 101-77-9 119-90-4 120-80-9 123-31-9 133-06-2 51-28-5 #> [1,]   3.7470   0.1963    1.919    5.179    2.561   0.1202    1.114   34.14 #> [2,]   1.0040   0.1739    1.783   18.780    1.026   0.3502    4.669  143.40 #> [3,]   0.2282   0.9145    6.259    3.574    2.860   0.1428    2.775   53.27 #>      510-15-6 53-96-3 56-38-2 60-11-7 63-25-2 72-43-5 84-74-2 87-86-5 88-06-2 #> [1,]  0.06726   3.148   4.864   1.993 0.16910   2.570  0.5825  0.5356  0.5755 #> [2,]  0.19100   2.728   1.291   5.795 0.46430   3.516  0.7203  1.4800  3.9520 #> [3,]  0.69360  10.560   2.018   5.628 0.06376   4.655  1.2680  2.7590  3.8900 #>      91-94-1 92-87-5 95-80-7 95-95-4 #> [1,] 0.16720  0.9514   2.125  20.820 #> [2,] 0.06596  1.1710   3.382  16.010 #> [3,] 0.04506  2.1360   2.854   8.415 #>  #> [[2]] #>      100-02-7 101-14-4 101-77-9 119-90-4 120-80-9 123-31-9 133-06-2 51-28-5 #> [1,]   0.6615   2.2930   0.8829    8.841    1.128   0.1151    1.795   61.54 #> [2,]   1.0930   0.0672   0.8129    4.530    8.510   0.1274    1.422  343.90 #>      510-15-6 53-96-3 56-38-2 60-11-7 63-25-2 72-43-5 84-74-2 87-86-5 88-06-2 #> [1,]  0.09053   5.447   1.999   1.417  0.0834  1.9480   1.650  2.0120  3.1840 #> [2,]  1.18600   1.982   7.304   1.195  1.4980  0.7697   1.351  0.5335  0.5292 #>      91-94-1 92-87-5 95-80-7 95-95-4 #> [1,] 1.49100   6.493   3.029   4.315 #> [2,] 0.06472  15.990   1.448   5.211 #>"},{"path":"https://github.com/NIEHS/GeoTox/reference/hill_conc.html","id":null,"dir":"Reference","previous_headings":"","what":"Hill model concentration — hill_conc","title":"Hill model concentration — hill_conc","text":"Calculate concentration regular space given response value.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/hill_conc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hill model concentration — hill_conc","text":"","code":"hill_conc(resp, max, AC50, n)"},{"path":"https://github.com/NIEHS/GeoTox/reference/hill_conc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Hill model concentration — hill_conc","text":"resp response value max maximal (asymptotic) response AC50 concentration half-maximal response n Hill coefficient (slope)","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/hill_conc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Hill model concentration — hill_conc","text":"concentration regular space","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/hill_conc.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Hill model concentration — hill_conc","text":"regular space version tcpl::tcplHillConc(). concentration computed : $$conc = AC50 * (\\frac{max}{resp} - 1)^{-1 / n}$$","code":""},{"path":[]},{"path":"https://github.com/NIEHS/GeoTox/reference/hill_conc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Hill model concentration — hill_conc","text":"","code":"hill_conc(c(0.2, 0.5, 0.75), 1, 0.01, 1) #> [1] 0.0025 0.0100 0.0300 hill_conc(c(0.2, 0.5, 0.9), 1, c(0.1, 0.01, 0.001), 2) #> [1] 0.050 0.010 0.003"},{"path":"https://github.com/NIEHS/GeoTox/reference/hill_val.html","id":null,"dir":"Reference","previous_headings":"","what":"Hill model response — hill_val","title":"Hill model response — hill_val","text":"Calculate response given concentration regular space.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/hill_val.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hill model response — hill_val","text":"","code":"hill_val(conc, max, AC50, n)"},{"path":"https://github.com/NIEHS/GeoTox/reference/hill_val.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Hill model response — hill_val","text":"conc concentration regular space max maximal (asymptotic) response AC50 concentration half-maximal response n Hill coefficient (slope)","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/hill_val.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Hill model response — hill_val","text":"response value","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/hill_val.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Hill model response — hill_val","text":"regular space version tcpl::tcplHillVal(). Hill model defined : $$resp = \\frac{max}{1 + (\\frac{AC50}{conc})^{n}}$$","code":""},{"path":[]},{"path":"https://github.com/NIEHS/GeoTox/reference/hill_val.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Hill model response — hill_val","text":"","code":"hill_val(c(0.0025, 0.01, 0.03), 1, 0.01, 1) #> [1] 0.20 0.50 0.75 hill_val(c(0.05, 0.01, 0.003), 1, c(0.1, 0.01, 0.001), 2) #> [1] 0.2 0.5 0.9"},{"path":"https://github.com/NIEHS/GeoTox/reference/plot_exposure.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot exposure data. — plot_exposure","title":"Plot exposure data. — plot_exposure","text":"Plot exposure data.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/plot_exposure.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot exposure data. — plot_exposure","text":"","code":"plot_exposure(   exposure,   region_boundary,   group_boundary = NULL,   chem_label = \"chnm\",   ncol = 2 )"},{"path":"https://github.com/NIEHS/GeoTox/reference/plot_exposure.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot exposure data. — plot_exposure","text":"exposure list exposure data named region label. region_boundary \"sf\" data.frame mapping features \"geometry\" column. Used color regions. group_boundary (optional) \"sf\" data.frame containing \"geometry\" column. Used draw outlines. chem_label label facet_wrap. ncol number columns wrap.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/plot_exposure.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot exposure data. — plot_exposure","text":"ggplot2 object.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/plot_exposure.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot exposure data. — plot_exposure","text":"","code":"# Load package data exposure <- split(geo_tox_data$exposure, ~FIPS) region_boundary <- geo_tox_data$boundaries$county group_boundary <- geo_tox_data$boundaries$state  # Plot county exposure data # Use CASN as label to avoid long chemical names plot_exposure(exposure,               region_boundary,               chem_label = \"casn\",               ncol = 5)   # Add state boundaries plot_exposure(exposure,               region_boundary,               group_boundary = group_boundary,               chem_label = \"casn\",               ncol = 5)"},{"path":"https://github.com/NIEHS/GeoTox/reference/plot_hill.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Hill equation fits. — plot_hill","title":"Plot Hill equation fits. — plot_hill","text":"Plot Hill equation fits.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/plot_hill.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Hill equation fits. — plot_hill","text":"","code":"plot_hill(hill_params, xlim = c(-1, 4))"},{"path":"https://github.com/NIEHS/GeoTox/reference/plot_hill.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Hill equation fits. — plot_hill","text":"hill_params output fit_hill. xlim log-10 scaled concentration limits.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/plot_hill.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Hill equation fits. — plot_hill","text":"ggplot2 object.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/plot_hill.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Hill equation fits. — plot_hill","text":"","code":"# Multiple assays, multiple chemicals df <- geo_tox_data$dose_response plot_hill(fit_hill(df, assay = \"endp\", chem = \"casn\"))   # Single assay, multiple chemicals df <- geo_tox_data$dose_response |>   dplyr::filter(endp == \"TOX21_H2AX_HTRF_CHO_Agonist_ratio\") fig <- plot_hill(fit_hill(df, chem = \"casn\")) fig  # Modify plot fig + ggplot2::guides(color = ggplot2::guide_legend(title = \"Chemical\\nCASN\"))   # Single assay, single chemical df <- geo_tox_data$dose_response |>   dplyr::filter(endp == \"TOX21_H2AX_HTRF_CHO_Agonist_ratio\",                 casn == \"510-15-6\") plot_hill(fit_hill(df))  # 3-parameter Hill model plot_hill(fit_hill(df, fixed_slope = FALSE))"},{"path":"https://github.com/NIEHS/GeoTox/reference/plot_resp.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot response data — plot_resp","title":"Plot response data — plot_resp","text":"Plot response data","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/plot_resp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot response data — plot_resp","text":"","code":"plot_resp(   df,   region_boundary,   group_boundary = NULL,   assay_quantiles = c(Median = 0.5),   summary_quantiles = c(`10th percentile` = 0.1) )"},{"path":"https://github.com/NIEHS/GeoTox/reference/plot_resp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot response data — plot_resp","text":"df output resp_quantiles. region_boundary \"sf\" data.frame mapping features \"geometry\" column. Used color map regions. group_boundary \"sf\" data.frame containing \"geometry\" column. Used draw outlines around groups regions. assay_quantiles named numeric vector assay quantile labels. summary_quantiles named numeric vector summary quantile labels.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/plot_resp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot response data — plot_resp","text":"ggplot2 object.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/plot_resp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot response data — plot_resp","text":"","code":"# Use example boundary data from package region_boundary <- geo_tox_data$boundaries$county group_boundary <- geo_tox_data$boundaries$state n <- nrow(region_boundary)  # Single assay quantile df <- data.frame(id = region_boundary$FIPS,                  metric = \"GCA.Eff\",                  assay_quantile = 0.5,                  value = runif(n)^3) # Default plot plot_resp(df, region_boundary)  # Add group boundary, a state border in this case plot_resp(df, region_boundary, group_boundary)  # Change quantile label plot_resp(df, region_boundary, group_boundary,           assay_quantiles = c(\"Q50\" = 0.5))   # Multiple assay quantiles df <- data.frame(id = rep(region_boundary$FIPS, 2),                  metric = \"GCA.Eff\",                  assay_quantile = rep(c(0.25, 0.75), each = n),                  value = c(runif(n)^3, runif(n)^3 + 0.15)) plot_resp(df, region_boundary, group_boundary,           assay_quantiles = c(\"Q25\" = 0.25, \"Q75\" = 0.75))   # Summary quantiles df <- data.frame(id = rep(region_boundary$FIPS, 4),                  assay_quantile = rep(rep(c(0.25, 0.75), each = n), 2),                  summary_quantile = rep(c(0.05, 0.95), each = n * 2),                  metric = \"GCA.Eff\",                  value = c(runif(n)^3, runif(n)^3 + 0.15,                            runif(n)^3 + 0.7, runif(n)^3 + 0.85)) plot_resp(df, region_boundary, group_boundary,           assay_quantiles = c(\"A_Q25\" = 0.25, \"A_Q75\" = 0.75),           summary_quantiles = c(\"S_Q05\" = 0.05, \"S_Q95\" = 0.95))"},{"path":"https://github.com/NIEHS/GeoTox/reference/plot_sensitivity.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot results of sensitivity analysis. — plot_sensitivity","title":"Plot results of sensitivity analysis. — plot_sensitivity","text":"Plot results sensitivity analysis.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/plot_sensitivity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot results of sensitivity analysis. — plot_sensitivity","text":"","code":"plot_sensitivity(   x,   metric = \"GCA.Eff\",   assay = NULL,   y = \"\",   xlab = metric,   ylab = \"\" )"},{"path":"https://github.com/NIEHS/GeoTox/reference/plot_sensitivity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot results of sensitivity analysis. — plot_sensitivity","text":"x GeoTox object. metric metric plot. Valid choices \"GCA.Eff\", \"IA.Eff\", \"GCA.HQ.10\", \"IA.HQ.10\". assay assay plot, multiple exist. y y value text bottom ridge plot. xlab x-axis label. ylab y-axis label.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/plot_sensitivity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot results of sensitivity analysis. — plot_sensitivity","text":"ggplot2 object.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/plot_sensitivity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot results of sensitivity analysis. — plot_sensitivity","text":"","code":"# Required GeoTox fields are generated by first running [calculate_response] # and [sensitivity_analysis] on a GeoTox object. This will create the fields # `resp` and `sensitivity`. For this example, dummy data will be used. make_data <- function(n = 5, metric = \"GCA.Eff\") {   list(stats::setNames(data.frame(1:n, runif(n)),                        c(\"sample\", metric))) }  geoTox <- GeoTox() geoTox$resp <- make_data() geoTox$sensitivity <- list(age = make_data(),                            obesity = make_data(),                            css_params = make_data(),                            fit_params = make_data(),                            C_ext = make_data())  plot_sensitivity(geoTox) #> Picking joint bandwidth of 0.188"},{"path":"https://github.com/NIEHS/GeoTox/reference/resp_quantiles.html","id":null,"dir":"Reference","previous_headings":"","what":"Get response quantiles — resp_quantiles","title":"Get response quantiles — resp_quantiles","text":"Get response quantiles","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/resp_quantiles.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get response quantiles — resp_quantiles","text":"","code":"resp_quantiles(   resp,   metric = c(\"GCA.Eff\", \"IA.Eff\", \"GCA.HQ.10\", \"IA.HQ.10\"),   assays = NULL,   assay_summary = FALSE,   assay_quantiles = c(Median = 0.5),   summary_quantiles = c(`10th percentile` = 0.1) )"},{"path":"https://github.com/NIEHS/GeoTox/reference/resp_quantiles.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get response quantiles — resp_quantiles","text":"resp calculated mixture response output calc_concentration_response. metric response metric, one \"GCA.Eff\", \"IA.Eff\", \"GCA.HQ.10\" \"IA.HQ.10\". assays assays summarize. NULL multiple assays exist, first assay used. assay_summary boolean indicating whether summarize across assays. assay_quantiles numeric vector assay quantiles. summary_quantiles numeric vector quantiles compute across assay quantiles.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/resp_quantiles.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get response quantiles — resp_quantiles","text":"data frame computed response quantiles.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/resp_quantiles.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get response quantiles — resp_quantiles","text":"columns returned data frame vary based inputs. assays specified assay_summary FALSE, resulting data frame assay column. assay_summary TRUE, data frame summary_quantile column.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/resp_quantiles.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get response quantiles — resp_quantiles","text":"","code":"# Dummy response data resp <- list(   \"r1\" = data.frame(assay = c(\"a1\", \"a1\", \"a2\", \"a2\"),                     sample = c(1, 2, 1, 2),                     GCA.Eff = c(1, 2, 3, 4),                     IA.Eff = c(5, 6, 7, 8),                     \"GCA.HQ.10\" = c(9, 10, 11, 12),                     \"IA.HQ.10\" = c(13, 14, 15, 16)))  # Summarize single assay resp_quantiles(resp) #> Warning: Multiple assays found, using first assay 'a1' #> # A tibble: 1 × 5 #>   id    assay metric  assay_quantile value #>   <chr> <chr> <chr>            <dbl> <dbl> #> 1 r1    a1    GCA.Eff            0.5   1.5 # Specify assay resp_quantiles(resp, assays = \"a1\") #> # A tibble: 1 × 5 #>   id    assay metric  assay_quantile value #>   <chr> <chr> <chr>            <dbl> <dbl> #> 1 r1    a1    GCA.Eff            0.5   1.5 # Specify quantiles resp_quantiles(resp, assays = \"a1\", assay_quantiles = c(0.25, 0.75)) #> # A tibble: 2 × 5 #>   id    assay metric  assay_quantile value #>   <chr> <chr> <chr>            <dbl> <dbl> #> 1 r1    a1    GCA.Eff           0.25  1.25 #> 2 r1    a1    GCA.Eff           0.75  1.75 # Specify metric resp_quantiles(resp, assays = \"a1\", metric = \"IA.HQ.10\") #> # A tibble: 1 × 5 #>   id    assay metric   assay_quantile value #>   <chr> <chr> <chr>             <dbl> <dbl> #> 1 r1    a1    IA.HQ.10            0.5  13.5  # Summarize across assays resp_quantiles(resp, assay_summary = TRUE) #> Warning: There are only 2 assays. #> Consider using a larger number of assays for a more robust analysis. #> # A tibble: 1 × 5 #>   id    assay_quantile metric  summary_quantile value #>   <chr>          <dbl> <chr>              <dbl> <dbl> #> 1 r1               0.5 GCA.Eff              0.1   1.7 # Specify quantiles suppressWarnings(   resp_quantiles(resp,                  assay_summary = TRUE,                  assay_quantiles = c(0.25, 0.75),                  summary_quantiles = c(0.1, 0.9)) ) #> # A tibble: 4 × 5 #>   id    assay_quantile metric  summary_quantile value #>   <chr>          <dbl> <chr>              <dbl> <dbl> #> 1 r1              0.25 GCA.Eff              0.1  1.45 #> 2 r1              0.25 GCA.Eff              0.9  3.05 #> 3 r1              0.75 GCA.Eff              0.1  1.95 #> 4 r1              0.75 GCA.Eff              0.9  3.55"},{"path":"https://github.com/NIEHS/GeoTox/reference/sample_Css.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample from pre-generated C_ss data — sample_Css","title":"Sample from pre-generated C_ss data — sample_Css","text":"Sample pre-generated C_ss data","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/sample_Css.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample from pre-generated C_ss data — sample_Css","text":"","code":"sample_Css(simulated_css, age, obesity)"},{"path":"https://github.com/NIEHS/GeoTox/reference/sample_Css.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample from pre-generated C_ss data — sample_Css","text":"simulated_css list pre-generated C_ss data, details see: vignette(\"package_data\", package = \"GeoTox\"). age list atomic vector ages. obesity list atomic vector obesity status.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/sample_Css.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample from pre-generated C_ss data — sample_Css","text":"list matrices containing C_ss values. Columns sorted consistent order across functions.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/sample_Css.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample from pre-generated C_ss data — sample_Css","text":"","code":"# Vector inputs sample_Css(geo_tox_data$simulated_css,            c(15, 25, 35),            c(\"Normal\", \"Obese\", \"Normal\")) #> [[1]] #>      100-02-7 101-14-4 101-77-9 119-90-4 120-80-9 123-31-9 133-06-2 51-28-5 #> [1,]    4.920   0.1287   0.4676    8.464    9.558   0.2806    2.034   73.85 #> [2,]    3.604   0.1479   1.4440   39.100    8.855   0.5412    3.113  663.80 #> [3,]    1.082   0.1107   1.0080    4.670    1.493   0.1780    3.196  263.60 #>      510-15-6 53-96-3 56-38-2 60-11-7 63-25-2 72-43-5 84-74-2 87-86-5 88-06-2 #> [1,]   0.1728   2.383  4.2530  0.6562  0.2141   1.665   1.335  0.5696  0.6158 #> [2,]   0.7114   7.037  3.5020  2.5960  0.8362   1.925   0.481 10.3800  2.4630 #> [3,]   0.1429   8.898  0.4794  4.7950  0.2954   9.999   1.684  0.9618  3.7950 #>      91-94-1 92-87-5 95-80-7 95-95-4 #> [1,]  0.3250  0.4477  17.190   2.716 #> [2,]  1.2530  0.7560   8.034   4.559 #> [3,]  0.3969  0.7545   3.405   3.787 #>   # List inputs sample_Css(geo_tox_data$simulated_css,            list(c(34, 29), 55),            list(c(\"Obese\", \"Normal\"), \"Normal\")) #> [[1]] #>      100-02-7 101-14-4 101-77-9 119-90-4 120-80-9 123-31-9 133-06-2 51-28-5 #> [1,]    1.546   1.2190   11.150   17.280    3.063  1.39100   2.3160   37.32 #> [2,]    1.212   0.1619    3.141    6.148    1.150  0.06613   0.3514  130.10 #>      510-15-6 53-96-3 56-38-2 60-11-7 63-25-2 72-43-5 84-74-2 87-86-5 88-06-2 #> [1,]   0.3278   5.419   8.366  16.970  0.7243   7.445   1.058 97.3200   4.430 #> [2,]   0.7411   1.316   6.167   4.806  0.1581   5.345   1.041  0.1131   1.996 #>      91-94-1 92-87-5 95-80-7 95-95-4 #> [1,] 0.09992  0.8279   3.535   2.856 #> [2,] 0.25190  1.4160   1.684  50.310 #>  #> [[2]] #>      100-02-7 101-14-4 101-77-9 119-90-4 120-80-9 123-31-9 133-06-2 51-28-5 #> [1,]    1.468   0.1368    1.128    10.93    1.501   0.1941    2.172   622.5 #>      510-15-6 53-96-3 56-38-2 60-11-7 63-25-2 72-43-5 84-74-2 87-86-5 88-06-2 #> [1,]  0.08399   2.352   3.519   1.601  0.2759   8.679   1.494   4.843    4.24 #>      91-94-1 92-87-5 95-80-7 95-95-4 #> [1,]  0.1174   1.366   3.404   2.522 #>"},{"path":"https://github.com/NIEHS/GeoTox/reference/sensitivity_analysis.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform sensitivity analysis — sensitivity_analysis","title":"Perform sensitivity analysis — sensitivity_analysis","text":"Perform sensitivity analysis","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/sensitivity_analysis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform sensitivity analysis — sensitivity_analysis","text":"","code":"sensitivity_analysis(x, max_mult = list(NULL, NULL, NULL, 1.2, NULL))"},{"path":"https://github.com/NIEHS/GeoTox/reference/sensitivity_analysis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform sensitivity analysis — sensitivity_analysis","text":"x GeoTox object. max_mult numeric list length 5 step sensitivity analysis.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/sensitivity_analysis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform sensitivity analysis — sensitivity_analysis","text":"GeoTox object added sensitivity field.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/sensitivity_analysis.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Perform sensitivity analysis — sensitivity_analysis","text":"wrapper function sequentially call compute_sensitivity function inputs age, obesity, css_params, fit_params, C_ext. results returned named list stored sensitivity field input GeoTox object. Values NULL max_mult input use default value stored GeoTox object (x$par$resp$max_mult). GeoTox object created initialized 1.5, can changed via calculate_response function directly object.","code":""},{"path":[]},{"path":"https://github.com/NIEHS/GeoTox/reference/sensitivity_analysis.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Perform sensitivity analysis — sensitivity_analysis","text":"","code":"# Use a subset of the package data for demonstration purposes set.seed(2357) n <- 10 # Population size m <- 5 # Number of regions idx <- if (m < 100) sample(1:100, m) else 1:100  # Create GeoTox object and populate required fields geoTox <- GeoTox() |>   # Simulate populations for each region   simulate_population(age = split(geo_tox_data$age, ~FIPS)[idx],                       obesity = geo_tox_data$obesity[idx, ],                       exposure = split(geo_tox_data$exposure, ~FIPS)[idx],                       simulated_css = geo_tox_data$simulated_css,                       n = n) |>   # Estimated Hill parameters   set_hill_params(geo_tox_data$dose_response |>                     fit_hill(assay = \"endp\", chem = \"casn\") |>                     dplyr::filter(!tp.sd.imputed, !logAC50.sd.imputed))  # Sensitivity analysis can now be done geoTox <- geoTox |> sensitivity_analysis()"},{"path":"https://github.com/NIEHS/GeoTox/reference/set_boundaries.html","id":null,"dir":"Reference","previous_headings":"","what":"Set GeoTox boundaries — set_boundaries","title":"Set GeoTox boundaries — set_boundaries","text":"Set GeoTox boundaries","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/set_boundaries.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set GeoTox boundaries — set_boundaries","text":"","code":"set_boundaries(x, region = NULL, group = NULL)"},{"path":"https://github.com/NIEHS/GeoTox/reference/set_boundaries.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set GeoTox boundaries — set_boundaries","text":"x GeoTox object. region \"sf\" data.frame mapping features \"geometry\" column. Used coloring map regions. group \"sf\" data.frame containing \"geometry\" column. Used draw outlines around groups regions.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/set_boundaries.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set GeoTox boundaries — set_boundaries","text":"GeoTox object boundaries set.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/set_boundaries.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set GeoTox boundaries — set_boundaries","text":"","code":"geoTox <- GeoTox() |>    set_boundaries(region = geo_tox_data$boundaries$county,                  group  = geo_tox_data$boundaries$state)"},{"path":"https://github.com/NIEHS/GeoTox/reference/set_hill_params.html","id":null,"dir":"Reference","previous_headings":"","what":"Set Hill parameters for a GeoTox object. — set_hill_params","title":"Set Hill parameters for a GeoTox object. — set_hill_params","text":"Set Hill parameters GeoTox object.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/set_hill_params.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set Hill parameters for a GeoTox object. — set_hill_params","text":"","code":"set_hill_params(x, hill_params)"},{"path":"https://github.com/NIEHS/GeoTox/reference/set_hill_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set Hill parameters for a GeoTox object. — set_hill_params","text":"x GeoTox object. hill_params output fit_hill.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/set_hill_params.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set Hill parameters for a GeoTox object. — set_hill_params","text":"GeoTox object Hill parameters set.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/set_hill_params.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set Hill parameters for a GeoTox object. — set_hill_params","text":"","code":"hill_params <- geo_tox_data$dose_response |>   fit_hill(chem = \"casn\", assay = \"endp\") |>   dplyr::filter(!tp.sd.imputed, !logAC50.sd.imputed)  geoTox <- GeoTox() |>    set_hill_params(hill_params)"},{"path":"https://github.com/NIEHS/GeoTox/reference/set_population.html","id":null,"dir":"Reference","previous_headings":"","what":"Set population data — set_population","title":"Set population data — set_population","text":"Set population data","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/set_population.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set population data — set_population","text":"","code":"set_population(x, age = NULL, obesity = NULL)"},{"path":"https://github.com/NIEHS/GeoTox/reference/set_population.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set population data — set_population","text":"x GeoTox object. age numeric vector list numeric vectors age values. obesity character vector list character vectors obesity status.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/set_population.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set population data — set_population","text":"object simulated fields added.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/set_population.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set population data — set_population","text":"","code":"# Single region age <- round(runif(10, 1, 100)) obesity <- sample(c(\"Normal\", \"Obese\"), 10, replace = TRUE) geoTox <- set_population(GeoTox(), age = age, obesity = obesity)  # Multiple regions age <- list(\"37001\" = round(runif(10, 1, 100)),             \"37007\" = round(runif(8, 1, 100))) obesity <- list(\"37001\" = sample(c(\"Normal\", \"Obese\"), 10, replace = TRUE),                 \"37007\" = sample(c(\"Normal\", \"Obese\"), 8, replace = TRUE)) geoTox <- set_population(GeoTox(), age = age, obesity = obesity)"},{"path":"https://github.com/NIEHS/GeoTox/reference/simulate_age.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate ages — simulate_age","title":"Simulate ages — simulate_age","text":"Simulate ages","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/simulate_age.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate ages — simulate_age","text":"","code":"simulate_age(x, n = 1000)"},{"path":"https://github.com/NIEHS/GeoTox/reference/simulate_age.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate ages — simulate_age","text":"x data frame list data frames containing population data age groups. data frame must contain columns \"AGEGRP\" \"TOT_POP\". n simulated sample size(s).","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/simulate_age.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate ages — simulate_age","text":"List arrays containing simulated ages.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/simulate_age.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simulate ages — simulate_age","text":"data frame must contain 19 rows. first row represents total population age groups next 18 rows represent age groups 0 89 increments 5 years. sample size can either single value vector length number data frames x. single value provided, sample size used data frames. vector provided, element corresponds sample size data frame x.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/simulate_age.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate ages — simulate_age","text":"","code":"# Single data frame x <- data.frame(AGEGRP = 0:18, TOT_POP = 0) # populate only age range 40-44, set population total of all ages x$TOT_POP[c(1, 10)] <- 100 simulate_age(x, 5) #> [[1]] #> [1] 43 40 40 42 40 #>   # List of 2 data frames y <- data.frame(AGEGRP = 0:18, TOT_POP = 0) # populate age ranges 5-9 and 50-54 y$TOT_POP[c(3, 12)] <- 10 # set population total for all age groups y$TOT_POP[1] <- sum(y$TOT_POP) simulate_age(list(x = x, y = y), 15) #> $x #>  [1] 44 40 44 40 41 41 42 41 43 40 42 41 42 41 44 #>  #> $y #>  [1] 54  5 51  5  6 53 54  9 53  6  8 52  7 52  7 #>  # different sample sizes simulate_age(list(x = x, y = y), c(15, 10)) #> $x #>  [1] 42 43 41 40 41 44 42 40 43 42 44 43 42 40 44 #>  #> $y #>  [1] 51  9  9 50  7 54 53  8 54  5 #>"},{"path":"https://github.com/NIEHS/GeoTox/reference/simulate_exposure.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate external exposure — simulate_exposure","title":"Simulate external exposure — simulate_exposure","text":"Simulate external exposure","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/simulate_exposure.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate external exposure — simulate_exposure","text":"","code":"simulate_exposure(   x,   expos_mean = \"mean\",   expos_sd = \"sd\",   expos_label = \"casn\",   n = 1000 )"},{"path":"https://github.com/NIEHS/GeoTox/reference/simulate_exposure.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate external exposure — simulate_exposure","text":"x data frame list data frames containing exposure data. expos_mean column name mean values. expos_sd column name standard deviations. expos_label column name labeling term, required x one row. n simulated sample size(s).","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/simulate_exposure.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate external exposure — simulate_exposure","text":"list matrices containing inhalation rates. Matrix columns named using values expos_label column one data frame row. Columns sorted consistent order across functions.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/simulate_exposure.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simulate external exposure — simulate_exposure","text":"sample size can either single value vector length number data frames x. single value provided, sample size used data frames. vector provided, element corresponds sample size data frame x.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/simulate_exposure.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate external exposure — simulate_exposure","text":"","code":"# Single data frame x <- data.frame(mean = 1:3, sd = (1:3) / 10, casn = letters[1:3]) simulate_exposure(x, n = 5) #> [[1]] #>              a        b        c #> [1,] 1.0118749 1.825807 3.069007 #> [2,] 0.9985051 1.800722 3.020591 #> [3,] 1.1501370 2.236371 3.359616 #> [4,] 0.9950735 2.208834 3.005477 #> [5,] 0.9447041 2.026918 2.883992 #>   # List of 2 data frames y <- data.frame(mean = 4:6, sd = 0.1, casn = letters[1:3]) simulate_exposure(list(loc1 = x, loc2 = y), n = 5) #> $loc1 #>              a        b        c #> [1,] 0.9709773 2.107346 2.991774 #> [2,] 0.9372580 2.056798 2.795501 #> [3,] 0.9196467 2.255035 2.817007 #> [4,] 1.0967971 1.869585 3.241197 #> [5,] 1.0738694 1.703378 2.878440 #>  #> $loc2 #>             a        b        c #> [1,] 3.917817 4.997201 6.145849 #> [2,] 4.088133 4.923779 6.046758 #> [3,] 3.989283 5.007522 5.985234 #> [4,] 3.925764 5.151380 5.927939 #> [5,] 3.885855 5.076009 6.215276 #>  # different sample sizes simulate_exposure(list(loc1 = x, loc2 = y), n = c(5, 3)) #> $loc1 #>              a        b        c #> [1,] 0.9491920 1.869084 2.921560 #> [2,] 1.0438846 2.086854 2.961969 #> [3,] 1.0773879 2.065955 3.068951 #> [4,] 0.9048719 1.739879 3.014626 #> [5,] 1.0861998 2.375972 3.332553 #>  #> $loc2 #>             a        b        c #> [1,] 4.036732 5.013597 5.904727 #> [2,] 3.901093 4.939445 5.916056 #> [3,] 4.282058 4.964946 5.932905 #>   # Input has custom column names z <- data.frame(ave = 1:3, stdev = (1:3) / 10, chnm = letters[1:3]) simulate_exposure(z,                   expos_mean = \"ave\",                   expos_sd = \"stdev\",                   expos_label = \"chnm\",                   n = 5) #> [[1]] #>              a        b        c #> [1,] 1.0583063 1.780812 3.249216 #> [2,] 0.8311137 2.316820 2.961909 #> [3,] 1.1070061 2.047741 2.777624 #> [4,] 1.2227959 2.081375 2.740206 #> [5,] 1.0441809 2.162632 3.154257 #>"},{"path":"https://github.com/NIEHS/GeoTox/reference/simulate_inhalation_rate.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate inhalation rates — simulate_inhalation_rate","title":"Simulate inhalation rates — simulate_inhalation_rate","text":"Simulate inhalation rates","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/simulate_inhalation_rate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate inhalation rates — simulate_inhalation_rate","text":"","code":"simulate_inhalation_rate(x, IR_params = NULL)"},{"path":"https://github.com/NIEHS/GeoTox/reference/simulate_inhalation_rate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate inhalation rates — simulate_inhalation_rate","text":"x numeric vector list numeric vectors containing ages. IR_params (optional) data frame columns \"age\", \"mean\" \"sd\". See details information.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/simulate_inhalation_rate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate inhalation rates — simulate_inhalation_rate","text":"List numeric vectors containing inhalation rates.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/simulate_inhalation_rate.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simulate inhalation rates — simulate_inhalation_rate","text":"age column optional IR_params data frame ascending order represent lower value age groups corresponding mean sd values. provided, default values come Table 6.7 EPA's 2011 Exposure Factors Handbook using mean male female values.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/simulate_inhalation_rate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate inhalation rates — simulate_inhalation_rate","text":"","code":"# Single numeric vector ages <- sample(1:100, 6, replace = TRUE) simulate_inhalation_rate(ages) #> [[1]] #> [1] 0.2932500 0.2185389 0.2775303 0.1959811 0.2619654 0.2890411 #>   # List of numeric vectors ages <- list(   sample(1:100, 5, replace = TRUE),   sample(1:100, 3, replace = TRUE) ) simulate_inhalation_rate(ages) #> [[1]] #> [1] 0.1771644 0.3518773 0.1941855 0.2418979 0.1494693 #>  #> [[2]] #> [1] 0.2621927 0.1900576 0.1580984 #>   # Custom IR_params IR_params <- data.frame(\"age\" = c(0, 20, 50),                         \"mean\" = c(0.5, 0.3, 0.2),                         \"sd\" = c(0.1, 0.06, 0.03)) simulate_inhalation_rate(c(15, 30, 65), IR_params) #> [[1]] #> [1] 0.4052714 0.2191278 0.2305595 #>"},{"path":"https://github.com/NIEHS/GeoTox/reference/simulate_obesity.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate obesity status — simulate_obesity","title":"Simulate obesity status — simulate_obesity","text":"Simulate obesity status","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/simulate_obesity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate obesity status — simulate_obesity","text":"","code":"simulate_obesity(   x,   obes_prev = \"OBESITY_CrudePrev\",   obes_sd = \"OBESITY_SD\",   obes_label = \"FIPS\",   n = 1000 )"},{"path":"https://github.com/NIEHS/GeoTox/reference/simulate_obesity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate obesity status — simulate_obesity","text":"x data frame containing obesity data percentage 0 100. obes_prev column name prevalence. obes_sd column name standard deviation. obes_label column name labeling term, required x one row. n simulated sample size(s).","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/simulate_obesity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate obesity status — simulate_obesity","text":"List arrays containing simulated obesity status.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/simulate_obesity.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simulate obesity status — simulate_obesity","text":"sample size can either single value vector length number rows x. single value provided, sample size used data frames. vector provided, element corresponds sample size row x.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/simulate_obesity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate obesity status — simulate_obesity","text":"","code":"# Input has default column names df <- data.frame(OBESITY_CrudePrev = c(20, 50, 80),                  OBESITY_SD = c(5, 5, 5),                  FIPS = letters[1:3]) simulate_obesity(df, n = 5) #> $a #> [1] \"Normal\" \"Obese\"  \"Normal\" \"Normal\" \"Normal\" #>  #> $b #> [1] \"Obese\"  \"Obese\"  \"Obese\"  \"Obese\"  \"Normal\" #>  #> $c #> [1] \"Obese\"  \"Obese\"  \"Normal\" \"Obese\"  \"Obese\"  #>  # different sample sizes simulate_obesity(df, n = 5:3) #> $a #> [1] \"Normal\" \"Normal\" \"Normal\" \"Normal\" \"Obese\"  #>  #> $b #> [1] \"Normal\" \"Obese\"  \"Obese\"  \"Obese\"  #>  #> $c #> [1] \"Obese\" \"Obese\" \"Obese\" #>   # Input has custom column names df <- data.frame(prev = c(20, 50, 80),                  sd = c(5, 5, 5),                  label = letters[1:3]) simulate_obesity(df,                  obes_prev = \"prev\",                  obes_sd = \"sd\",                  obes_label = \"label\",                  n = 5) #> $a #> [1] \"Normal\" \"Normal\" \"Normal\" \"Normal\" \"Normal\" #>  #> $b #> [1] \"Obese\"  \"Normal\" \"Normal\" \"Obese\"  \"Obese\"  #>  #> $c #> [1] \"Obese\" \"Obese\" \"Obese\" \"Obese\" \"Obese\" #>"},{"path":"https://github.com/NIEHS/GeoTox/reference/simulate_population.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate population data — simulate_population","title":"Simulate population data — simulate_population","text":"Simulate population data given input fields","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/simulate_population.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate population data — simulate_population","text":"","code":"simulate_population(   x,   age = NULL,   obesity = NULL,   exposure = NULL,   simulated_css = NULL,   ... )"},{"path":"https://github.com/NIEHS/GeoTox/reference/simulate_population.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate population data — simulate_population","text":"x GeoTox object. age input x function simulate_age. simulating ages, inhalation rate subsequently calculated using simulate_inhalation_rate. obesity input x function simulate_obesity. exposure input x function simulate_exposure. simulated_css input simulated_css functions sample_Css get_fixed_css. ... additional arguments passed functions. See details.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/simulate_population.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate population data — simulate_population","text":"object simulated fields added.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/simulate_population.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simulate population data — simulate_population","text":"Additional parameters include n sample size(s), IR_params simulate_inhalation_rate, obes_prev, obes_sd, obes_label simulate_obesity, expos_mean, expos_sd, expos_label simulate_exposure.","code":""},{"path":"https://github.com/NIEHS/GeoTox/reference/simulate_population.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate population data — simulate_population","text":"","code":"# Use a subset of the package data for demonstration purposes set.seed(2357) n <- 10 # Population size m <- 5 # Number of regions idx <- if (m < 100) sample(1:100, m) else 1:100  # Create GeoTox object geoTox <- GeoTox() |>   # Simulate populations for each region   simulate_population(age = split(geo_tox_data$age, ~FIPS)[idx],                       obesity = geo_tox_data$obesity[idx, ],                       exposure = split(geo_tox_data$exposure, ~FIPS)[idx],                       simulated_css = geo_tox_data$simulated_css,                       n = n)                        # Variable population sizes n <- 6:10 geoTox <- GeoTox() |>   # Simulate populations for each region   simulate_population(age = split(geo_tox_data$age, ~FIPS)[idx],                       obesity = geo_tox_data$obesity[idx, ],                       exposure = split(geo_tox_data$exposure, ~FIPS)[idx],                       simulated_css = geo_tox_data$simulated_css,                       n = n)"},{"path":"https://github.com/NIEHS/GeoTox/news/index.html","id":"geotox-030","dir":"Changelog","previous_headings":"","what":"GeoTox 0.3.0","title":"GeoTox 0.3.0","text":"CRAN release: 2026-01-16 compute_sensitivity() wrapper sensitivity_analysis() now use fixed Css data column orders explicitly set match functions. column orders now enforced underlying functions get_fixed_age(), get_fixed_obesity(), get_fixed_params(). Added set_population(), allows age /obesity status set directly require simulation. simulate_* functions can now handle population sizes vary across regions.","code":""},{"path":"https://github.com/NIEHS/GeoTox/news/index.html","id":"geotox-020","dir":"Changelog","previous_headings":"","what":"GeoTox 0.2.0","title":"GeoTox 0.2.0","text":"CRAN release: 2024-11-15 Initial CRAN submission.","code":""}]
