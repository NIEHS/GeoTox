[{"path":[]},{"path":"https://niehs.github.io/GeoTox/CODE_OF_CONDUCT.html","id":"our-pledge","dir":"","previous_headings":"","what":"Our Pledge","title":"Contributor Covenant Code of Conduct","text":"members, contributors, leaders pledge make participation community harassment-free experience everyone, regardless age, body size, visible invisible disability, ethnicity, sex characteristics, gender identity expression, level experience, education, socio-economic status, nationality, personal appearance, race, caste, color, religion, sexual identity orientation. pledge act interact ways contribute open, welcoming, diverse, inclusive, healthy community.","code":""},{"path":"https://niehs.github.io/GeoTox/CODE_OF_CONDUCT.html","id":"our-standards","dir":"","previous_headings":"","what":"Our Standards","title":"Contributor Covenant Code of Conduct","text":"Examples behavior contributes positive environment community include: Demonstrating empathy kindness toward people respectful differing opinions, viewpoints, experiences Giving gracefully accepting constructive feedback Accepting responsibility apologizing affected mistakes, learning experience Focusing best just us individuals, overall community Examples unacceptable behavior include: use sexualized language imagery, sexual attention advances kind Trolling, insulting derogatory comments, personal political attacks Public private harassment Publishing others’ private information, physical email address, without explicit permission conduct reasonably considered inappropriate professional setting","code":""},{"path":"https://niehs.github.io/GeoTox/CODE_OF_CONDUCT.html","id":"enforcement-responsibilities","dir":"","previous_headings":"","what":"Enforcement Responsibilities","title":"Contributor Covenant Code of Conduct","text":"Community leaders responsible clarifying enforcing standards acceptable behavior take appropriate fair corrective action response behavior deem inappropriate, threatening, offensive, harmful. Community leaders right responsibility remove, edit, reject comments, commits, code, wiki edits, issues, contributions aligned Code Conduct, communicate reasons moderation decisions appropriate.","code":""},{"path":"https://niehs.github.io/GeoTox/CODE_OF_CONDUCT.html","id":"scope","dir":"","previous_headings":"","what":"Scope","title":"Contributor Covenant Code of Conduct","text":"Code Conduct applies within community spaces, also applies individual officially representing community public spaces. Examples representing community include using official e-mail address, posting via official social media account, acting appointed representative online offline event.","code":""},{"path":"https://niehs.github.io/GeoTox/CODE_OF_CONDUCT.html","id":"enforcement","dir":"","previous_headings":"","what":"Enforcement","title":"Contributor Covenant Code of Conduct","text":"Instances abusive, harassing, otherwise unacceptable behavior may reported community leaders responsible enforcement kyle.messier@nih.gov. complaints reviewed investigated promptly fairly. community leaders obligated respect privacy security reporter incident.","code":""},{"path":"https://niehs.github.io/GeoTox/CODE_OF_CONDUCT.html","id":"enforcement-guidelines","dir":"","previous_headings":"","what":"Enforcement Guidelines","title":"Contributor Covenant Code of Conduct","text":"Community leaders follow Community Impact Guidelines determining consequences action deem violation Code Conduct:","code":""},{"path":"https://niehs.github.io/GeoTox/CODE_OF_CONDUCT.html","id":"id_1-correction","dir":"","previous_headings":"Enforcement Guidelines","what":"1. Correction","title":"Contributor Covenant Code of Conduct","text":"Community Impact: Use inappropriate language behavior deemed unprofessional unwelcome community. Consequence: private, written warning community leaders, providing clarity around nature violation explanation behavior inappropriate. public apology may requested.","code":""},{"path":"https://niehs.github.io/GeoTox/CODE_OF_CONDUCT.html","id":"id_2-warning","dir":"","previous_headings":"Enforcement Guidelines","what":"2. Warning","title":"Contributor Covenant Code of Conduct","text":"Community Impact: violation single incident series actions. Consequence: warning consequences continued behavior. interaction people involved, including unsolicited interaction enforcing Code Conduct, specified period time. includes avoiding interactions community spaces well external channels like social media. Violating terms may lead temporary permanent ban.","code":""},{"path":"https://niehs.github.io/GeoTox/CODE_OF_CONDUCT.html","id":"id_3-temporary-ban","dir":"","previous_headings":"Enforcement Guidelines","what":"3. Temporary Ban","title":"Contributor Covenant Code of Conduct","text":"Community Impact: serious violation community standards, including sustained inappropriate behavior. Consequence: temporary ban sort interaction public communication community specified period time. public private interaction people involved, including unsolicited interaction enforcing Code Conduct, allowed period. Violating terms may lead permanent ban.","code":""},{"path":"https://niehs.github.io/GeoTox/CODE_OF_CONDUCT.html","id":"id_4-permanent-ban","dir":"","previous_headings":"Enforcement Guidelines","what":"4. Permanent Ban","title":"Contributor Covenant Code of Conduct","text":"Community Impact: Demonstrating pattern violation community standards, including sustained inappropriate behavior, harassment individual, aggression toward disparagement classes individuals. Consequence: permanent ban sort public interaction within community.","code":""},{"path":"https://niehs.github.io/GeoTox/CODE_OF_CONDUCT.html","id":"attribution","dir":"","previous_headings":"","what":"Attribution","title":"Contributor Covenant Code of Conduct","text":"Code Conduct adapted Contributor Covenant, version 2.1, available https://www.contributor-covenant.org/version/2/1/code_of_conduct.html. Community Impact Guidelines inspired [Mozilla’s code conduct enforcement ladder][https://github.com/mozilla/inclusion]. answers common questions code conduct, see FAQ https://www.contributor-covenant.org/faq. Translations available https://www.contributor-covenant.org/translations.","code":""},{"path":"https://niehs.github.io/GeoTox/CONTRIBUTING.html","id":null,"dir":"","previous_headings":"","what":"Contributing to GeoTox","title":"Contributing to GeoTox","text":"outlines (1) propose change GeoTox (2) serves log potential enhancements GeoTox.","code":""},{"path":"https://niehs.github.io/GeoTox/CONTRIBUTING.html","id":"best-practices","dir":"","previous_headings":"","what":"Best Practices","title":"Contributing to GeoTox","text":"’ve found bug, please file issue illustrates bug minimal reprex (also help write unit test, needed). See tidyverse team’s guide create great issue advice. adding new function package, always add working examples new function roxygen2 documentation #' @examples.","code":""},{"path":"https://niehs.github.io/GeoTox/CONTRIBUTING.html","id":"pull-request-process","dir":"","previous_headings":"Best Practices","what":"Pull request process","title":"Contributing to GeoTox","text":"Fork package clone onto computer. haven’t done , recommend using usethis::create_from_github(\"NIEHS/GeoTox\", fork = TRUE). Install development dependencies devtools::install_dev_deps(), make sure package passes R CMD check running devtools::check(). R CMD check doesn’t pass cleanly, ’s good idea ask help continuing. Create Git branch pull request (PR). recommend using usethis::pr_init(\"brief-description--change\"). Make changes, commit git, create PR running usethis::pr_push(), following prompts browser. title PR briefly describe change. body PR contain Fixes #issue-number. user-facing changes, add bullet top NEWS.md (.e. just first header).","code":""},{"path":"https://niehs.github.io/GeoTox/CONTRIBUTING.html","id":"code-style","dir":"","previous_headings":"Best Practices","what":"Code style","title":"Contributing to GeoTox","text":"Please abide 80-character line rules (default settings lintr) use roxygen2, Markdown syntax, documentation. use testthat unit tests. Contributions test cases included easier accept.","code":""},{"path":"https://niehs.github.io/GeoTox/CONTRIBUTING.html","id":"fixing-typos","dir":"","previous_headings":"","what":"Fixing typos","title":"Contributing to GeoTox","text":"can fix typos, spelling mistakes, grammatical errors documentation directly using GitHub web interface, long changes made source file. generally means ’ll need edit roxygen2 comments .R, .Rd file. can find .R file generates .Rd reading comment first line.","code":""},{"path":"https://niehs.github.io/GeoTox/CONTRIBUTING.html","id":"geotox-open-issues-and-enhancements","dir":"","previous_headings":"","what":"GeoTox Open Issues and Enhancements","title":"Contributing to GeoTox","text":"section serves log potential enhancements GeoTox. Community members welcomed encouraged use contributing guide address open issues enhancements package. Additionally, new enhancements can proposed using enhancements template request. want address open enchancement suggest new one, ’s good idea first file issue make sure someone team agrees ’s needed.","code":""},{"path":"https://niehs.github.io/GeoTox/CONTRIBUTING.html","id":"scientific","dir":"","previous_headings":"GeoTox Open Issues and Enhancements","what":"Scientific","title":"Contributing to GeoTox","text":"Non-steady state toxicokinetics. likely require additional usage httk package. Complete integration multiple end-point analysis GeoTox objects Integration Reflected Generalized Concentration Addition (RGCA), allow 3+ parameter hill models used additive mixture predictions. Benchmark Dose modeling (BMD) metric risk assessment. Suggested ingetrations include BMDexpress2.0 transcryptR - note transcryptR also currently ","code":""},{"path":"https://niehs.github.io/GeoTox/CONTRIBUTING.html","id":"computational","dir":"","previous_headings":"GeoTox Open Issues and Enhancements","what":"Computational","title":"Contributing to GeoTox","text":"targets pipeline template. provide make-like targets pipeline, new users reproducible template run analysis ease.","code":""},{"path":"https://niehs.github.io/GeoTox/CONTRIBUTING.html","id":"code-of-conduct","dir":"","previous_headings":"","what":"Code of Conduct","title":"Contributing to GeoTox","text":"Please note chopin project released Contributor Code Conduct. contributing project agree abide terms.","code":""},{"path":"https://niehs.github.io/GeoTox/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 GeoTox authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://niehs.github.io/GeoTox/articles/introduction.html","id":"analysis-of-single-assay","dir":"Articles","previous_headings":"","what":"Analysis of single assay","title":"GeoTox Introduction","text":"Create GeoTox object, run simulations computations Plot outputs","code":"set.seed(2357) geoTox <- GeoTox() |>    # Set region and group boundaries (for plotting)   set_boundaries(region = geo_tox_data$boundaries$county,                  group  = geo_tox_data$boundaries$state) |>    # Simulate populations for each region   simulate_population(age           = split(geo_tox_data$age, ~FIPS),                       obesity       = geo_tox_data$obesity,                       exposure      = split(geo_tox_data$exposure, ~FIPS),                       simulated_css = geo_tox_data$simulated_css,                       n             = n) |>    # Estimated Hill parameters   set_hill_params(geo_tox_data$dose_response |>                     filter(endp == \"TOX21_H2AX_HTRF_CHO_Agonist_ratio\") |>                     fit_hill(chem = \"casn\") |>                      filter(!tp.sd.imputed, !logAC50.sd.imputed)) |>   # Calculate response   calculate_response() |>   # Perform sensitivity analysis   sensitivity_analysis()  geoTox #> GeoTox object #> Assays: 1 #> Chemicals: 5 #> Regions: 100 #> Population: 250 #> Data Fields: #>      Name            Class               Dim #>       age    list(integer)       100 x (250) #>        IR    list(numeric)       100 x (250) #>   obesity  list(character)       100 x (250) #>     C_ext     list(matrix)  100 x (250 x 21) #>      C_ss     list(matrix)  100 x (250 x 21) #> Computed Fields: #>          Name             Class               Dim #>         D_int      list(matrix)  100 x (250 x 21) #>     C_invitro      list(matrix)  100 x (250 x 21) #>          resp  list(data.frame)   100 x (250 x 5) #>   sensitivity        list(list)         5 x (100) #> Other Fields: par, boundaries, exposure, css_sensitivity, hill_params plot(geoTox) plot(geoTox, type = \"hill\") plot(geoTox, type = \"sensitivity\") #> Picking joint bandwidth of 0.139"},{"path":"https://niehs.github.io/GeoTox/articles/introduction.html","id":"analysis-of-multiple-assay","dir":"Articles","previous_headings":"","what":"Analysis of multiple assay","title":"GeoTox Introduction","text":"Create GeoTox object, run simulations computations Plot outputs","code":"set.seed(2357) geoTox <- GeoTox() |>    # Set region and group boundaries (for plotting)   set_boundaries(region = geo_tox_data$boundaries$county,                  group  = geo_tox_data$boundaries$state) |>    # Simulate populations for each region   simulate_population(age           = split(geo_tox_data$age, ~FIPS),                       obesity       = geo_tox_data$obesity,                       exposure      = split(geo_tox_data$exposure, ~FIPS),                       simulated_css = geo_tox_data$simulated_css,                       n             = n) |>    # Estimated Hill parameters   set_hill_params(geo_tox_data$dose_response |>                     fit_hill(assay = \"endp\", chem = \"casn\") |>                      filter(!tp.sd.imputed, !logAC50.sd.imputed)) |>   # Calculate response   calculate_response() |>   # Perform sensitivity analysis   sensitivity_analysis()  geoTox #> GeoTox object #> Assays: 13 #> Chemicals: 20 #> Regions: 100 #> Population: 250 #> Data Fields: #>      Name            Class               Dim #>       age    list(integer)       100 x (250) #>        IR    list(numeric)       100 x (250) #>   obesity  list(character)       100 x (250) #>     C_ext     list(matrix)  100 x (250 x 21) #>      C_ss     list(matrix)  100 x (250 x 21) #> Computed Fields: #>          Name             Class               Dim #>         D_int      list(matrix)  100 x (250 x 21) #>     C_invitro      list(matrix)  100 x (250 x 21) #>          resp  list(data.frame)  100 x (3250 x 6) #>   sensitivity        list(list)         5 x (100) #> Other Fields: par, boundaries, exposure, css_sensitivity, hill_params plot(geoTox) #> Warning: Multiple assays found, using first assay 'APR_HepG2_p53Act_24h_up' plot(geoTox, assays = \"TOX21_H2AX_HTRF_CHO_Agonist_ratio\") plot(geoTox, type = \"hill\") plot(geoTox, type = \"sensitivity\") #> Warning: Multiple assays found, using first assay 'APR_HepG2_p53Act_24h_up' #> Warning: Removed 93000 NA values #> Picking joint bandwidth of 0.133 plot(geoTox, type = \"sensitivity\", assay = \"TOX21_H2AX_HTRF_CHO_Agonist_ratio\") #> Picking joint bandwidth of 0.139"},{"path":"https://niehs.github.io/GeoTox/articles/introduction.html","id":"exposure-map","dir":"Articles","previous_headings":"","what":"Exposure Map","title":"GeoTox Introduction","text":"exposure map single multiple assay analyses. map shows distribution chemical exposure across regions chemicals, just used particular analysis.  facet labels present can specified using chem_label argument.","code":"plot(geoTox, type = \"exposure\", ncol = 5) plot(geoTox, type = \"exposure\", chem_label = \"chnm\", ncol = 5)"},{"path":[]},{"path":"https://niehs.github.io/GeoTox/articles/package_data.html","id":"exposure-data","dir":"Articles","previous_headings":"Chemical data","what":"Exposure data","title":"GeoTox Package Data","text":"Download modeled exposure data AirToxScreen. Results AirToxScreen 2019 subset chemicals North Carolina counties included package data geo_tox_data$exposure. NOTE: 2020 release currently provide single file exposure national concentration summaries. 2019 data can found following “Previous air toxics assessments” link.","code":"filename <- \"2019_Toxics_Exposure_Concentrations.xlsx\" tmp <- tempfile(filename) download.file(   paste0(\"https://www.epa.gov/system/files/documents/2022-12/\", filename),   tmp ) exposure <- read_xlsx(tmp)  # Normalization function min_max_norm = function(x) {   min_x <- min(x, na.rm = TRUE)   max_x <- max(x, na.rm = TRUE)   if (min_x == max_x) {     rep(0, length(x))   } else {     (x - min_x) / (max_x - min_x)   } }  geo_tox_data$exposure <- exposure |>    # North Carolina counties   filter(State == \"NC\", !grepl(\"0$\", FIPS)) |>    # Aggregate chemicals by county   summarize(across(-c(State:Tract), c(mean, sd)), .by = FIPS) |>    pivot_longer(-FIPS, names_to = \"chemical\") |>    mutate(stat = if_else(grepl(\"_1$\", chemical), \"mean\", \"sd\"),          chemical = gsub('.{2}$', '', chemical)) |>    pivot_wider(names_from = stat) |>    # Normalize concentrations   mutate(norm = min_max_norm(mean), .by = chemical)"},{"path":"https://niehs.github.io/GeoTox/articles/package_data.html","id":"get-casrn-and-preferred_name-from-comptox-dashboard","dir":"Articles","previous_headings":"Chemical data > Exposure data","what":"Get CASRN and PREFERRED_NAME from CompTox Dashboard","title":"GeoTox Package Data","text":"","code":"# Copy/paste the chemical names into the batch search field # https://comptox.epa.gov/dashboard/batch-search cat(geo_tox_data$exposure |> distinct(chemical) |> pull(), sep = \"\\n\") # Export results with \"CAS-RN\" identifiers as a csv file, then process in R  exposure_casrn <- read_csv(\"CCD-Batch-Search.csv\",                            show_col_types = FALSE) |>    filter(DTXSID != \"N/A\") |>    # Prioritize results based on FOUND_BY status   arrange(INPUT,           grepl(\"Approved Name\", FOUND_BY),           grepl(\"^Synonym\", FOUND_BY)) |>    # Keep one result per INPUT   group_by(INPUT) |>    slice(1) |>    ungroup()  # Update exposure data with CompTox Dashboard data geo_tox_data$exposure <- geo_tox_data$exposure |>    inner_join(exposure_casrn, by = join_by(chemical == INPUT)) |>    select(FIPS, casn = CASRN, chnm = PREFERRED_NAME, mean, sd, norm)"},{"path":"https://niehs.github.io/GeoTox/articles/package_data.html","id":"ice-chts-data","dir":"Articles","previous_headings":"Chemical data","what":"ICE cHTS data","title":"GeoTox Package Data","text":"Use ICE cHTS data identify active chemicals given set assays.","code":"get_cHTS_hits <- function(assays = NULL, chemids = NULL) {      if (is.null(assays) & is.null(chemids)) {     stop(\"Must provide at least one of 'assays' or 'chemids'\")   }      # Format query parameters   req_params <- list()      if (!is.null(assays)) {     if (!is.list(assays)) assays <- as.list(assays)     req_params$assays <- assays   }      if (!is.null(chemids)) {     if (!is.list(chemids)) chemids <- as.list(chemids)     req_params$chemids <- chemids   }      # Query ICE API   resp <- request(\"https://ice.ntp.niehs.nih.gov/api/v1/search\") |>      req_body_json(req_params) |>      req_perform()      if (resp$status_code != 200) {     stop(\"Failed to retrieve data from ICE API\")   }      # Return active chemicals   result <- resp |> resp_body_json() |> pluck(\"endPoints\")      fields <- c(\"assay\", \"casrn\", \"dtxsid\", \"substanceName\",               \"endpoint\", \"value\")      map(fields, \\(x) map_chr(result, x)) |>      set_names(fields) |>     bind_cols() |>      filter(endpoint == \"Call\", value == \"Active\") |>      select(-c(endpoint, value)) |>      distinct() }  assays <- c(\"APR_HepG2_p53Act_1h_dn\",             \"APR_HepG2_p53Act_1h_up\",             \"APR_HepG2_p53Act_24h_dn\",             \"APR_HepG2_p53Act_24h_up\",             \"APR_HepG2_p53Act_72h_dn\",             \"APR_HepG2_p53Act_72h_up\",             \"ATG_p53_CIS_up\",             \"TOX21_DT40\",             \"TOX21_DT40_100\",             \"TOX21_DT40_657\",             \"TOX21_ELG1_LUC_Agonist\",             \"TOX21_H2AX_HTRF_CHO_Agonist_ratio\",             \"TOX21_p53_BLA_p1_ratio\",             \"TOX21_p53_BLA_p2_ratio\",             \"TOX21_p53_BLA_p3_ratio\",             \"TOX21_p53_BLA_p4_ratio\",             \"TOX21_p53_BLA_p5_ratio\")  chemids <- unique(geo_tox_data$exposure$casn)    cHTS_hits_API <- get_cHTS_hits(assays = assays, chemids = chemids)"},{"path":"https://niehs.github.io/GeoTox/articles/package_data.html","id":"dose-response-data","dir":"Articles","previous_headings":"Chemical data","what":"Dose-response data","title":"GeoTox Package Data","text":"Use ICE API retrieve dose-response data selected assays chemicals.","code":"get_ICE_dose_resp <- function(assays = NULL, chemids = NULL) {      if (is.null(assays) & is.null(chemids)) {     stop(\"Must provide at least one of 'assays' or 'chemids'\")   }      # Format query parameters   req_params <- list()      if (!is.null(assays)) {     if (!is.list(assays)) assays <- as.list(assays)     req_params$assays <- assays   }      if (!is.null(chemids)) {     if (!is.list(chemids)) chemids <- as.list(chemids)     req_params$chemids <- chemids   }      # Query ICE API   resp <- request(\"https://ice.ntp.niehs.nih.gov/api/v1/curves\") |>      req_body_json(req_params) |>      req_perform()      if (resp$status_code != 200) {     stop(\"Failed to retrieve data from ICE API\")   }      # Return dose-response data   result <- resp |> resp_body_json() |> pluck(\"curves\")      map(result, function(x) {     tibble(       endp = x[[\"assay\"]],       casn = x[[\"casrn\"]],       call = x[[\"dsstoxsid\"]],       chnm = x[[\"substance\"]],       call = x[[\"call\"]],       logc = map_dbl(x[[\"concentrationResponses\"]], \"concentration\") |> log10(),       resp = map_dbl(x[[\"concentrationResponses\"]], \"response\")     )   }) |>      bind_rows() }  assays <- unique(cHTS_hits_API$assay)  chemids <- intersect(cHTS_hits_API$casrn, geo_tox_data$exposure$casn)  dose_response <- get_ICE_dose_resp(assays = assays, chemids = chemids)  # Only keep active calls for assay/chemical combinations geo_tox_data$dose_response <- dose_response |>    filter(call == \"Active\") |>    select(-call)  # Update dose-response data with CompTox Dashboard data geo_tox_data$dose_response <- geo_tox_data$dose_response |>   inner_join(exposure_casrn, by = join_by(casn == CASRN)) |>   select(endp, casn, chnm = PREFERRED_NAME, logc, resp)"},{"path":[]},{"path":"https://niehs.github.io/GeoTox/articles/package_data.html","id":"age","dir":"Articles","previous_headings":"Population data","what":"Age","title":"GeoTox Package Data","text":"Download age data U.S. Census Bureau searching “County Population Characteristics”. subset data North Carolina 2019 included package data geo_tox_data$age.","code":"# Data for North Carolina url <- paste0(\"https://www2.census.gov/programs-surveys/popest/datasets/\",               \"2010-2019/counties/asrh/cc-est2019-alldata-37.csv\") age <- read_csv(url, show_col_types = FALSE)  geo_tox_data$age <- age |>   # 7/1/2019 population estimate   filter(YEAR == 12) |>   # Create FIPS   mutate(FIPS = str_c(STATE, COUNTY)) |>   # Keep selected columns   select(FIPS, AGEGRP, TOT_POP)"},{"path":"https://niehs.github.io/GeoTox/articles/package_data.html","id":"obesity","dir":"Articles","previous_headings":"Population data","what":"Obesity","title":"GeoTox Package Data","text":"Follow “Data Portal” link CDC PLACES search “places county data”. Go desired dataset webpage, example 2020 county data, download data selecting Actions → API → Download file. subset data North Carolina included package data geo_tox_data$obesity.","code":"places <- read_csv(\"PLACES__County_Data__GIS_Friendly_Format___2020_release.csv\",                    show_col_types = FALSE)  # Convert confidence interval to standard deviation extract_SD <- function(x) {   range <- as.numeric(str_split_1(str_sub(x, 2, -2), \",\"))   diff(range) / 3.92 }  geo_tox_data$obesity <- places |>   # North Carolina Counties   filter(StateAbbr == \"NC\") |>   # Select obesity data   select(FIPS = CountyFIPS, OBESITY_CrudePrev, OBESITY_Crude95CI) |>   # Change confidence interval to standard deviation   rowwise() |>   mutate(OBESITY_SD = extract_SD(OBESITY_Crude95CI)) |>   ungroup() |>   select(-OBESITY_Crude95CI)"},{"path":"https://niehs.github.io/GeoTox/articles/package_data.html","id":"steady-state-plasma-concentration-css","dir":"Articles","previous_headings":"Population data","what":"Steady-state plasma concentration (Css)","title":"GeoTox Package Data","text":"Use httk generate Css values combinations age group weight status chemical. generation values time-intensive step, one approach generate populations Css values initially sample later.","code":"set.seed(2345) n_samples <- 500  # Get CASN for which httk simulation is possible. Try using load_dawson2021, # load_sipes2017, or load_pradeep2020 to increase availability. load_sipes2017() casn <- intersect(unique(geo_tox_data$dose_response$casn),                   get_cheminfo(suppress.messages = TRUE))  # Define population demographics for httk simulation pop_demo <- cross_join(   tibble(age_group = list(c(0, 2), c(3, 5), c(6, 10), c(11, 15),                           c(16, 20), c(21, 30), c(31, 40), c(41, 50),                           c(51, 60), c(61, 70), c(71, 100))),   tibble(weight = c(\"Normal\", \"Obese\"))) |>   # Create column of lower age_group values   rowwise() |>   mutate(age_min = age_group[1]) |>   ungroup()  # Create wrapper function around httk steps simulate_css <- function(chem.cas, agelim_years, weight_category,                          samples, verbose = TRUE) {      if (verbose) {     cat(chem.cas,         paste0(\"(\", paste(agelim_years, collapse = \", \"), \")\"),         weight_category,         \"\\n\")   }      httkpop <- list(method = \"vi\",                   gendernum = NULL,                   agelim_years = agelim_years,                   agelim_months = NULL,                   weight_category = weight_category,                   reths = c(                     \"Mexican American\",                     \"Other Hispanic\",                     \"Non-Hispanic White\",                     \"Non-Hispanic Black\",                     \"Other\"                   ))      css <- try(     suppressWarnings({       mcs <- create_mc_samples(chem.cas = chem.cas,                                samples = samples,                                httkpop.generate.arg.list = httkpop,                                suppress.messages = TRUE)              calc_analytic_css(chem.cas = chem.cas,                         parameters = mcs,                         model = \"3compartmentss\",                         suppress.messages = TRUE)     }),     silent = TRUE   )      # Return   if (is(css, \"try-error\")) {     warning(paste0(\"simulate_css failed to generate data for CASN \", chem.cas))     list(NA)   } else {     list(css)   } }  # Simulate Css values simulated_css <- map(casn, function(chem.cas) {   pop_demo |>     rowwise() |>     mutate(       css = simulate_css(.env$chem.cas, age_group, weight, .env$n_samples)     ) |>     ungroup() }) simulated_css <- setNames(simulated_css, casn)  # Remove CASN that failed simulate_css casn_keep <- map_lgl(simulated_css, function(df) {   !(length(df$css[[1]]) == 1 && is.na(df$css[[1]])) }) simulated_css <- simulated_css[casn_keep]  # Get median Css values for each age_group simulated_css <- map(   simulated_css,   function(cas_df) {     cas_df |>       nest(.by = age_group) |>       mutate(         age_median_css = map_dbl(data, function(df) median(unlist(df$css),                                                            na.rm = TRUE))       ) |>       unnest(data)   } )  # Get median Css values for each weight simulated_css <- map(   simulated_css,   function(cas_df) {     cas_df |>       nest(.by = weight) |>       mutate(         weight_median_css = map_dbl(data, function(df) median(unlist(df$css),                                                               na.rm = TRUE))       ) |>       unnest(data) |>       arrange(age_min, weight)   } )  geo_tox_data$simulated_css <- simulated_css"},{"path":"https://niehs.github.io/GeoTox/articles/package_data.html","id":"prune-data","dir":"Articles","previous_headings":"","what":"Prune data","title":"GeoTox Package Data","text":"Retain chemicals found exposure, dose-response Css datasets.","code":"casn_keep <- names(geo_tox_data$simulated_css)  geo_tox_data$exposure <- geo_tox_data$exposure |>    filter(casn %in% casn_keep)  geo_tox_data$dose_response <- geo_tox_data$dose_response |>    filter(casn %in% casn_keep)"},{"path":"https://niehs.github.io/GeoTox/articles/package_data.html","id":"countystate-boundaries","dir":"Articles","previous_headings":"","what":"County/State boundaries","title":"GeoTox Package Data","text":"Download cartographic boundary files counties states U.S. Census Bureau. geometry data North Carolina counties state included package data geo_tox_data$boundaries.","code":"county <- st_read(\"cb_2019_us_county_5m/cb_2019_us_county_5m.shp\") state <- st_read(\"cb_2019_us_state_5m/cb_2019_us_state_5m.shp\")  geo_tox_data$boundaries <- list(   county = county |>     filter(STATEFP == 37) |>     select(FIPS = GEOID, geometry),   state = state |>     filter(STATEFP == 37) |>     select(geometry) )"},{"path":"https://niehs.github.io/GeoTox/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Skylar Marvel. Author, contributor. David Reif. Author, contributor. Kyle Messier. Maintainer, author, contributor.","code":""},{"path":"https://niehs.github.io/GeoTox/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Marvel S, Reif D, Messier K (2024). GeoTox: Spatiotemporal mixture risk assessment. R package version 0.1.1, https://niehs.github.io/GeoTox/.","code":"@Manual{,   title = {GeoTox: Spatiotemporal mixture risk assessment},   author = {Skylar Marvel and David Reif and Kyle Messier},   year = {2024},   note = {R package version 0.1.1},   url = {https://niehs.github.io/GeoTox/}, }"},{"path":"https://niehs.github.io/GeoTox/index.html","id":"geotox-","dir":"","previous_headings":"","what":"Spatiotemporal mixture risk assessment","title":"Spatiotemporal mixture risk assessment","text":"GeoTox open-source R software package characterizing risk perturbing molecular targets involved adverse human health outcomes based exposure spatially-referenced stressor mixtures. original framework described Eccles KM, Karmaus AL, Kleinstreuer NC, Parham F, Rider CV, Wambaugh JF, Messier KP. geospatial modeling approach quantifying risk exposure environmental chemical mixtures via common molecular target. Sci Total Environ. 2023 Jan 10;855:158905. doi: 10.1016/j.scitotenv.2022.158905. Epub 2022 Sep 21. PMID: 36152849; PMCID: PMC9979101. GeoTox package represents significant advancement environmental risk characterization, providing modular software facilitate application development GeoTox framework quantifying relationship environmental exposures health outcomes. integrating geospatial methods cutting-edge exposure toxicological frameworks, GeoTox offers robust tool assessing individual population-level risks environmental stressors. Toxic effects mediated chemicals alter critical molecules, cells, physiological processes inside body. spirit, clear phenotypic outcomes (e.g. disease) individual population level can occur series source, exposure, biological dynamics. refer source--outcome-continuum. follows methods data exist quantify step sequence, step can integrated neighboring step, individual population outcomes can quantified spatiotemporally resolved environmental sources exposures. Figure: GeoTox Workflow Flowchart GeoTox Framework. blue text nodes represent object green text, rounded nodes represent methodology function required go one next.","code":""},{"path":"https://niehs.github.io/GeoTox/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Spatiotemporal mixture risk assessment","text":"package CRAN near future - please stay tuned. can install development version GeoTox GitHub :","code":"if (!require(\"pak\", quietly = TRUE)) {   install.packages(\"pak\") } pak::pkg_install(\"NIEHS/GeoTox\")"},{"path":"https://niehs.github.io/GeoTox/reference/GeoTox-package.html","id":null,"dir":"Reference","previous_headings":"","what":"GeoTox: Spatiotemporal mixture risk assessment — GeoTox-package","title":"GeoTox: Spatiotemporal mixture risk assessment — GeoTox-package","text":"Open-source software connecting spatiotemporal exposure individual population-level risk.","code":""},{"path":[]},{"path":"https://niehs.github.io/GeoTox/reference/GeoTox-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"GeoTox: Spatiotemporal mixture risk assessment — GeoTox-package","text":"Maintainer: Kyle Messier kyle.messier@nih.gov [contributor] Authors: Skylar Marvel skylar.marvel@nih.gov [contributor] David Reif david.reif@nih.gov [contributor]","code":""},{"path":"https://niehs.github.io/GeoTox/reference/GeoTox.html","id":null,"dir":"Reference","previous_headings":"","what":"GeoTox S3 object — GeoTox","title":"GeoTox S3 object — GeoTox","text":"S3 object can used help organize data results GeoTox analysis.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/GeoTox.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"GeoTox S3 object — GeoTox","text":"","code":"GeoTox()  # S3 method for class 'GeoTox' plot(x, type = c(\"resp\", \"hill\", \"exposure\", \"sensitivity\"), ...)"},{"path":"https://niehs.github.io/GeoTox/reference/GeoTox.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"GeoTox S3 object — GeoTox","text":"x GeoTox object. type type plot. ... arguments passed subsequent methods.","code":""},{"path":[]},{"path":"https://niehs.github.io/GeoTox/reference/calc_concentration_response.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the mixture response from one of three different approaches: IA, GCA, or Hazard Quotient — calc_concentration_response","title":"Calculate the mixture response from one of three different approaches: IA, GCA, or Hazard Quotient — calc_concentration_response","text":"Calculate combined response multiple chemicals. calculates generalized concentration addition response, independent action response, hazard quotient","code":""},{"path":"https://niehs.github.io/GeoTox/reference/calc_concentration_response.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the mixture response from one of three different approaches: IA, GCA, or Hazard Quotient — calc_concentration_response","text":"","code":"calc_concentration_response(   C_invitro,   hill_params,   tp_b_mult = 1.5,   fixed = FALSE )"},{"path":"https://niehs.github.io/GeoTox/reference/calc_concentration_response.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the mixture response from one of three different approaches: IA, GCA, or Hazard Quotient — calc_concentration_response","text":"C_invitro vitro concentrations hill_params output fit_hill() tp_b_mult upper bound multiplier tp rtruncnorm fixed TRUE, sd = 0","code":""},{"path":"https://niehs.github.io/GeoTox/reference/calc_concentration_response.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the mixture response from one of three different approaches: IA, GCA, or Hazard Quotient — calc_concentration_response","text":"data frame","code":""},{"path":"https://niehs.github.io/GeoTox/reference/calc_independent_action.html","id":null,"dir":"Reference","previous_headings":"","what":"Independent Action — calc_independent_action","title":"Independent Action — calc_independent_action","text":"Calculate independent action response set chemicals Hill concentration-response curves.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/calc_independent_action.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Independent Action — calc_independent_action","text":"","code":"calc_independent_action(conc, max, AC50, Emax, n = 1)"},{"path":"https://niehs.github.io/GeoTox/reference/calc_independent_action.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Independent Action — calc_independent_action","text":"conc concentrations regular space max maximal (asymtotic) responses AC50 concentrations half-maximal response Emax maximum mixture response n Hill coefficients (slopes)","code":""},{"path":"https://niehs.github.io/GeoTox/reference/calc_independent_action.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Independent Action — calc_independent_action","text":"response value","code":""},{"path":"https://niehs.github.io/GeoTox/reference/calc_independent_action.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Independent Action — calc_independent_action","text":"concentration computed : $$   IA = E_{max}   \\left(     1 - \\prod\\limits_{} \\left(1 - \\frac{x_i}{E_{max}}\\right)   \\right), $$ \\(x_i = hill\\_val(conc_i, max_i, AC50_i, n_i)\\) Hill model response function chemical.","code":""},{"path":[]},{"path":"https://niehs.github.io/GeoTox/reference/calc_internal_dose.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate internal chemical dose — calc_internal_dose","title":"Calculate internal chemical dose — calc_internal_dose","text":"Estimate internal dose inhalation chemical given inhalation rate, time, body weight","code":""},{"path":"https://niehs.github.io/GeoTox/reference/calc_internal_dose.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate internal chemical dose — calc_internal_dose","text":"","code":"calc_internal_dose(C_ext, IR, time = 1, BW = 1, scaling = 1)"},{"path":"https://niehs.github.io/GeoTox/reference/calc_internal_dose.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate internal chemical dose — calc_internal_dose","text":"C_ext ambient chemical concentration \\(\\frac{mg}{m^3}\\) IR inhalation rate \\(\\frac{m^3}{day}\\) time total time \\(days\\) BW body weight \\(kg\\) scaling scaling factor encompassing required unit adjustments","code":""},{"path":"https://niehs.github.io/GeoTox/reference/calc_internal_dose.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate internal chemical dose — calc_internal_dose","text":"internal chemical dose \\(\\frac{mg}{kg}\\)","code":""},{"path":"https://niehs.github.io/GeoTox/reference/calc_internal_dose.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate internal chemical dose — calc_internal_dose","text":"TODO Additional details... $$D_{int} = \\frac{C_{ext} \\,\\times\\, IR \\,\\times\\, time}{BW}$$","code":""},{"path":"https://niehs.github.io/GeoTox/reference/calc_internal_dose.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate internal chemical dose — calc_internal_dose","text":"","code":"n_chem <- 3 n_sample <- 5  # Single population C_ext <- matrix(runif(n_sample * n_chem), ncol = n_chem) IR <- runif(n_sample) calc_internal_dose(C_ext, IR) #>             [,1]       [,2]        [,3] #> [1,] 0.015800366 0.09125914 0.171132967 #> [2,] 0.336685183 0.20087215 0.070595211 #> [3,] 0.038245313 0.01844701 0.002179853 #> [4,] 0.061107128 0.28487219 0.124534354 #> [5,] 0.007218509 0.75363169 0.392490442  # Multiple populations C_ext <- list(   \"a\" = matrix(runif(n_sample * n_chem), ncol = n_chem),   \"b\" = matrix(runif(n_sample * n_chem), ncol = n_chem) ) IR <- list(runif(n_sample), runif(n_sample)) calc_internal_dose(C_ext, IR) #> $a #>           [,1]       [,2]       [,3] #> [1,] 0.1336944 0.34197969 0.01440300 #> [2,] 0.2138538 0.01621801 0.07110673 #> [3,] 0.1284426 0.09261534 0.05254789 #> [4,] 0.1041654 0.36988156 0.33832828 #> [5,] 0.4840307 0.33989673 0.23646425 #>  #> $b #>            [,1]       [,2]      [,3] #> [1,] 0.33679479 0.53005683 0.5966388 #> [2,] 0.14423849 0.10185347 0.1571509 #> [3,] 0.67671195 0.45777230 0.7067715 #> [4,] 0.01176099 0.04306118 0.0632936 #> [5,] 0.07682741 0.03401241 0.1378512 #>"},{"path":"https://niehs.github.io/GeoTox/reference/calc_invitro_concentration.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate in vitro concentration — calc_invitro_concentration","title":"Calculate in vitro concentration — calc_invitro_concentration","text":"TODO short description...","code":""},{"path":"https://niehs.github.io/GeoTox/reference/calc_invitro_concentration.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate in vitro concentration — calc_invitro_concentration","text":"","code":"calc_invitro_concentration(D_int, C_ss = NULL)"},{"path":"https://niehs.github.io/GeoTox/reference/calc_invitro_concentration.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate in vitro concentration — calc_invitro_concentration","text":"D_int internal chemical dose \\(\\frac{mg}{kg}\\) C_ss steady-state plasma concentration \\(\\frac{\\mu M}{mg / kg}\\)","code":""},{"path":"https://niehs.github.io/GeoTox/reference/calc_invitro_concentration.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate in vitro concentration — calc_invitro_concentration","text":"vitro equivalent plasma concentration \\(\\mu M\\)","code":""},{"path":"https://niehs.github.io/GeoTox/reference/calc_invitro_concentration.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate in vitro concentration — calc_invitro_concentration","text":"TODO Additional details... $$C_{plasma} = C_{ss} \\,\\times\\, D_{int}$$","code":""},{"path":"https://niehs.github.io/GeoTox/reference/calculate_response.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate response — calculate_response","title":"Calculate response — calculate_response","text":"Calculate mixture response GeoTox population data","code":""},{"path":"https://niehs.github.io/GeoTox/reference/calculate_response.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate response — calculate_response","text":"","code":"calculate_response(x, ...)"},{"path":"https://niehs.github.io/GeoTox/reference/calculate_response.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate response — calculate_response","text":"x GeoTox object ... additional arguments passed functions. See details.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/calculate_response.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate response — calculate_response","text":"object additional fields added updated","code":""},{"path":"https://niehs.github.io/GeoTox/reference/calculate_response.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate response — calculate_response","text":"Additional parameters include time, BW, scaling calc_internal_dose, tp_b_mult calc_concentration_response.","code":""},{"path":[]},{"path":"https://niehs.github.io/GeoTox/reference/compute_sensitivity.html","id":null,"dir":"Reference","previous_headings":"","what":"Title — compute_sensitivity","title":"Title — compute_sensitivity","text":"Title","code":""},{"path":"https://niehs.github.io/GeoTox/reference/compute_sensitivity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title — compute_sensitivity","text":"","code":"compute_sensitivity(   x,   vary = c(\"age\", \"obesity\", \"css_params\", \"fit_params\", \"C_ext\"),   tp_b_mult = NULL )"},{"path":"https://niehs.github.io/GeoTox/reference/compute_sensitivity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title — compute_sensitivity","text":"x . vary . tp_b_mult .","code":""},{"path":"https://niehs.github.io/GeoTox/reference/compute_sensitivity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title — compute_sensitivity","text":".","code":""},{"path":"https://niehs.github.io/GeoTox/reference/dot-check_lengths.html","id":null,"dir":"Reference","previous_headings":"","what":"Check for matching lengths — .check_lengths","title":"Check for matching lengths — .check_lengths","text":"Check matching lengths","code":""},{"path":"https://niehs.github.io/GeoTox/reference/dot-check_lengths.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check for matching lengths — .check_lengths","text":"","code":".check_lengths(x, y)"},{"path":"https://niehs.github.io/GeoTox/reference/dot-check_lengths.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check for matching lengths — .check_lengths","text":"x list arrays y list arrays","code":""},{"path":"https://niehs.github.io/GeoTox/reference/dot-check_lengths.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check for matching lengths — .check_lengths","text":"boolean, TRUE error","code":""},{"path":"https://niehs.github.io/GeoTox/reference/dot-check_names.html","id":null,"dir":"Reference","previous_headings":"","what":"Check for names — .check_names","title":"Check for names — .check_names","text":"Check names","code":""},{"path":"https://niehs.github.io/GeoTox/reference/dot-check_names.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check for names — .check_names","text":"","code":".check_names(x, names)"},{"path":"https://niehs.github.io/GeoTox/reference/dot-check_names.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check for names — .check_names","text":"x object check names names look ","code":""},{"path":"https://niehs.github.io/GeoTox/reference/dot-check_names.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check for names — .check_names","text":"boolean, TRUE error","code":""},{"path":"https://niehs.github.io/GeoTox/reference/fit_hill.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit 2- or 3-parameter Hill model — fit_hill","title":"Fit 2- or 3-parameter Hill model — fit_hill","text":"Fit 2- 3-parameter Hill model","code":""},{"path":"https://niehs.github.io/GeoTox/reference/fit_hill.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit 2- or 3-parameter Hill model — fit_hill","text":"","code":"fit_hill(   x,   conc = \"logc\",   resp = \"resp\",   fixed_slope = TRUE,   chem = NULL,   assay = NULL )"},{"path":"https://niehs.github.io/GeoTox/reference/fit_hill.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit 2- or 3-parameter Hill model — fit_hill","text":"x data frame dose response data. conc column name base-10 log scaled concentration. resp column name response. fixed_slope TRUE, slope fixed 1. chem (optional) column name chemical identifiers. assay (optional) column name assay identifiers.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/fit_hill.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit 2- or 3-parameter Hill model — fit_hill","text":"data frame fit parameters.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/fit_hill.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fit 2- or 3-parameter Hill model — fit_hill","text":"Optional chem assay identifiers can used fit multiple chemicals /assays. Returned columns tp top asymptote logAC50 50% response concentration. computation standard deviations two parameters fails, standard deviation set equal parameter estimate indicated respective imputed flag TRUE.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/fit_hill.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit 2- or 3-parameter Hill model — fit_hill","text":"","code":"# Multiple assays, multiple chemicals df <- geo_tox_data$dose_response fit_hill(df, assay = \"endp\", chem = \"casn\") #> # A tibble: 89 × 15 #>    assay  chem     tp  tp.sd logAC50 logAC50.sd slope slope.sd logc_min logc_max #>    <chr>  <chr> <dbl>  <dbl>   <dbl>      <dbl> <dbl>    <dbl>    <dbl>    <dbl> #>  1 APR_H… 510-…  4.44  5.86     2.06      0.448     1        0   -0.398     2.30 #>  2 APR_H… 92-8…  2.14  0.945    2.05      0.271     1        0   -0.398     2.30 #>  3 APR_H… 95-9…  1.46  0.556    1.67      0.246     1        0   -0.699     2    #>  4 APR_H… 510-…  2.33  0.542    1.79      0.192     1        0   -0.398     2.30 #>  5 APR_H… 72-4…  1.93  1.93     1.95      1.95      1        0   -0.398     2.30 #>  6 APR_H… 92-8…  2.43  1.50     2.22      0.317     1        0   -0.398     2.30 #>  7 ATG_p… 87-8…  2.15  0.877    1.57      0.321     1        0   -1.30      2    #>  8 TOX21… 100-… 71.4  27.2      1.54      0.294     1        0   -3         2    #>  9 TOX21… 101-… 80.1  80.1      2.31      2.31      1        0   -3         1.95 #> 10 TOX21… 101-…  0     0        2.45      0.101     1        0   -3         1.95 #> # ℹ 79 more rows #> # ℹ 5 more variables: resp_min <dbl>, resp_max <dbl>, AIC <dbl>, #> #   tp.sd.imputed <lgl>, logAC50.sd.imputed <lgl>  # Single assay, multiple chemicals df <- geo_tox_data$dose_response |>   dplyr::filter(endp == \"TOX21_H2AX_HTRF_CHO_Agonist_ratio\") fit_hill(df, chem = \"casn\") #> # A tibble: 7 × 14 #>   chem        tp  tp.sd logAC50 logAC50.sd slope slope.sd logc_min logc_max #>   <chr>    <dbl>  <dbl>   <dbl>      <dbl> <dbl>    <dbl>    <dbl>    <dbl> #> 1 106-50-3  29.9  14.7     1.88     0.363      1        0    -3        1.90 #> 2 119-90-4  65.6  65.6     2.09     2.09       1        0    -2.70     2.30 #> 3 120-80-9 126.    8.29    1.54     0.0796     1        0    -2.70     2.30 #> 4 123-31-9 108.  108.      2.39     2.39       1        0    -2.70     2.30 #> 5 510-15-6  48.5   7.47    2.24     0.123      1        0    -2.70     2.30 #> 6 88-06-2   58.7  37.0     2.80     0.310      1        0    -2.70     2.30 #> 7 92-87-5   73.7   7.22    2.06     0.0863     1        0    -2.70     2.30 #> # ℹ 5 more variables: resp_min <dbl>, resp_max <dbl>, AIC <dbl>, #> #   tp.sd.imputed <lgl>, logAC50.sd.imputed <lgl>  # Single assay, single chemical df <- geo_tox_data$dose_response |>   dplyr::filter(endp == \"TOX21_H2AX_HTRF_CHO_Agonist_ratio\",                 casn == \"510-15-6\") fit_hill(df) #> # A tibble: 1 × 13 #>      tp tp.sd logAC50 logAC50.sd slope slope.sd logc_min logc_max resp_min #>   <dbl> <dbl>   <dbl>      <dbl> <dbl>    <dbl>    <dbl>    <dbl>    <dbl> #> 1  48.5  7.47    2.24      0.123     1        0    -2.70     2.30    -2.38 #> # ℹ 4 more variables: resp_max <dbl>, AIC <dbl>, tp.sd.imputed <lgl>, #> #   logAC50.sd.imputed <lgl> # 3-parameter Hill model fit_hill(df, fixed_slope = FALSE) #> # A tibble: 1 × 13 #>      tp tp.sd logAC50 logAC50.sd slope slope.sd logc_min logc_max resp_min #>   <dbl> <dbl>   <dbl>      <dbl> <dbl>    <dbl>    <dbl>    <dbl>    <dbl> #> 1  31.2  1.29    1.83     0.0173  4.02    0.864    -2.70     2.30    -2.38 #> # ℹ 4 more variables: resp_max <dbl>, AIC <dbl>, tp.sd.imputed <lgl>, #> #   logAC50.sd.imputed <lgl>"},{"path":"https://niehs.github.io/GeoTox/reference/geo_tox_data.html","id":null,"dir":"Reference","previous_headings":"","what":"GeoTox Data — geo_tox_data","title":"GeoTox Data — geo_tox_data","text":"Sample data use vignettes function examples. See Package Data vignette, vignette(\"package_data\", package = \"GeoTox\"), details data gathered.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/geo_tox_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"GeoTox Data — geo_tox_data","text":"","code":"geo_tox_data"},{"path":"https://niehs.github.io/GeoTox/reference/geo_tox_data.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"GeoTox Data — geo_tox_data","text":"list items: exposure 2019 AirToxScreen exposure concentrations subset chemicals North Carolina counties. dose_response Subset chemicals curated ICE cHTS active within set assays. age County population estimates 7/1/2019 North Carolina. obesity CDC PLACES obesity data North Carolina counties 2020. simulated_css Simulated steady-state plasma concentrations various age groups obesity status combinations. boundaries County state boundaries North Carolina 2019.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/get_fixed_age.html","id":null,"dir":"Reference","previous_headings":"","what":"Get C_ss Data for Fixed Age — get_fixed_age","title":"Get C_ss Data for Fixed Age — get_fixed_age","text":"Get C_ss Data Fixed Age","code":""},{"path":"https://niehs.github.io/GeoTox/reference/get_fixed_age.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get C_ss Data for Fixed Age — get_fixed_age","text":"","code":"get_fixed_age(simulated_css, age)"},{"path":"https://niehs.github.io/GeoTox/reference/get_fixed_age.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get C_ss Data for Fixed Age — get_fixed_age","text":"simulated_css list pre-generated C_ss data, details see: vignette(\"package_data\", package = \"GeoTox\"). age list atomic vectors containing ages.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/get_fixed_age.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get C_ss Data for Fixed Age — get_fixed_age","text":"list matrices containing median C_ss values.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/get_fixed_age.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get C_ss Data for Fixed Age — get_fixed_age","text":"","code":"get_fixed_age(simulated_css = geo_tox_data$simulated_css,               age = list(c(25, 35, 55), c(15, 60))) #> [[1]] #>      87-86-5 95-95-4 133-06-2 101-14-4 63-25-2 510-15-6 106-50-3 91-94-1 #> [1,]  5.6245   6.656   2.3210  0.20555 0.10435  0.11010  0.35850  0.1832 #> [2,]  6.7320   8.194   3.0145  0.26055 0.13450  0.14015  0.48860  0.2070 #> [3,]  9.7745  10.615   3.7720  0.34805 0.18920  0.21190  0.66345  0.2928 #>      84-74-2 120-80-9 100-02-7 119-90-4 123-31-9 60-11-7 95-80-7 88-06-2 #> [1,]  1.2445   1.4985  0.84285   6.7105  0.30055  2.2450  3.4785  3.3765 #> [2,]  1.6280   1.9545  1.17400   7.3715  0.39220  2.7920  3.8750  4.4375 #> [3,]  2.2435   2.5475  1.44250   8.6155  0.53005  3.6225  4.6450  6.2555 #>      92-87-5 101-77-9 53-96-3 72-43-5 56-38-2 #> [1,]  1.0200   1.3740   3.187  4.7235  2.6265 #> [2,]  1.2380   1.6265   3.648  5.8290  3.2970 #> [3,]  1.5575   2.1620   4.755  7.8175  4.3650 #>  #> [[2]] #>      87-86-5 95-95-4 133-06-2 101-14-4  63-25-2 510-15-6 106-50-3 91-94-1 #> [1,]  4.3915  4.7355   1.7015  0.16175 0.073885 0.089035  0.27315  0.1245 #> [2,]  9.7745 10.6150   3.7720  0.34805 0.189200 0.211900  0.66345  0.2928 #>      84-74-2 120-80-9 100-02-7 119-90-4 123-31-9 60-11-7 95-80-7 88-06-2 #> [1,] 0.97755   1.1135  0.68195   5.3505  0.20900  1.6395   2.781  2.6675 #> [2,] 2.24350   2.5475  1.44250   8.6155  0.53005  3.6225   4.645  6.2555 #>      92-87-5 101-77-9 53-96-3 72-43-5 56-38-2 #> [1,]  0.7936    1.023   2.194  3.9780  1.9685 #> [2,]  1.5575    2.162   4.755  7.8175  4.3650 #>"},{"path":"https://niehs.github.io/GeoTox/reference/get_fixed_css.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Fixed C_ss Data — get_fixed_css","title":"Get Fixed C_ss Data — get_fixed_css","text":"Get C_ss values use sensitivity_analysis compute_sensitivity.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/get_fixed_css.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Fixed C_ss Data — get_fixed_css","text":"","code":"get_fixed_css(simulated_css, age, obesity, C_ss)"},{"path":"https://niehs.github.io/GeoTox/reference/get_fixed_css.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Fixed C_ss Data — get_fixed_css","text":"simulated_css list pre-generated C_ss data, details see: vignette(\"package_data\", package = \"GeoTox\"). age list atomic vectors containing ages. obesity list atomic vectors containing obesity status. C_ss list matrices containing C_ss values.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/get_fixed_css.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Fixed C_ss Data — get_fixed_css","text":"list matrices atomic vectors containing C_ss values.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/get_fixed_css.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Fixed C_ss Data — get_fixed_css","text":"","code":"# Define inputs age <- list(c(25, 35, 55),             c(15, 60)) obesity <- list(c(\"Obese\", \"Normal\", \"Obese\"),                 c(\"Normal\", \"Normal\")) C_ss <- sample_Css(simulated_css = geo_tox_data$simulated_css,                    age = age,                    obesity = obesity)  # Get fixed C_ss data get_fixed_css(simulated_css = geo_tox_data$simulated_css,               age = age,               obesity = obesity,               C_ss = C_ss) #> $age #> $age[[1]] #>      87-86-5 95-95-4 133-06-2 101-14-4 63-25-2 510-15-6 106-50-3 91-94-1 #> [1,]  5.6245   6.656   2.3210  0.20555 0.10435  0.11010  0.35850  0.1832 #> [2,]  6.7320   8.194   3.0145  0.26055 0.13450  0.14015  0.48860  0.2070 #> [3,]  9.7745  10.615   3.7720  0.34805 0.18920  0.21190  0.66345  0.2928 #>      84-74-2 120-80-9 100-02-7 119-90-4 123-31-9 60-11-7 95-80-7 88-06-2 #> [1,]  1.2445   1.4985  0.84285   6.7105  0.30055  2.2450  3.4785  3.3765 #> [2,]  1.6280   1.9545  1.17400   7.3715  0.39220  2.7920  3.8750  4.4375 #> [3,]  2.2435   2.5475  1.44250   8.6155  0.53005  3.6225  4.6450  6.2555 #>      92-87-5 101-77-9 53-96-3 72-43-5 56-38-2 #> [1,]  1.0200   1.3740   3.187  4.7235  2.6265 #> [2,]  1.2380   1.6265   3.648  5.8290  3.2970 #> [3,]  1.5575   2.1620   4.755  7.8175  4.3650 #>  #> $age[[2]] #>      87-86-5 95-95-4 133-06-2 101-14-4  63-25-2 510-15-6 106-50-3 91-94-1 #> [1,]  4.3915  4.7355   1.7015  0.16175 0.073885 0.089035  0.27315  0.1245 #> [2,]  9.7745 10.6150   3.7720  0.34805 0.189200 0.211900  0.66345  0.2928 #>      84-74-2 120-80-9 100-02-7 119-90-4 123-31-9 60-11-7 95-80-7 88-06-2 #> [1,] 0.97755   1.1135  0.68195   5.3505  0.20900  1.6395   2.781  2.6675 #> [2,] 2.24350   2.5475  1.44250   8.6155  0.53005  3.6225   4.645  6.2555 #>      92-87-5 101-77-9 53-96-3 72-43-5 56-38-2 #> [1,]  0.7936    1.023   2.194  3.9780  1.9685 #> [2,]  1.5575    2.162   4.755  7.8175  4.3650 #>  #>  #> $params #> $params[[1]] #>      87-86-5 95-95-4 133-06-2 101-14-4 63-25-2 510-15-6 106-50-3 91-94-1 #> [1,]   4.404   1.304   0.9946   0.1019 0.04979  0.43940   0.2574  0.7429 #> [2,]   1.794  32.430   2.6440   0.1599 0.04364  0.09107   0.4853  0.1834 #> [3,]   2.488   3.664   3.0900   0.1390 0.51990  0.34070   0.3184  0.1107 #>      84-74-2 120-80-9 100-02-7 119-90-4 123-31-9 60-11-7 95-80-7 88-06-2 #> [1,]   1.054   0.3659   2.6660    9.064  0.24880   1.199   5.052   2.255 #> [2,]   8.483   0.4516   0.3714    6.947  0.09955   1.903   3.510  21.050 #> [3,]   1.894  10.5200   0.4136    8.771  0.43830   2.793   3.054  10.570 #>      92-87-5 101-77-9 53-96-3 72-43-5 56-38-2 #> [1,]  0.4169   0.4320   3.021   4.555   7.446 #> [2,]  0.9420   2.2440   2.558   6.807   2.245 #> [3,]  0.8401   0.4163   7.539   5.202   1.437 #>  #> $params[[2]] #>      87-86-5 95-95-4 133-06-2 101-14-4 63-25-2 510-15-6 106-50-3 91-94-1 #> [1,]   3.377  15.970    2.644   0.1924  0.2514  0.03926   0.1348 0.08410 #> [2,]   6.774   2.429    9.401   0.3423  0.2218  0.05910   0.6323 0.07476 #>      84-74-2 120-80-9 100-02-7 119-90-4 123-31-9 60-11-7 95-80-7 88-06-2 #> [1,]  8.4830    9.282    5.442     7.93   0.3137  0.8692   5.278  3.5190 #> [2,]  0.5505    1.997    0.282    11.91   0.3024  2.0040   2.158  0.3827 #>      92-87-5 101-77-9 53-96-3 72-43-5 56-38-2 #> [1,]  0.4107   2.4650   4.070  43.480   1.466 #> [2,]  1.4260   0.9017   1.315   7.185   2.598 #>  #>  #> $obesity #> $obesity[[1]] #>      87-86-5 95-95-4 133-06-2 101-14-4 63-25-2 510-15-6 106-50-3 91-94-1 #> [1,]  7.4820  8.6775    2.965  0.28405  0.1432 0.153750   0.5077 0.22425 #> [2,]  4.4205  4.9300    1.849  0.16290  0.0820 0.088135   0.3035 0.12915 #> [3,]  7.4820  8.6775    2.965  0.28405  0.1432 0.153750   0.5077 0.22425 #>      84-74-2 120-80-9 100-02-7 119-90-4 123-31-9 60-11-7 95-80-7 88-06-2 #> [1,]   1.726   2.0710   1.1730   7.3635   0.4089  2.9815   3.926   4.751 #> [2,]   1.037   1.2025   0.7162   5.8545   0.2387  1.7780   2.953   2.757 #> [3,]   1.726   2.0710   1.1730   7.3635   0.4089  2.9815   3.926   4.751 #>      92-87-5 101-77-9 53-96-3 72-43-5 56-38-2 #> [1,] 1.31000    1.758  3.8180  6.3620  3.6535 #> [2,] 0.80915    1.087  2.3715  3.7635  2.1955 #> [3,] 1.31000    1.758  3.8180  6.3620  3.6535 #>  #> $obesity[[2]] #>      87-86-5 95-95-4 133-06-2 101-14-4 63-25-2 510-15-6 106-50-3 91-94-1 #> [1,]  4.4205    4.93    1.849   0.1629   0.082 0.088135   0.3035 0.12915 #> [2,]  4.4205    4.93    1.849   0.1629   0.082 0.088135   0.3035 0.12915 #>      84-74-2 120-80-9 100-02-7 119-90-4 123-31-9 60-11-7 95-80-7 88-06-2 #> [1,]   1.037   1.2025   0.7162   5.8545   0.2387   1.778   2.953   2.757 #> [2,]   1.037   1.2025   0.7162   5.8545   0.2387   1.778   2.953   2.757 #>      92-87-5 101-77-9 53-96-3 72-43-5 56-38-2 #> [1,] 0.80915    1.087  2.3715  3.7635  2.1955 #> [2,] 0.80915    1.087  2.3715  3.7635  2.1955 #>  #>  #> $other #> $other[[1]] #> [1] 1.871 1.871 1.871 #>  #> $other[[2]] #> [1] 1.4375 1.4375 #>  #>"},{"path":"https://niehs.github.io/GeoTox/reference/get_fixed_obesity.html","id":null,"dir":"Reference","previous_headings":"","what":"Get C_ss Data for Fixed Obesity Status — get_fixed_obesity","title":"Get C_ss Data for Fixed Obesity Status — get_fixed_obesity","text":"Get C_ss Data Fixed Obesity Status","code":""},{"path":"https://niehs.github.io/GeoTox/reference/get_fixed_obesity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get C_ss Data for Fixed Obesity Status — get_fixed_obesity","text":"","code":"get_fixed_obesity(simulated_css, obesity)"},{"path":"https://niehs.github.io/GeoTox/reference/get_fixed_obesity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get C_ss Data for Fixed Obesity Status — get_fixed_obesity","text":"simulated_css list pre-generated C_ss data, details see: vignette(\"package_data\", package = \"GeoTox\"). obesity list atomic vectors containing obesity status.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/get_fixed_obesity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get C_ss Data for Fixed Obesity Status — get_fixed_obesity","text":"list matrices containing median C_ss values.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/get_fixed_obesity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get C_ss Data for Fixed Obesity Status — get_fixed_obesity","text":"","code":"get_fixed_obesity(simulated_css = geo_tox_data$simulated_css,                   obesity = list(c(\"Obese\", \"Normal\", \"Obese\"),                                  c(\"Normal\", \"Normal\"))) #> [[1]] #>      87-86-5 95-95-4 133-06-2 101-14-4 63-25-2 510-15-6 106-50-3 91-94-1 #> [1,]  7.4820  8.6775    2.965  0.28405  0.1432 0.153750   0.5077 0.22425 #> [2,]  4.4205  4.9300    1.849  0.16290  0.0820 0.088135   0.3035 0.12915 #> [3,]  7.4820  8.6775    2.965  0.28405  0.1432 0.153750   0.5077 0.22425 #>      84-74-2 120-80-9 100-02-7 119-90-4 123-31-9 60-11-7 95-80-7 88-06-2 #> [1,]   1.726   2.0710   1.1730   7.3635   0.4089  2.9815   3.926   4.751 #> [2,]   1.037   1.2025   0.7162   5.8545   0.2387  1.7780   2.953   2.757 #> [3,]   1.726   2.0710   1.1730   7.3635   0.4089  2.9815   3.926   4.751 #>      92-87-5 101-77-9 53-96-3 72-43-5 56-38-2 #> [1,] 1.31000    1.758  3.8180  6.3620  3.6535 #> [2,] 0.80915    1.087  2.3715  3.7635  2.1955 #> [3,] 1.31000    1.758  3.8180  6.3620  3.6535 #>  #> [[2]] #>      87-86-5 95-95-4 133-06-2 101-14-4 63-25-2 510-15-6 106-50-3 91-94-1 #> [1,]  4.4205    4.93    1.849   0.1629   0.082 0.088135   0.3035 0.12915 #> [2,]  4.4205    4.93    1.849   0.1629   0.082 0.088135   0.3035 0.12915 #>      84-74-2 120-80-9 100-02-7 119-90-4 123-31-9 60-11-7 95-80-7 88-06-2 #> [1,]   1.037   1.2025   0.7162   5.8545   0.2387   1.778   2.953   2.757 #> [2,]   1.037   1.2025   0.7162   5.8545   0.2387   1.778   2.953   2.757 #>      92-87-5 101-77-9 53-96-3 72-43-5 56-38-2 #> [1,] 0.80915    1.087  2.3715  3.7635  2.1955 #> [2,] 0.80915    1.087  2.3715  3.7635  2.1955 #>"},{"path":"https://niehs.github.io/GeoTox/reference/get_fixed_other.html","id":null,"dir":"Reference","previous_headings":"","what":"Get median C_ss Values — get_fixed_other","title":"Get median C_ss Values — get_fixed_other","text":"Get median C_ss Values","code":""},{"path":"https://niehs.github.io/GeoTox/reference/get_fixed_other.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get median C_ss Values — get_fixed_other","text":"","code":"get_fixed_other(C_ss)"},{"path":"https://niehs.github.io/GeoTox/reference/get_fixed_other.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get median C_ss Values — get_fixed_other","text":"C_ss list matrices containing C_ss data","code":""},{"path":"https://niehs.github.io/GeoTox/reference/get_fixed_other.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get median C_ss Values — get_fixed_other","text":"list atomic vectors containing median C_ss values.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/get_fixed_other.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get median C_ss Values — get_fixed_other","text":"","code":"# Generate input C_ss data age <- list(c(25, 35, 55),             c(15, 60)) obesity <- list(c(\"Obese\", \"Normal\", \"Obese\"),                 c(\"Normal\", \"Normal\")) C_ss <- sample_Css(simulated_css = geo_tox_data$simulated_css,                    age = age,                    obesity = obesity)  # Get median C_ss values get_fixed_other(C_ss) #> [[1]] #> [1] 2.341 2.341 2.341 #>  #> [[2]] #> [1] 1.3065 1.3065 #>"},{"path":"https://niehs.github.io/GeoTox/reference/get_fixed_params.html","id":null,"dir":"Reference","previous_headings":"","what":"Get C_ss Data for Fixed C_ss Generation Parameters — get_fixed_params","title":"Get C_ss Data for Fixed C_ss Generation Parameters — get_fixed_params","text":"Get C_ss Data Fixed C_ss Generation Parameters","code":""},{"path":"https://niehs.github.io/GeoTox/reference/get_fixed_params.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get C_ss Data for Fixed C_ss Generation Parameters — get_fixed_params","text":"","code":"get_fixed_params(simulated_css, age)"},{"path":"https://niehs.github.io/GeoTox/reference/get_fixed_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get C_ss Data for Fixed C_ss Generation Parameters — get_fixed_params","text":"simulated_css list pre-generated C_ss data, details see: vignette(\"package_data\", package = \"GeoTox\"). age list atomic vectors containing ages.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/get_fixed_params.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get C_ss Data for Fixed C_ss Generation Parameters — get_fixed_params","text":"list matrices containing C_ss values.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/get_fixed_params.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get C_ss Data for Fixed C_ss Generation Parameters — get_fixed_params","text":"","code":"get_fixed_params(simulated_css = geo_tox_data$simulated_css,                  age = list(c(25, 35, 55), c(15, 60))) #> [[1]] #>      87-86-5 95-95-4 133-06-2 101-14-4 63-25-2 510-15-6 106-50-3 91-94-1 #> [1,]   4.172  42.140    6.380  0.09562 0.08334  0.48490   0.3857  0.1128 #> [2,]  26.420   3.664    3.214  0.10350 0.03723  0.03873   0.2399  0.1850 #> [3,]   1.864   3.022    1.288  0.14240 0.09454  0.06997   0.4033  0.1868 #>      84-74-2 120-80-9 100-02-7 119-90-4 123-31-9 60-11-7 95-80-7 88-06-2 #> [1,]   2.133   0.9134   0.5047    9.146  0.09892   1.707   6.411   4.783 #> [2,]   1.150   0.4343   0.8290    4.596  0.04941   3.052   1.746   4.688 #> [3,]   2.207   1.0680   0.7836    5.935  0.68290   1.344  10.290   5.638 #>      92-87-5 101-77-9 53-96-3 72-43-5 56-38-2 #> [1,]  0.8269   3.2860   1.525  11.750  0.9994 #> [2,]  0.9672   1.2290   2.348   3.232  1.6010 #> [3,]  2.2520   0.5107   4.196   4.497  2.5240 #>  #> [[2]] #>      87-86-5 95-95-4 133-06-2 101-14-4 63-25-2 510-15-6 106-50-3 91-94-1 #> [1,]   2.253   4.540    1.978  0.12880  1.1870   0.5913   0.2580 0.05482 #> [2,]   4.992   7.646    2.515  0.07632  0.4348   0.7224   0.2187 0.46030 #>      84-74-2 120-80-9 100-02-7 119-90-4 123-31-9 60-11-7 95-80-7 88-06-2 #> [1,]   4.937    1.761   1.4030   47.300  0.08553   1.899 6.96500   4.013 #> [2,]   1.072    5.364   0.9973    8.322  0.08989   1.766 0.01844   3.141 #>      92-87-5 101-77-9 53-96-3 72-43-5 56-38-2 #> [1,]   1.602    1.508   4.217   4.497   1.646 #> [2,]   1.215    1.077   1.824   7.804   2.190 #>"},{"path":"https://niehs.github.io/GeoTox/reference/hill_conc.html","id":null,"dir":"Reference","previous_headings":"","what":"Hill model concentration — hill_conc","title":"Hill model concentration — hill_conc","text":"Calculate concentration regular space given response value.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/hill_conc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hill model concentration — hill_conc","text":"","code":"hill_conc(resp, max, AC50, n)"},{"path":"https://niehs.github.io/GeoTox/reference/hill_conc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Hill model concentration — hill_conc","text":"resp response value max maximal (asymtotic) response AC50 concentration half-maximal response n Hill coefficient (slope)","code":""},{"path":"https://niehs.github.io/GeoTox/reference/hill_conc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Hill model concentration — hill_conc","text":"concentration regular space","code":""},{"path":"https://niehs.github.io/GeoTox/reference/hill_conc.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Hill model concentration — hill_conc","text":"regular space version tcpl::tcplHillConc(). concentration computed : $$conc = AC50 * (\\frac{max}{resp} - 1)^{-1 / n}$$","code":""},{"path":[]},{"path":"https://niehs.github.io/GeoTox/reference/hill_val.html","id":null,"dir":"Reference","previous_headings":"","what":"Hill model response — hill_val","title":"Hill model response — hill_val","text":"Calculate response given concentration regular space.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/hill_val.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hill model response — hill_val","text":"","code":"hill_val(conc, max, AC50, n)"},{"path":"https://niehs.github.io/GeoTox/reference/hill_val.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Hill model response — hill_val","text":"conc concentration regular space max maximal (asymtotic) response AC50 concentration half-maximal response n Hill coefficient (slope)","code":""},{"path":"https://niehs.github.io/GeoTox/reference/hill_val.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Hill model response — hill_val","text":"response value","code":""},{"path":"https://niehs.github.io/GeoTox/reference/hill_val.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Hill model response — hill_val","text":"regular space version tcpl::tcplHillVal(). Hill model defined : $$resp = \\frac{max}{1 + (\\frac{AC50}{conc})^{n}}$$","code":""},{"path":[]},{"path":"https://niehs.github.io/GeoTox/reference/obj_ECx.html","id":null,"dir":"Reference","previous_headings":"","what":"A Generalized concentration addition style solution — obj_ECx","title":"A Generalized concentration addition style solution — obj_ECx","text":"Find effective concentration mixture via objective function given concentrations inverse, based regular space AC50 concentrations.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/obj_ECx.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A Generalized concentration addition style solution — obj_ECx","text":"","code":"obj_ECx(conc_mix, resp, conc, max, AC50)"},{"path":"https://niehs.github.io/GeoTox/reference/obj_ECx.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A Generalized concentration addition style solution — obj_ECx","text":"conc_mix effective concentration mixture regular space resp individual chemical responses conc individual chemical concentrations regular space max maximal (asymtotic) response AC50 concentrations half-maximal response","code":""},{"path":"https://niehs.github.io/GeoTox/reference/obj_ECx.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A Generalized concentration addition style solution — obj_ECx","text":"objective value","code":""},{"path":"https://niehs.github.io/GeoTox/reference/obj_GCA.html","id":null,"dir":"Reference","previous_headings":"","what":"Generalized concentration addition objective function — obj_GCA","title":"Generalized concentration addition objective function — obj_GCA","text":"Use find optimal efficacy value based regular space AC50 concentrations.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/obj_GCA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generalized concentration addition objective function — obj_GCA","text":"","code":"obj_GCA(ln_resp, conc, max, AC50)"},{"path":"https://niehs.github.io/GeoTox/reference/obj_GCA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generalized concentration addition objective function — obj_GCA","text":"ln_resp natural log individual chemical responses conc individual chemical concentrations regular space max maximal (asymtotic) responses AC50 concentrations half-maximal response","code":""},{"path":"https://niehs.github.io/GeoTox/reference/obj_GCA.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generalized concentration addition objective function — obj_GCA","text":"objective value","code":""},{"path":"https://niehs.github.io/GeoTox/reference/obj_hill.html","id":null,"dir":"Reference","previous_headings":"","what":"Objective function for 2- or 3-parameter Hill model — obj_hill","title":"Objective function for 2- or 3-parameter Hill model — obj_hill","text":"Objective function 2- 3-parameter Hill model","code":""},{"path":"https://niehs.github.io/GeoTox/reference/obj_hill.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Objective function for 2- or 3-parameter Hill model — obj_hill","text":"","code":"obj_hill(par, log10_conc, resp)"},{"path":"https://niehs.github.io/GeoTox/reference/obj_hill.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Objective function for 2- or 3-parameter Hill model — obj_hill","text":"par parameters log10_conc base-10 log scale concentration resp response","code":""},{"path":"https://niehs.github.io/GeoTox/reference/obj_hill.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Objective function for 2- or 3-parameter Hill model — obj_hill","text":"value objective function","code":""},{"path":"https://niehs.github.io/GeoTox/reference/plot_exposure.html","id":null,"dir":"Reference","previous_headings":"","what":"Title — plot_exposure","title":"Title — plot_exposure","text":"Title","code":""},{"path":"https://niehs.github.io/GeoTox/reference/plot_exposure.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title — plot_exposure","text":"","code":"plot_exposure(   exposure,   region_boundary,   group_boundary = NULL,   chem_label = \"chnm\",   ncol = 2 )"},{"path":"https://niehs.github.io/GeoTox/reference/plot_exposure.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title — plot_exposure","text":"exposure . region_boundary . group_boundary . chem_label . ncol .","code":""},{"path":"https://niehs.github.io/GeoTox/reference/plot_exposure.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title — plot_exposure","text":".","code":""},{"path":"https://niehs.github.io/GeoTox/reference/plot_hill.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Hill equation fits. — plot_hill","title":"Plot Hill equation fits. — plot_hill","text":"Plot Hill equation fits.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/plot_hill.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Hill equation fits. — plot_hill","text":"","code":"plot_hill(hill_params, xlim = c(-1, 4))"},{"path":"https://niehs.github.io/GeoTox/reference/plot_hill.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Hill equation fits. — plot_hill","text":"hill_params output fit_hill. xlim log-10 scaled concentration limits.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/plot_hill.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Hill equation fits. — plot_hill","text":"ggplot2 object.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/plot_hill.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Hill equation fits. — plot_hill","text":"","code":"# Multiple assays, multiple chemicals df <- geo_tox_data$dose_response plot_hill(fit_hill(df, assay = \"endp\", chem = \"casn\"))   # Single assay, multiple chemicals df <- geo_tox_data$dose_response |>   dplyr::filter(endp == \"TOX21_H2AX_HTRF_CHO_Agonist_ratio\") fig <- plot_hill(fit_hill(df, chem = \"casn\")) fig  # Modify plot fig + ggplot2::guides(color = ggplot2::guide_legend(title = \"Chemical\\nCASN\"))   # Single assay, single chemical df <- geo_tox_data$dose_response |>   dplyr::filter(endp == \"TOX21_H2AX_HTRF_CHO_Agonist_ratio\",                 casn == \"510-15-6\") plot_hill(fit_hill(df))  # 3-parameter Hill model plot_hill(fit_hill(df, fixed_slope = FALSE))"},{"path":"https://niehs.github.io/GeoTox/reference/plot_resp.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot response data — plot_resp","title":"Plot response data — plot_resp","text":"Plot response data","code":""},{"path":"https://niehs.github.io/GeoTox/reference/plot_resp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot response data — plot_resp","text":"","code":"plot_resp(   df,   region_boundary,   group_boundary = NULL,   assay_quantiles = c(Median = 0.5),   summary_quantiles = c(`10th percentile` = 0.1) )"},{"path":"https://niehs.github.io/GeoTox/reference/plot_resp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot response data — plot_resp","text":"df output resp_quantiles. region_boundary \"sf\" data.frame mapping features \"geometry\" column. Used color map regions. group_boundary \"sf\" data.frame containing \"geometry\" column. Used draw outlines around groups regions. assay_quantiles named numeric vector assay quantile labels. summary_quantiles named numeric vector summary quantile labels.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/plot_resp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot response data — plot_resp","text":"ggplot2 object.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/plot_sensitivity.html","id":null,"dir":"Reference","previous_headings":"","what":"Title — plot_sensitivity","title":"Title — plot_sensitivity","text":"Title","code":""},{"path":"https://niehs.github.io/GeoTox/reference/plot_sensitivity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title — plot_sensitivity","text":"","code":"plot_sensitivity(   x,   metric = \"GCA.Eff\",   assay = NULL,   y = \"\",   xlab = metric,   ylab = \"\" )"},{"path":"https://niehs.github.io/GeoTox/reference/plot_sensitivity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title — plot_sensitivity","text":"x . metric . assay . y . xlab . ylab .","code":""},{"path":"https://niehs.github.io/GeoTox/reference/plot_sensitivity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title — plot_sensitivity","text":".","code":""},{"path":"https://niehs.github.io/GeoTox/reference/resp_quantiles.html","id":null,"dir":"Reference","previous_headings":"","what":"Get response quantiles — resp_quantiles","title":"Get response quantiles — resp_quantiles","text":"Get response quantiles","code":""},{"path":"https://niehs.github.io/GeoTox/reference/resp_quantiles.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get response quantiles — resp_quantiles","text":"","code":"resp_quantiles(   resp,   metric = c(\"GCA.Eff\", \"IA.Eff\", \"GCA.HQ.10\", \"IA.HQ.10\"),   assays = NULL,   assay_summary = FALSE,   assay_quantiles = c(Median = 0.5),   summary_quantiles = c(`10th percentile` = 0.1) )"},{"path":"https://niehs.github.io/GeoTox/reference/resp_quantiles.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get response quantiles — resp_quantiles","text":"resp calculated mixture response output calculate_response. metric response metric, one \"GCA.Eff\", \"IA.Eff\", \"GCA.HQ.10\" \"IA.HQ.10\". assays assays summarize. NULL multiple assays exist, first assay used. assay_summary boolean indicating whether summarize across assays. assay_quantiles numeric vector assay quantiles. summary_quantiles numeric vector quantiles compute across assay quantiles.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/resp_quantiles.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get response quantiles — resp_quantiles","text":"data frame computed response quantiles.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/resp_quantiles.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get response quantiles — resp_quantiles","text":"columns returned data frame vary based inputs. assays specified assay_summary FALSE, resulting data frame assay column. assay_summary TRUE, data frame summary_quantile column.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/sample_Css.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample from pre-generated C_ss data — sample_Css","title":"Sample from pre-generated C_ss data — sample_Css","text":"Sample pre-generated C_ss data","code":""},{"path":"https://niehs.github.io/GeoTox/reference/sample_Css.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample from pre-generated C_ss data — sample_Css","text":"","code":"sample_Css(simulated_css, age, obesity)"},{"path":"https://niehs.github.io/GeoTox/reference/sample_Css.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample from pre-generated C_ss data — sample_Css","text":"simulated_css list pre-generated C_ss data, details see: vignette(\"package_data\", package = \"GeoTox\"). age list atomic vector ages. obesity list atomic vector obesity status.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/sample_Css.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample from pre-generated C_ss data — sample_Css","text":"list matrices containing C_ss values. Columns sorted consistent order across functions.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/sample_Css.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample from pre-generated C_ss data — sample_Css","text":"","code":"# Vector inputs sample_Css(geo_tox_data$simulated_css,            c(15, 25, 35),            c(\"Normal\", \"Obese\", \"Normal\")) #> [[1]] #>      100-02-7 101-14-4 101-77-9 106-50-3 119-90-4 120-80-9 123-31-9 133-06-2 #> [1,]   1.0360   0.2379   0.5984  0.06974    8.126  0.05157  0.09568   0.2853 #> [2,]   0.5947   0.1133   1.0650  0.74580    4.563  5.44100  1.33300   2.8310 #> [3,]   0.9630   0.3498   2.3540  4.25700    4.498  2.32100  0.26360   1.9250 #>      510-15-6 53-96-3 56-38-2 60-11-7 63-25-2 72-43-5 84-74-2 87-86-5 88-06-2 #> [1,]  0.07045   2.644  0.4645  0.6918 0.03553  29.760  0.5365   2.727   7.040 #> [2,]  0.38000   3.264  9.1780  1.7800 0.13500  32.090  1.8410   2.797   4.630 #> [3,]  0.03674   2.485  1.3940  1.1850 0.08932   2.286  1.2440   5.798   2.568 #>      91-94-1 92-87-5 95-80-7 95-95-4 #> [1,]  0.4060  0.9832   1.387   59.27 #> [2,]  0.2865  1.1400 148.900   10.36 #> [3,]  0.4039  8.7930   2.325    8.81 #>   # List inputs sample_Css(geo_tox_data$simulated_css,            list(c(34, 29), 55),            list(c(\"Obese\", \"Normal\"), \"Normal\")) #> [[1]] #>      100-02-7 101-14-4 101-77-9 106-50-3 119-90-4 120-80-9 123-31-9 133-06-2 #> [1,]    1.471   1.0290   1.2790  1.08700   10.590   3.1300   1.0040    3.583 #> [2,]    1.002   0.2539   0.6829  0.09995    3.419   0.6947   0.4052    2.646 #>      510-15-6 53-96-3 56-38-2 60-11-7 63-25-2 72-43-5 84-74-2 87-86-5 88-06-2 #> [1,]  0.06458  4.9850   3.848   4.336  0.1602   3.687  1.2210  22.360  22.030 #> [2,]  0.03606  0.4679   2.062   2.303  0.1165   1.232  0.5437   5.599   1.669 #>      91-94-1 92-87-5 95-80-7 95-95-4 #> [1,] 0.20150   9.339   5.118 110.000 #> [2,] 0.06294   1.003   1.878   3.353 #>  #> [[2]] #>      100-02-7 101-14-4 101-77-9 106-50-3 119-90-4 120-80-9 123-31-9 133-06-2 #> [1,]    1.003   0.2062    1.719   0.4855    3.812   0.3568   0.3265    4.593 #>      510-15-6 53-96-3 56-38-2 60-11-7 63-25-2 72-43-5 84-74-2 87-86-5 88-06-2 #> [1,]  0.04728   1.243   9.162   1.449 0.02623   2.262   2.209   2.472   10.44 #>      91-94-1 92-87-5 95-80-7 95-95-4 #> [1,]  0.0983  0.6278   5.404   3.289 #>"},{"path":"https://niehs.github.io/GeoTox/reference/sensitivity_analysis.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform sensitivity analysis — sensitivity_analysis","title":"Perform sensitivity analysis — sensitivity_analysis","text":"Perform sensitivity analysis","code":""},{"path":"https://niehs.github.io/GeoTox/reference/sensitivity_analysis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform sensitivity analysis — sensitivity_analysis","text":"","code":"sensitivity_analysis(x)"},{"path":"https://niehs.github.io/GeoTox/reference/sensitivity_analysis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform sensitivity analysis — sensitivity_analysis","text":"x GeoTox object","code":""},{"path":"https://niehs.github.io/GeoTox/reference/sensitivity_analysis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform sensitivity analysis — sensitivity_analysis","text":"object additional fields added updated","code":""},{"path":"https://niehs.github.io/GeoTox/reference/set_boundaries.html","id":null,"dir":"Reference","previous_headings":"","what":"Set GeoTox boundaries — set_boundaries","title":"Set GeoTox boundaries — set_boundaries","text":"Set GeoTox boundaries","code":""},{"path":"https://niehs.github.io/GeoTox/reference/set_boundaries.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set GeoTox boundaries — set_boundaries","text":"","code":"set_boundaries(x, region = NULL, group = NULL)"},{"path":"https://niehs.github.io/GeoTox/reference/set_boundaries.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set GeoTox boundaries — set_boundaries","text":"x GeoTox object. region \"sf\" data.frame mapping features \"geometry\" column. Used coloring map regions. group \"sf\" data.frame containing \"geometry\" column. Used draw outlines around groups regions.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/set_boundaries.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set GeoTox boundaries — set_boundaries","text":"GeoTox object boundaries set.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/set_boundaries.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set GeoTox boundaries — set_boundaries","text":"","code":"geoTox <- GeoTox() |>    set_boundaries(region = geo_tox_data$boundaries$county,                  group  = geo_tox_data$boundaries$state)"},{"path":"https://niehs.github.io/GeoTox/reference/set_hill_params.html","id":null,"dir":"Reference","previous_headings":"","what":"Set Hill parameters for a GeoTox object. — set_hill_params","title":"Set Hill parameters for a GeoTox object. — set_hill_params","text":"Set Hill parameters GeoTox object.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/set_hill_params.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set Hill parameters for a GeoTox object. — set_hill_params","text":"","code":"set_hill_params(x, hill_params)"},{"path":"https://niehs.github.io/GeoTox/reference/set_hill_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set Hill parameters for a GeoTox object. — set_hill_params","text":"x GeoTox object. hill_params output fit_hill.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/set_hill_params.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set Hill parameters for a GeoTox object. — set_hill_params","text":"GeoTox object Hill parameters set.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/set_hill_params.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set Hill parameters for a GeoTox object. — set_hill_params","text":"","code":"hill_params <- geo_tox_data$dose_response |>   fit_hill(chem = \"casn\", assay = \"endp\") |>   dplyr::filter(!tp.sd.imputed, !logAC50.sd.imputed)  geoTox <- GeoTox() |>    set_hill_params(hill_params)"},{"path":"https://niehs.github.io/GeoTox/reference/simulate_age.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate ages — simulate_age","title":"Simulate ages — simulate_age","text":"Simulate ages","code":""},{"path":"https://niehs.github.io/GeoTox/reference/simulate_age.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate ages — simulate_age","text":"","code":"simulate_age(x, n = 1000)"},{"path":"https://niehs.github.io/GeoTox/reference/simulate_age.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate ages — simulate_age","text":"x data frame list data frames containing population data age groups. data frame must contain columns \"AGEGRP\" \"TOT_POP\". n simulated sample size.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/simulate_age.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate ages — simulate_age","text":"List arrays containing simulated ages.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/simulate_age.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simulate ages — simulate_age","text":"data frame must contain 19 rows. first row represents total population age groups next 18 rows represent age groups 0 89 increments 5 years.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/simulate_age.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate ages — simulate_age","text":"","code":"# Single data frame x <- data.frame(AGEGRP = 0:18, TOT_POP = 0) # populate only age range 40-44, set population total of all ages x$TOT_POP[c(1, 10)] <- 100 simulate_age(x, 5) #> [[1]] #> [1] 44 41 41 41 44 #>   # List of 2 data frames y <- data.frame(AGEGRP = 0:18, TOT_POP = 0) # populate age ranges 5-9 and 50-54 y$TOT_POP[c(3, 12)] <- 10 # set population total for all age groups y$TOT_POP[1] <- sum(y$TOT_POP) simulate_age(list(x = x, y = y), 15) #> $x #>  [1] 41 41 40 40 41 42 41 43 40 44 40 40 44 41 40 #>  #> $y #>  [1] 52  5  9 52 53 54  9  5 50 51 52 54  9  5 52 #>"},{"path":"https://niehs.github.io/GeoTox/reference/simulate_exposure.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate external exposure — simulate_exposure","title":"Simulate external exposure — simulate_exposure","text":"Simulate external exposure","code":""},{"path":"https://niehs.github.io/GeoTox/reference/simulate_exposure.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate external exposure — simulate_exposure","text":"","code":"simulate_exposure(   x,   expos_mean = \"mean\",   expos_sd = \"sd\",   expos_label = \"casn\",   n = 1000 )"},{"path":"https://niehs.github.io/GeoTox/reference/simulate_exposure.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate external exposure — simulate_exposure","text":"x data frame list data frames containing exposure data. expos_mean column name mean values. expos_sd column name standard deviations. expos_label column name labeling term, required x one row. n simulated sample size.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/simulate_exposure.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate external exposure — simulate_exposure","text":"list matrices containing inhalation rates. Matrix columns named using values expos_label column one data frame row. Columns sorted consistent order across functions.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/simulate_exposure.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate external exposure — simulate_exposure","text":"","code":"# Single data frame x <- data.frame(mean = 1:3, sd = (1:3) / 10, casn = letters[1:3]) simulate_exposure(x, n = 5) #> [[1]] #>              a        b        c #> [1,] 0.9162794 2.281386 2.789820 #> [2,] 1.1026353 1.967633 3.487486 #> [3,] 1.0853874 2.147120 3.011090 #> [4,] 1.0825224 2.019398 2.887788 #> [5,] 1.0253444 2.005498 2.768367 #>   # List of 2 data frames y <- data.frame(mean = 4:6, sd = 0.1, casn = letters[1:3]) simulate_exposure(list(loc1 = x, loc2 = y), n = 5) #> $loc1 #>              a        b        c #> [1,] 0.9666123 2.243208 2.792414 #> [2,] 1.0642952 1.782184 3.002066 #> [3,] 1.0436256 2.108897 2.953796 #> [4,] 1.0095881 2.092255 2.982321 #> [5,] 1.0328365 1.702447 2.840226 #>  #> $loc2 #>             a        b        c #> [1,] 4.107907 4.881840 5.857508 #> [2,] 4.087462 5.005932 6.193692 #> [3,] 3.933398 4.816838 6.068842 #> [4,] 3.887372 5.081374 6.032434 #> [5,] 3.963056 4.851518 5.986116 #>   # Input has custom column names z <- data.frame(ave = 1:3, stdev = (1:3) / 10, chnm = letters[1:3]) simulate_exposure(z,                   expos_mean = \"ave\",                   expos_sd = \"stdev\",                   expos_label = \"chnm\",                   n = 5) #> [[1]] #>              a        b        c #> [1,] 0.8816355 2.109681 2.680272 #> [2,] 1.1612367 1.748522 2.695804 #> [3,] 0.9356836 2.200177 2.590011 #> [4,] 0.8834284 2.062633 2.469749 #> [5,] 1.0313530 1.803894 2.830455 #>"},{"path":"https://niehs.github.io/GeoTox/reference/simulate_inhalation_rate.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate inhalation rates — simulate_inhalation_rate","title":"Simulate inhalation rates — simulate_inhalation_rate","text":"Simulate inhalation rates","code":""},{"path":"https://niehs.github.io/GeoTox/reference/simulate_inhalation_rate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate inhalation rates — simulate_inhalation_rate","text":"","code":"simulate_inhalation_rate(x, IR_params = NULL)"},{"path":"https://niehs.github.io/GeoTox/reference/simulate_inhalation_rate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate inhalation rates — simulate_inhalation_rate","text":"x atomic vector list atomic vectors containing ages. IR_params (optional) data frame columns \"age\", \"mean\" \"sd\". See details information.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/simulate_inhalation_rate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate inhalation rates — simulate_inhalation_rate","text":"List atomic vectors containing inhalation rates.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/simulate_inhalation_rate.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simulate inhalation rates — simulate_inhalation_rate","text":"age column optional IR_params data frame ascending order represent lower value age groups corresponding mean sd values. provided, default values come Table 6.7 EPA's 2011 Exposure Factors Handbook using mean male female values.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/simulate_inhalation_rate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate inhalation rates — simulate_inhalation_rate","text":"","code":"# Single atomic vector ages <- sample(1:100, 6, replace = TRUE) simulate_inhalation_rate(ages) #> [[1]] #> [1] 0.1429835 0.1322055 0.1924417 0.2513578 0.2561258 0.2333317 #>   # List of atomic vectors ages <- list(   sample(1:100, 5, replace = TRUE),   sample(1:100, 3, replace = TRUE) ) simulate_inhalation_rate(ages) #> [[1]] #> [1] 0.1876381        NA 0.1385313 0.2020582 0.3040501 #>  #> [[2]] #> [1] 0.2185192 0.2032681 0.3593735 #>   # Custom IR_params IR_params <- data.frame(\"age\" = c(0, 20, 50),                         \"mean\" = c(0.5, 0.3, 0.2),                         \"sd\" = c(0.1, 0.06, 0.03)) simulate_inhalation_rate(c(15, 30, 65), IR_params) #> [[1]] #> [1] 0.4343494 0.2598280 0.1856423 #>"},{"path":"https://niehs.github.io/GeoTox/reference/simulate_obesity.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate obesity status — simulate_obesity","title":"Simulate obesity status — simulate_obesity","text":"Simulate obesity status","code":""},{"path":"https://niehs.github.io/GeoTox/reference/simulate_obesity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate obesity status — simulate_obesity","text":"","code":"simulate_obesity(   x,   obes_prev = \"OBESITY_CrudePrev\",   obes_sd = \"OBESITY_SD\",   obes_label = \"FIPS\",   n = 1000 )"},{"path":"https://niehs.github.io/GeoTox/reference/simulate_obesity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate obesity status — simulate_obesity","text":"x data frame containing obesity data percentage 0 100. obes_prev column name prevalence. obes_sd column name standard deviation. obes_label column name labeling term, required x one row. n simulated sample size.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/simulate_obesity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate obesity status — simulate_obesity","text":"List arrays containing simulated obesity status.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/simulate_obesity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate obesity status — simulate_obesity","text":"","code":"# Input has default column names df <- data.frame(OBESITY_CrudePrev = c(20, 50, 80),                  OBESITY_SD = c(5, 5, 5),                  FIPS = letters[1:3]) simulate_obesity(df, n = 5) #> $a #> [1] \"Normal\" \"Obese\"  \"Normal\" \"Obese\"  \"Normal\" #>  #> $b #> [1] \"Obese\"  \"Obese\"  \"Normal\" \"Obese\"  \"Obese\"  #>  #> $c #> [1] \"Obese\" \"Obese\" \"Obese\" \"Obese\" \"Obese\" #>   # Input has custom column names df <- data.frame(prev = c(20, 50, 80),                  sd = c(5, 5, 5),                  label = letters[1:3]) simulate_obesity(df,                  obes_prev = \"prev\",                  obes_sd = \"sd\",                  obes_label = \"label\",                  n = 5) #> $a #> [1] \"Normal\" \"Normal\" \"Normal\" \"Normal\" \"Normal\" #>  #> $b #> [1] \"Normal\" \"Normal\" \"Obese\"  \"Normal\" \"Normal\" #>  #> $c #> [1] \"Obese\"  \"Obese\"  \"Obese\"  \"Normal\" \"Obese\"  #>"},{"path":"https://niehs.github.io/GeoTox/reference/simulate_population.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate population data — simulate_population","title":"Simulate population data — simulate_population","text":"Simulate population data given input fields","code":""},{"path":"https://niehs.github.io/GeoTox/reference/simulate_population.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate population data — simulate_population","text":"","code":"simulate_population(   x,   age = NULL,   obesity = NULL,   exposure = NULL,   simulated_css = NULL,   ... )"},{"path":"https://niehs.github.io/GeoTox/reference/simulate_population.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate population data — simulate_population","text":"x GeoTox object. age input x function simulate_age. simulating ages, inhalation rate subsequently calculated using simulate_inhalation_rate. obesity input x function simulate_obesity. exposure input x function simulate_exposure. simulated_css input simulated_css functions sample_Css get_fixed_css. ... additional arguments passed functions. See details.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/simulate_population.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate population data — simulate_population","text":"object simulated fields added.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/simulate_population.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simulate population data — simulate_population","text":"Additional parameters include n sample size, IR_params simulate_inhalation_rate, obes_prev, obes_sd, obes_label simulate_obesity, expos_mean, expos_sd, expos_label simulate_exposure.","code":""},{"path":"https://niehs.github.io/GeoTox/reference/simulate_population.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate population data — simulate_population","text":"","code":"# For information about geo_tox_data, see: # vignette(\"package_data\", package = \"GeoTox\")  geoTox <- GeoTox() |>    simulate_population(age = split(geo_tox_data$age, ~FIPS)[1:5],                       obesity = geo_tox_data$obesity[1:5, ],                       exposure = split(geo_tox_data$exposure, ~FIPS)[1:5],                       simulated_css = geo_tox_data$simulated_css,                       n = 10)"},{"path":[]},{"path":[]}]
