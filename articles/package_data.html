<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>GeoTox Package Data • GeoTox</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="GeoTox Package Data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">GeoTox</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/introduction.html">GeoTox Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/package_data.html">GeoTox Package Data</a></li>
  </ul>
</li>
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="https://github.com/NIEHS/GeoTox/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>GeoTox Package Data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/NIEHS/GeoTox/blob/main/vignettes/package_data.Rmd"><code>vignettes/package_data.Rmd</code></a></small>
      <div class="d-none name"><code>package_data.Rmd</code></div>
    </div>

    
    
<p>This package includes example data <code>geo_tox_data</code>. Below
is a description of the data and example code for how it was
gathered.</p>
<blockquote>
<p><strong>NOTE:</strong> FIPS codes can change. Since data is being
pulled from various sources, ensure that the FIPS values can be used to
connect data across these sources. For example, in 2022 Connecticut
began the process of going from 8 legacy counties to 9 planning
regions.</p>
</blockquote>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org" class="external-link">readxl</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.epa.gov/chemical-research/rapid-chemical-exposure-and-dose-research" class="external-link">httk</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://httr2.r-lib.org" class="external-link">httr2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">geo_tox_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="chemical-data">Chemical data<a class="anchor" aria-label="anchor" href="#chemical-data"></a>
</h2>
<div class="section level3">
<h3 id="exposure-data">Exposure data<a class="anchor" aria-label="anchor" href="#exposure-data"></a>
</h3>
<p>Download modeled exposure data from
<a href="https://www.epa.gov/AirToxScreen" target="_blank" class="external-link">AirToxScreen</a>.
Results from AirToxScreen 2019 for a subset of chemicals in North
Carolina counties are included in the package data as
<code>geo_tox_data$exposure</code>.</p>
<blockquote>
<p><strong>NOTE:</strong> The 2020 release does not currently provide a
single file for the exposure national concentration summaries. The 2019
data can be found following the “Previous air toxics assessments”
link.</p>
</blockquote>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filename</span> <span class="op">&lt;-</span> <span class="st">"2019_Toxics_Exposure_Concentrations.xlsx"</span></span>
<span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="va">filename</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"https://www.epa.gov/system/files/documents/2022-12/"</span>, <span class="va">filename</span><span class="op">)</span>,</span>
<span>  <span class="va">tmp</span></span>
<span><span class="op">)</span></span>
<span><span class="va">exposure</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_xlsx</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Normalization function</span></span>
<span><span class="va">min_max_norm</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">min_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">max_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">min_x</span> <span class="op">==</span> <span class="va">max_x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">min_x</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">max_x</span> <span class="op">-</span> <span class="va">min_x</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">geo_tox_data</span><span class="op">$</span><span class="va">exposure</span> <span class="op">&lt;-</span> <span class="va">exposure</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># North Carolina counties</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">State</span> <span class="op">==</span> <span class="st">"NC"</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"0$"</span>, <span class="va">FIPS</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># Aggregate chemicals by county</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">State</span><span class="op">:</span><span class="va">Tract</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mean</span>, <span class="va">sd</span><span class="op">)</span><span class="op">)</span>, .by <span class="op">=</span> <span class="va">FIPS</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">FIPS</span>, names_to <span class="op">=</span> <span class="st">"chemical"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"_1$"</span>, <span class="va">chemical</span><span class="op">)</span>, <span class="st">"mean"</span>, <span class="st">"sd"</span><span class="op">)</span>,</span>
<span>         chemical <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">'.{2}$'</span>, <span class="st">''</span>, <span class="va">chemical</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">stat</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># Normalize concentrations</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>norm <span class="op">=</span> <span class="fu">min_max_norm</span><span class="op">(</span><span class="va">mean</span><span class="op">)</span>, .by <span class="op">=</span> <span class="va">chemical</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="get-casrn-and-preferred_name-from-comptox-dashboard">Get CASRN and PREFERRED_NAME from CompTox Dashboard<a class="anchor" aria-label="anchor" href="#get-casrn-and-preferred_name-from-comptox-dashboard"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Copy/paste the chemical names into the batch search field</span></span>
<span><span class="co"># https://comptox.epa.gov/dashboard/batch-search</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">geo_tox_data</span><span class="op">$</span><span class="va">exposure</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">chemical</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co"># Export results with "CAS-RN" identifiers as a csv file, then process in R</span></span>
<span></span>
<span><span class="va">exposure_casrn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"CCD-Batch-Search.csv"</span>,</span>
<span>                           show_col_types <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">DTXSID</span> <span class="op">!=</span> <span class="st">"N/A"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># Prioritize results based on FOUND_BY status</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">INPUT</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Approved Name"</span>, <span class="va">FOUND_BY</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^Synonym"</span>, <span class="va">FOUND_BY</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># Keep one result per INPUT</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">INPUT</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Update exposure data with CompTox Dashboard data</span></span>
<span><span class="va">geo_tox_data</span><span class="op">$</span><span class="va">exposure</span> <span class="op">&lt;-</span> <span class="va">geo_tox_data</span><span class="op">$</span><span class="va">exposure</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">exposure_casrn</span>, by <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/join_by.html" class="external-link">join_by</a></span><span class="op">(</span><span class="va">chemical</span> <span class="op">==</span> <span class="va">INPUT</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">FIPS</span>, casn <span class="op">=</span> <span class="va">CASRN</span>, chnm <span class="op">=</span> <span class="va">PREFERRED_NAME</span>, <span class="va">mean</span>, <span class="va">sd</span>, <span class="va">norm</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="ice-chts-data">ICE cHTS data<a class="anchor" aria-label="anchor" href="#ice-chts-data"></a>
</h3>
<p>Use <a href="https://ice.ntp.niehs.nih.gov/" target="_blank" class="external-link">ICE</a>
cHTS data to identify active chemicals for a given set of assays.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">get_cHTS_hits</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">assays</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">chemids</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">assays</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">chemids</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Must provide at least one of 'assays' or 'chemids'"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Format query parameters</span></span>
<span>  <span class="va">req_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">assays</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">is.list</a></span><span class="op">(</span><span class="va">assays</span><span class="op">)</span><span class="op">)</span> <span class="va">assays</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">assays</span><span class="op">)</span></span>
<span>    <span class="va">req_params</span><span class="op">$</span><span class="va">assays</span> <span class="op">&lt;-</span> <span class="va">assays</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">chemids</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">is.list</a></span><span class="op">(</span><span class="va">chemids</span><span class="op">)</span><span class="op">)</span> <span class="va">chemids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">chemids</span><span class="op">)</span></span>
<span>    <span class="va">req_params</span><span class="op">$</span><span class="va">chemids</span> <span class="op">&lt;-</span> <span class="va">chemids</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Query ICE API</span></span>
<span>  <span class="va">resp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://httr2.r-lib.org/reference/request.html" class="external-link">request</a></span><span class="op">(</span><span class="st">"https://ice.ntp.niehs.nih.gov/api/v1/search"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://httr2.r-lib.org/reference/req_body.html" class="external-link">req_body_json</a></span><span class="op">(</span><span class="va">req_params</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://httr2.r-lib.org/reference/req_perform.html" class="external-link">req_perform</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">resp</span><span class="op">$</span><span class="va">status_code</span> <span class="op">!=</span> <span class="fl">200</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Failed to retrieve data from ICE API"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Return active chemicals</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="va">resp</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://httr2.r-lib.org/reference/resp_body_raw.html" class="external-link">resp_body_json</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html" class="external-link">pluck</a></span><span class="op">(</span><span class="st">"endPoints"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">fields</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"assay"</span>, <span class="st">"casrn"</span>, <span class="st">"dtxsid"</span>, <span class="st">"substanceName"</span>,</span>
<span>              <span class="st">"endpoint"</span>, <span class="st">"value"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">fields</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_chr</a></span><span class="op">(</span><span class="va">result</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html" class="external-link">set_names</a></span><span class="op">(</span><span class="va">fields</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">endpoint</span> <span class="op">==</span> <span class="st">"Call"</span>, <span class="va">value</span> <span class="op">==</span> <span class="st">"Active"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">endpoint</span>, <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">assays</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"APR_HepG2_p53Act_1h_dn"</span>,</span>
<span>            <span class="st">"APR_HepG2_p53Act_1h_up"</span>,</span>
<span>            <span class="st">"APR_HepG2_p53Act_24h_dn"</span>,</span>
<span>            <span class="st">"APR_HepG2_p53Act_24h_up"</span>,</span>
<span>            <span class="st">"APR_HepG2_p53Act_72h_dn"</span>,</span>
<span>            <span class="st">"APR_HepG2_p53Act_72h_up"</span>,</span>
<span>            <span class="st">"ATG_p53_CIS_up"</span>,</span>
<span>            <span class="st">"TOX21_DT40"</span>,</span>
<span>            <span class="st">"TOX21_DT40_100"</span>,</span>
<span>            <span class="st">"TOX21_DT40_657"</span>,</span>
<span>            <span class="st">"TOX21_ELG1_LUC_Agonist"</span>,</span>
<span>            <span class="st">"TOX21_H2AX_HTRF_CHO_Agonist_ratio"</span>,</span>
<span>            <span class="st">"TOX21_p53_BLA_p1_ratio"</span>,</span>
<span>            <span class="st">"TOX21_p53_BLA_p2_ratio"</span>,</span>
<span>            <span class="st">"TOX21_p53_BLA_p3_ratio"</span>,</span>
<span>            <span class="st">"TOX21_p53_BLA_p4_ratio"</span>,</span>
<span>            <span class="st">"TOX21_p53_BLA_p5_ratio"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chemids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">geo_tox_data</span><span class="op">$</span><span class="va">exposure</span><span class="op">$</span><span class="va">casn</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">cHTS_hits_API</span> <span class="op">&lt;-</span> <span class="fu">get_cHTS_hits</span><span class="op">(</span>assays <span class="op">=</span> <span class="va">assays</span>, chemids <span class="op">=</span> <span class="va">chemids</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dose-response-data">Dose-response data<a class="anchor" aria-label="anchor" href="#dose-response-data"></a>
</h3>
<p>Use the ICE API to retrieve dose-response data for selected assays
and chemicals.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">get_ICE_dose_resp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">assays</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">chemids</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">assays</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">chemids</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Must provide at least one of 'assays' or 'chemids'"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Format query parameters</span></span>
<span>  <span class="va">req_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">assays</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">is.list</a></span><span class="op">(</span><span class="va">assays</span><span class="op">)</span><span class="op">)</span> <span class="va">assays</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">assays</span><span class="op">)</span></span>
<span>    <span class="va">req_params</span><span class="op">$</span><span class="va">assays</span> <span class="op">&lt;-</span> <span class="va">assays</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">chemids</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">is.list</a></span><span class="op">(</span><span class="va">chemids</span><span class="op">)</span><span class="op">)</span> <span class="va">chemids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">chemids</span><span class="op">)</span></span>
<span>    <span class="va">req_params</span><span class="op">$</span><span class="va">chemids</span> <span class="op">&lt;-</span> <span class="va">chemids</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Query ICE API</span></span>
<span>  <span class="va">resp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://httr2.r-lib.org/reference/request.html" class="external-link">request</a></span><span class="op">(</span><span class="st">"https://ice.ntp.niehs.nih.gov/api/v1/curves"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://httr2.r-lib.org/reference/req_body.html" class="external-link">req_body_json</a></span><span class="op">(</span><span class="va">req_params</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://httr2.r-lib.org/reference/req_perform.html" class="external-link">req_perform</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">resp</span><span class="op">$</span><span class="va">status_code</span> <span class="op">!=</span> <span class="fl">200</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Failed to retrieve data from ICE API"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Return dose-response data</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="va">resp</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://httr2.r-lib.org/reference/resp_body_raw.html" class="external-link">resp_body_json</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html" class="external-link">pluck</a></span><span class="op">(</span><span class="st">"curves"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">result</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>      endp <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"assay"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      casn <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"casrn"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      call <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"dsstoxsid"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      chnm <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"substance"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      call <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"call"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      logc <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="st">"concentrationResponses"</span><span class="op">]</span><span class="op">]</span>, <span class="st">"concentration"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      resp <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="st">"concentrationResponses"</span><span class="op">]</span><span class="op">]</span>, <span class="st">"response"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">assays</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cHTS_hits_API</span><span class="op">$</span><span class="va">assay</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chemids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">cHTS_hits_API</span><span class="op">$</span><span class="va">casrn</span>, <span class="va">geo_tox_data</span><span class="op">$</span><span class="va">exposure</span><span class="op">$</span><span class="va">casn</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dose_response</span> <span class="op">&lt;-</span> <span class="fu">get_ICE_dose_resp</span><span class="op">(</span>assays <span class="op">=</span> <span class="va">assays</span>, chemids <span class="op">=</span> <span class="va">chemids</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Only keep active calls for assay/chemical combinations</span></span>
<span><span class="va">geo_tox_data</span><span class="op">$</span><span class="va">dose_response</span> <span class="op">&lt;-</span> <span class="va">dose_response</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">call</span> <span class="op">==</span> <span class="st">"Active"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">call</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Update dose-response data with CompTox Dashboard data</span></span>
<span><span class="va">geo_tox_data</span><span class="op">$</span><span class="va">dose_response</span> <span class="op">&lt;-</span> <span class="va">geo_tox_data</span><span class="op">$</span><span class="va">dose_response</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">exposure_casrn</span>, by <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/join_by.html" class="external-link">join_by</a></span><span class="op">(</span><span class="va">casn</span> <span class="op">==</span> <span class="va">CASRN</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">endp</span>, <span class="va">casn</span>, chnm <span class="op">=</span> <span class="va">PREFERRED_NAME</span>, <span class="va">logc</span>, <span class="va">resp</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="population-data">Population data<a class="anchor" aria-label="anchor" href="#population-data"></a>
</h2>
<div class="section level3">
<h3 id="age">Age<a class="anchor" aria-label="anchor" href="#age"></a>
</h3>
<p>Download age data from the
<a href="https://www.census.gov/" target="_blank" class="external-link">U.S. Census Bureau</a>
by searching for “County Population by Characteristics”. A subset of
data for North Carolina from
<a href="https://www.census.gov/data/datasets/time-series/demo/popest/2010s-counties-detail.html" target="_blank" class="external-link">2019</a>
is included in the package data as <code>geo_tox_data$age</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Data for North Carolina</span></span>
<span><span class="va">url</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"https://www2.census.gov/programs-surveys/popest/datasets/"</span>,</span>
<span>              <span class="st">"2010-2019/counties/asrh/cc-est2019-alldata-37.csv"</span><span class="op">)</span></span>
<span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="va">url</span>, show_col_types <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">geo_tox_data</span><span class="op">$</span><span class="va">age</span> <span class="op">&lt;-</span> <span class="va">age</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># 7/1/2019 population estimate</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">YEAR</span> <span class="op">==</span> <span class="fl">12</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Create FIPS</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>FIPS <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html" class="external-link">str_c</a></span><span class="op">(</span><span class="va">STATE</span>, <span class="va">COUNTY</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Keep selected columns</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">FIPS</span>, <span class="va">AGEGRP</span>, <span class="va">TOT_POP</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="obesity">Obesity<a class="anchor" aria-label="anchor" href="#obesity"></a>
</h3>
<p>Follow the “Data Portal” link from
<a href="https://www.cdc.gov/places/index.html" target="_blank" class="external-link">CDC
PLACES</a> and search for “places county data”. Go to the desired
dataset webpage, for example
<a href="https://data.cdc.gov/500-Cities-Places/PLACES-County-Data-GIS-Friendly-Format-2020-releas/mssc-ksj7/about_data" target="_blank" class="external-link">2020
county data</a>, and download the data by selecting Actions → API →
Download file. A subset of data for North Carolina is included in the
package data as <code>geo_tox_data$obesity</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">places</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"PLACES__County_Data__GIS_Friendly_Format___2020_release.csv"</span>,</span>
<span>                   show_col_types <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert confidence interval to standard deviation</span></span>
<span><span class="va">extract_SD</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html" class="external-link">str_split_1</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html" class="external-link">str_sub</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span>, <span class="st">","</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">range</span><span class="op">)</span> <span class="op">/</span> <span class="fl">3.92</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">geo_tox_data</span><span class="op">$</span><span class="va">obesity</span> <span class="op">&lt;-</span> <span class="va">places</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># North Carolina Counties</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">StateAbbr</span> <span class="op">==</span> <span class="st">"NC"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Select obesity data</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>FIPS <span class="op">=</span> <span class="va">CountyFIPS</span>, <span class="va">OBESITY_CrudePrev</span>, <span class="va">OBESITY_Crude95CI</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Change confidence interval to standard deviation</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html" class="external-link">rowwise</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>OBESITY_SD <span class="op">=</span> <span class="fu">extract_SD</span><span class="op">(</span><span class="va">OBESITY_Crude95CI</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">OBESITY_Crude95CI</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="steady-state-plasma-concentration-css">Steady-state plasma concentration (Css)<a class="anchor" aria-label="anchor" href="#steady-state-plasma-concentration-css"></a>
</h3>
<p>Use <code>httk</code> to generate Css values for combinations of age
group and weight status for each chemical. The generation of these
values is a time-intensive step, so one approach is to generate
populations of Css values initially and then sample them later.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2345</span><span class="op">)</span></span>
<span><span class="va">n_samples</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span></span>
<span><span class="co"># Get CASN for which httk simulation is possible. Try using load_dawson2021,</span></span>
<span><span class="co"># load_sipes2017, or load_pradeep2020 to increase availability.</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/httk/man/load_sipes2017.html" class="external-link">load_sipes2017</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">casn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">geo_tox_data</span><span class="op">$</span><span class="va">dose_response</span><span class="op">$</span><span class="va">casn</span><span class="op">)</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/pkg/httk/man/get_cheminfo.html" class="external-link">get_cheminfo</a></span><span class="op">(</span>suppress.messages <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define population demographics for httk simulation</span></span>
<span><span class="va">pop_demo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/cross_join.html" class="external-link">cross_join</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>age_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">11</span>, <span class="fl">15</span><span class="op">)</span>,</span>
<span>                          <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">20</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">30</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">31</span>, <span class="fl">40</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">41</span>, <span class="fl">50</span><span class="op">)</span>,</span>
<span>                          <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">51</span>, <span class="fl">60</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">61</span>, <span class="fl">70</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">71</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Normal"</span>, <span class="st">"Obese"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Create column of lower age_group values</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html" class="external-link">rowwise</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>age_min <span class="op">=</span> <span class="va">age_group</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create wrapper function around httk steps</span></span>
<span><span class="va">simulate_css</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">chem.cas</span>, <span class="va">agelim_years</span>, <span class="va">weight_category</span>,</span>
<span>                         <span class="va">samples</span>, <span class="va">verbose</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">verbose</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">chem.cas</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">agelim_years</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span>,</span>
<span>        <span class="va">weight_category</span>,</span>
<span>        <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">httkpop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"vi"</span>,</span>
<span>                  gendernum <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                  agelim_years <span class="op">=</span> <span class="va">agelim_years</span>,</span>
<span>                  agelim_months <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                  weight_category <span class="op">=</span> <span class="va">weight_category</span>,</span>
<span>                  reths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>                    <span class="st">"Mexican American"</span>,</span>
<span>                    <span class="st">"Other Hispanic"</span>,</span>
<span>                    <span class="st">"Non-Hispanic White"</span>,</span>
<span>                    <span class="st">"Non-Hispanic Black"</span>,</span>
<span>                    <span class="st">"Other"</span></span>
<span>                  <span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">css</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="op">{</span></span>
<span>      <span class="va">mcs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/httk/man/create_mc_samples.html" class="external-link">create_mc_samples</a></span><span class="op">(</span>chem.cas <span class="op">=</span> <span class="va">chem.cas</span>,</span>
<span>                               samples <span class="op">=</span> <span class="va">samples</span>,</span>
<span>                               httkpop.generate.arg.list <span class="op">=</span> <span class="va">httkpop</span>,</span>
<span>                               suppress.messages <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/httk/man/calc_analytic_css.html" class="external-link">calc_analytic_css</a></span><span class="op">(</span>chem.cas <span class="op">=</span> <span class="va">chem.cas</span>,</span>
<span>                        parameters <span class="op">=</span> <span class="va">mcs</span>,</span>
<span>                        model <span class="op">=</span> <span class="st">"3compartmentss"</span>,</span>
<span>                        suppress.messages <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span>,</span>
<span>    silent <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Return</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/methods/is.html" class="external-link">is</a></span><span class="op">(</span><span class="va">css</span>, <span class="st">"try-error"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"simulate_css failed to generate data for CASN "</span>, <span class="va">chem.cas</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">css</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Simulate Css values</span></span>
<span><span class="va">simulated_css</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">casn</span>, <span class="kw">function</span><span class="op">(</span><span class="va">chem.cas</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">pop_demo</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html" class="external-link">rowwise</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      css <span class="op">=</span> <span class="fu">simulate_css</span><span class="op">(</span><span class="va">.env</span><span class="op">$</span><span class="va">chem.cas</span>, <span class="va">age_group</span>, <span class="va">weight</span>, <span class="va">.env</span><span class="op">$</span><span class="va">n_samples</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">simulated_css</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="va">simulated_css</span>, <span class="va">casn</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Remove CASN that failed simulate_css</span></span>
<span><span class="va">casn_keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_lgl</a></span><span class="op">(</span><span class="va">simulated_css</span>, <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">css</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">css</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">simulated_css</span> <span class="op">&lt;-</span> <span class="va">simulated_css</span><span class="op">[</span><span class="va">casn_keep</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Get median Css values for each age_group</span></span>
<span><span class="va">simulated_css</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>  <span class="va">simulated_css</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">cas_df</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">cas_df</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">nest</a></span><span class="op">(</span>.by <span class="op">=</span> <span class="va">age_group</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        age_median_css <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="va">data</span>, <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">css</span><span class="op">)</span>,</span>
<span>                                                           na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get median Css values for each weight</span></span>
<span><span class="va">simulated_css</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>  <span class="va">simulated_css</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">cas_df</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">cas_df</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">nest</a></span><span class="op">(</span>.by <span class="op">=</span> <span class="va">weight</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        weight_median_css <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="va">data</span>, <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">css</span><span class="op">)</span>,</span>
<span>                                                              na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">age_min</span>, <span class="va">weight</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">geo_tox_data</span><span class="op">$</span><span class="va">simulated_css</span> <span class="op">&lt;-</span> <span class="va">simulated_css</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="prune-data">Prune data<a class="anchor" aria-label="anchor" href="#prune-data"></a>
</h2>
<p>Retain only those chemicals found in exposure, dose-response and Css
datasets.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">casn_keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">geo_tox_data</span><span class="op">$</span><span class="va">simulated_css</span><span class="op">)</span></span>
<span></span>
<span><span class="va">geo_tox_data</span><span class="op">$</span><span class="va">exposure</span> <span class="op">&lt;-</span> <span class="va">geo_tox_data</span><span class="op">$</span><span class="va">exposure</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">casn</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">casn_keep</span><span class="op">)</span></span>
<span></span>
<span><span class="va">geo_tox_data</span><span class="op">$</span><span class="va">dose_response</span> <span class="op">&lt;-</span> <span class="va">geo_tox_data</span><span class="op">$</span><span class="va">dose_response</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">casn</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">casn_keep</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="countystate-boundaries">County/State boundaries<a class="anchor" aria-label="anchor" href="#countystate-boundaries"></a>
</h2>
<p>Download cartographic boundary files for counties and states from the
<a href="https://www.census.gov/geographies/mapping-files/time-series/geo/cartographic-boundary.html" target="_blank" class="external-link">U.S.
Census Bureau</a>. The geometry data for North Carolina counties and the
state are included in the package data as
<code>geo_tox_data$boundaries</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">county</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="st">"cb_2019_us_county_5m/cb_2019_us_county_5m.shp"</span><span class="op">)</span></span>
<span><span class="va">state</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="st">"cb_2019_us_state_5m/cb_2019_us_state_5m.shp"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">geo_tox_data</span><span class="op">$</span><span class="va">boundaries</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  county <span class="op">=</span> <span class="va">county</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">STATEFP</span> <span class="op">==</span> <span class="fl">37</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>FIPS <span class="op">=</span> <span class="va">GEOID</span>, <span class="va">geometry</span><span class="op">)</span>,</span>
<span>  state <span class="op">=</span> <span class="va">state</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">STATEFP</span> <span class="op">==</span> <span class="fl">37</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">geometry</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Skylar Marvel, David Reif, Kyle Messier.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
