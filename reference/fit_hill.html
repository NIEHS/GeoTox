<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit 2- or 3-parameter Hill model — fit_hill • GeoTox</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit 2- or 3-parameter Hill model — fit_hill"><meta name="description" content="Fit 2- or 3-parameter Hill model"><meta property="og:description" content="Fit 2- or 3-parameter Hill model"><meta property="og:image" content="https://github.com/NIEHS/GeoTox/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">GeoTox</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">GeoTox Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/package_data.html">GeoTox Package Data</a></li>
  </ul></li>
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="https://github.com/NIEHS/GeoTox/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Fit 2- or 3-parameter Hill model</h1>
      <small class="dont-index">Source: <a href="https://github.com/NIEHS/GeoTox/blob/main/R/fit_hill.R"><code>R/fit_hill.R</code></a></small>
      <div class="d-none name"><code>fit_hill.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fit 2- or 3-parameter Hill model</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_hill</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  conc <span class="op">=</span> <span class="st">"logc"</span>,</span>
<span>  resp <span class="op">=</span> <span class="st">"resp"</span>,</span>
<span>  fixed_slope <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  chem <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  assay <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>data frame of dose response data.</p></dd>


<dt id="arg-conc">conc<a class="anchor" aria-label="anchor" href="#arg-conc"></a></dt>
<dd><p>column name of base-10 log scaled concentration.</p></dd>


<dt id="arg-resp">resp<a class="anchor" aria-label="anchor" href="#arg-resp"></a></dt>
<dd><p>column name of response.</p></dd>


<dt id="arg-fixed-slope">fixed_slope<a class="anchor" aria-label="anchor" href="#arg-fixed-slope"></a></dt>
<dd><p>if TRUE, slope is fixed at 1.</p></dd>


<dt id="arg-chem">chem<a class="anchor" aria-label="anchor" href="#arg-chem"></a></dt>
<dd><p>(optional) column name of chemical identifiers.</p></dd>


<dt id="arg-assay">assay<a class="anchor" aria-label="anchor" href="#arg-assay"></a></dt>
<dd><p>(optional) column name of assay identifiers.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>data frame of fit parameters.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Optional <code>chem</code> and <code>assay</code> identifiers can be used to fit multiple
chemicals and/or assays. Returned columns <code>tp</code> is the top asymptote and
<code>logAC50</code> is the 50% response concentration. If the computation of the
standard deviations of these two parameters fails, then the standard
deviation is set equal to the parameter estimate and is indicated by the
respective imputed flag being TRUE.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Multiple assays, multiple chemicals</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">geo_tox_data</span><span class="op">$</span><span class="va">dose_response</span></span></span>
<span class="r-in"><span><span class="fu">fit_hill</span><span class="op">(</span><span class="va">df</span>, assay <span class="op">=</span> <span class="st">"endp"</span>, chem <span class="op">=</span> <span class="st">"casn"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 89 × 15</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    assay  chem     tp  tp.sd logAC50 logAC50.sd slope slope.sd logc_min logc_max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> APR_H… 510-…  4.44  5.86     2.06      0.448     1        0   -<span style="color: #BB0000;">0.398</span>     2.30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> APR_H… 92-8…  2.14  0.945    2.05      0.271     1        0   -<span style="color: #BB0000;">0.398</span>     2.30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> APR_H… 95-9…  1.46  0.556    1.67      0.246     1        0   -<span style="color: #BB0000;">0.699</span>     2   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> APR_H… 510-…  2.33  0.542    1.79      0.192     1        0   -<span style="color: #BB0000;">0.398</span>     2.30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> APR_H… 72-4…  1.93  1.93     1.95      1.95      1        0   -<span style="color: #BB0000;">0.398</span>     2.30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> APR_H… 92-8…  2.43  1.50     2.22      0.317     1        0   -<span style="color: #BB0000;">0.398</span>     2.30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> ATG_p… 87-8…  2.15  0.877    1.57      0.321     1        0   -<span style="color: #BB0000;">1.30</span>      2   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> TOX21… 100-… 71.4  27.2      1.54      0.294     1        0   -<span style="color: #BB0000;">3</span>         2   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> TOX21… 101-… 80.1  80.1      2.31      2.31      1        0   -<span style="color: #BB0000;">3</span>         1.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> TOX21… 101-…  0     0        2.45      0.101     1        0   -<span style="color: #BB0000;">3</span>         1.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 79 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 5 more variables: resp_min &lt;dbl&gt;, resp_max &lt;dbl&gt;, AIC &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   tp.sd.imputed &lt;lgl&gt;, logAC50.sd.imputed &lt;lgl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Single assay, multiple chemicals</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">geo_tox_data</span><span class="op">$</span><span class="va">dose_response</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">endp</span> <span class="op">==</span> <span class="st">"TOX21_H2AX_HTRF_CHO_Agonist_ratio"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">fit_hill</span><span class="op">(</span><span class="va">df</span>, chem <span class="op">=</span> <span class="st">"casn"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 7 × 14</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   chem        tp  tp.sd logAC50 logAC50.sd slope slope.sd logc_min logc_max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 106-50-3  29.9  14.7     1.88     0.363      1        0    -<span style="color: #BB0000;">3</span>        1.90</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 119-90-4  65.6  65.6     2.09     2.09       1        0    -<span style="color: #BB0000;">2.70</span>     2.30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 120-80-9 126.    8.29    1.54     0.079<span style="text-decoration: underline;">6</span>     1        0    -<span style="color: #BB0000;">2.70</span>     2.30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> 123-31-9 108.  108.      2.39     2.39       1        0    -<span style="color: #BB0000;">2.70</span>     2.30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> 510-15-6  48.5   7.47    2.24     0.123      1        0    -<span style="color: #BB0000;">2.70</span>     2.30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> 88-06-2   58.7  37.0     2.80     0.310      1        0    -<span style="color: #BB0000;">2.70</span>     2.30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">7</span> 92-87-5   73.7   7.22    2.06     0.086<span style="text-decoration: underline;">3</span>     1        0    -<span style="color: #BB0000;">2.70</span>     2.30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 5 more variables: resp_min &lt;dbl&gt;, resp_max &lt;dbl&gt;, AIC &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   tp.sd.imputed &lt;lgl&gt;, logAC50.sd.imputed &lt;lgl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Single assay, single chemical</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">geo_tox_data</span><span class="op">$</span><span class="va">dose_response</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">endp</span> <span class="op">==</span> <span class="st">"TOX21_H2AX_HTRF_CHO_Agonist_ratio"</span>,</span></span>
<span class="r-in"><span>                <span class="va">casn</span> <span class="op">==</span> <span class="st">"510-15-6"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">fit_hill</span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 13</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      tp tp.sd logAC50 logAC50.sd slope slope.sd logc_min logc_max resp_min</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>  48.5  7.47    2.24      0.123     1        0    -<span style="color: #BB0000;">2.70</span>     2.30    -<span style="color: #BB0000;">2.38</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 4 more variables: resp_max &lt;dbl&gt;, AIC &lt;dbl&gt;, tp.sd.imputed &lt;lgl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   logAC50.sd.imputed &lt;lgl&gt;</span></span>
<span class="r-in"><span><span class="co"># 3-parameter Hill model</span></span></span>
<span class="r-in"><span><span class="fu">fit_hill</span><span class="op">(</span><span class="va">df</span>, fixed_slope <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 13</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      tp tp.sd logAC50 logAC50.sd slope slope.sd logc_min logc_max resp_min</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>  31.2  1.29    1.83     0.017<span style="text-decoration: underline;">3</span>  4.02    0.864    -<span style="color: #BB0000;">2.70</span>     2.30    -<span style="color: #BB0000;">2.38</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 4 more variables: resp_max &lt;dbl&gt;, AIC &lt;dbl&gt;, tp.sd.imputed &lt;lgl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   logAC50.sd.imputed &lt;lgl&gt;</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Skylar Marvel, David Reif, Kyle Messier.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

